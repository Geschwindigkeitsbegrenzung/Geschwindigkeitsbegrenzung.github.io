// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"esri/dijit/OverviewMap":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/html dojo/has dojo/dom-class dojo/dom-style dojo/dnd/Moveable dijit/_Widget dijit/_Templated ../map ../geometry/Point ../geometry/ScreenPoint ../layers/TiledMapServiceLayer ../layers/DynamicMapServiceLayer ../layers/VectorTileLayer ../layers/ArcGISTiledMapServiceLayer ../layers/ArcGISDynamicMapServiceLayer ../layers/ArcGISImageServiceLayer ../layers/OpenStreetMapLayer ../virtualearth/VETiledLayer ../kernel ../config ../domUtils dojo/text!./templates/OverviewMap.html dojo/i18n!../nls/jsapi".split(" "),
function(g,l,f,w,x,m,r,n,y,u,d,c,z,B,D,h,q,k,K,F,s,G,A,v,E,H){return g([y,u],{declaredClass:"esri.dijit.OverviewMap",widgetsInTemplate:!0,templateString:E,constructor:function(b,c){l.mixin(this,H.widgets.overviewMap);b=b||{};if(b.map){var h={};c&&(this._detached=!0,h=w.coords(c,!0));this.map=b.map;this.baseLayer=b.baseLayer;this.width=b.width||h.w||this.map.width/4;this.height=b.height||h.h||this.map.height/4;this.attachTo=b.attachTo||"top-right";this.expandFactor=b.expandFactor||2;this.color=b.color||
"#000000";this.opacity=b.opacity||0.5;this.maximizeButton=!!b.maximizeButton;this.visible=!!b.visible;if(this.map.loaded)this._initialSetup();else var d=f.connect(this.map,"onLoad",this,function(){f.disconnect(d);d=null;this._initialSetup()});this._detached&&(this.visible=!0);this._maximized=!1}else console.error("esri.dijit.OverviewMap: "+this.NLS_noMap)},startup:function(){this.inherited(arguments);(!this.domNode.parentNode||9>x("ie")&&"DIV"!==this.domNode.parentNode.nodeName)&&this.map.container.appendChild(this.domNode);
this._detached?(r.set(this._body,"display","block"),r.set(this._controllerDiv,"display","none"),r.set(this._maximizerDiv,"display","none"),this.map.loaded?this._initialize():f.connect(this.map,"onLoad",this,this._initialize)):("bottom"===this.attachTo.split("-")[0]&&this.domNode.insertBefore(this._maximizerDiv,this._controllerDiv),this.maximizeButton||m.add(this._maximizerDiv,"ovwDisabledButton"),m.add(this.domNode,{"top-left":"ovwTL","top-right":"ovwTR","bottom-left":"ovwBL","bottom-right":"ovwBR"}[this.attachTo]),
m.add(this._controllerDiv,"ovwShow"),m.add(this._maximizerDiv,"ovwMaximize"),this.visible&&this.map.loaded&&(this.visible=!1,this.show()));r.set(this._focusDiv,"opacity",this.opacity)},destroy:function(){this._deactivate();this.overviewMap&&this.overviewMap.destroy();this.overviewMap=this.baseLayer=null;this.inherited(arguments)},resize:function(b){b&&!(0>=b.w||0>=b.h)&&this._resize(b.w,b.h)},show:function(){if(!this.visible){var b=this._controllerDiv;b.title=this.NLS_hide;m.remove(b,"ovwShow");m.add(b,
"ovwHide");v.show(this._body);v.show(this._maximizerDiv);this._initialize();this.visible=!0}},hide:function(){if(this.visible){var b=this._controllerDiv;b.title=this.NLS_show;m.remove(b,"ovwHide");m.add(b,"ovwShow");this._maximized&&this._maximizeHandler();v.hide(this._body);v.hide(this._maximizerDiv);this._deactivate();this.visible=!1}},_initialSetup:function(){if(this._mainMapLayer=this.map.getLayer(this.map.layerIds[0])){var b=this.baseLayer||this._mainMapLayer,c=this.map.spatialReference,d=b.spatialReference;
if(d.wkid!==c.wkid&&d.wkt!==c.wkt)console.error("esri.dijit.OverviewMap: "+this.NLS_invalidSR);else{c=b.declaredClass;if(b instanceof B)if(-1!==c.indexOf("VETiledLayer"))this.baseLayer=new s({resourceInfo:b.getResourceInfo(),culture:b.culture,mapStyle:b.mapStyle,bingMapsKey:b.bingMapsKey});else if(-1!==c.indexOf("OpenStreetMapLayer"))this.baseLayer=new F({tileServers:b.tileServers});else if(-1!==c.indexOf("WebTiledLayer")){var c=b.initialExtent,d=b.fullExtent,g=b.tileInfo;this.baseLayer=new b.constructor(b.urlTemplate,
{initialExtent:c&&new c.constructor(c.toJson()),fullExtent:d&&new d.constructor(d.toJson()),tileInfo:g&&new g.constructor(g.toJson()),tileServers:b.tileServers&&b.tileServers.slice(0)})}else this.baseLayer=new q(b.url,{resourceInfo:b.getResourceInfo()});else if(b instanceof D)-1!==c.indexOf("ArcGISImageServiceLayer")?this.baseLayer=new K(b.url):(this.baseLayer=new k(b.url),this.baseLayer.setImageFormat("png24"));else if(b instanceof h)b="http://services.arcgisonline.com/arcgis/rest/services/World_Street_Map/MapServer",
"https:"===location.protocol&&(b=b.replace("http:","https:")),this.baseLayer=new q(b,{});else{console.error("esri.dijit.OverviewMap: "+this.NLS_invalidType);return}!this._detached&&(this.visible&&this._controllerDiv)&&(b=function(){this.visible=!1;this.show()},this.baseLayer.loaded?b.call(this):f.connect(this.baseLayer,"onLoad",this,b))}}else console.error("esri.dijit.OverviewMap: "+this.NLS_noLayer)},_visibilityHandler:function(){this.visible?this.hide():this.show()},_maximizeHandler:function(){var b=
this._maximizerDiv;this._maximized?(b.title=this.NLS_maximize,m.remove(b,"ovwRestore"),m.add(b,"ovwMaximize"),this._resize(this.width,this.height)):(b.title=this.NLS_restore,m.remove(b,"ovwMaximize"),m.add(b,"ovwRestore"),this._resize(this.map.width,this.map.height));this._maximized=!this._maximized},_resize:function(b,c){r.set(this._body,{width:b+"px",height:c+"px"});var d=A.defaults.map.panDuration,h=this.overviewMap;A.defaults.map.panDuration=0;h&&(h.resize(!0),h.centerAt(this._focusExtent.getCenter()));
A.defaults.map.panDuration=d},_initialize:function(){if(this.overviewMap)this._activate();else{var b,c;c=9>x("ie")?this._body.firstChild:this._body.firstElementChild;this.overviewMap=b=new d(c,{slider:!1,showAttribution:!1,logo:!1,lods:this._overviewLods,wrapAround180:this.map.wrapAround180});f.connect(b,"onLoad",this,function(){this._map_resize_override=l.hitch(b,this._map_resize_override);b.disableMapNavigation();this._activate()});b.addLayer(this.baseLayer)}},_activate:function(){var b=this.map,
c=this.overviewMap;this._moveableHandle=new n(this._focusDiv);this._soeConnect=f.connect(b,"onExtentChange",this,this._syncOverviewMap);this._ufoConnect=f.connect(b,"onPan",this,this._updateFocus);this._oecConnect=f.connect(c,"onExtentChange",this,this._ovwExtentChangeHandler);this._opaConnect=f.connect(c,"onPan",this,this._ovwPanHandler);this._ozsConnect=f.connect(c,"onZoomStart",this,function(){v.hide(this._focusDiv)});this._ozeConnect=f.connect(c,"onZoomEnd",this,function(){v.show(this._focusDiv)});
this._omsConnect=f.connect(this._moveableHandle,"onMoveStop",this,this._moveStopHandler);this._syncOverviewMap(b.extent,null,null,null)},_deactivate:function(){f.disconnect(this._soeConnect);f.disconnect(this._ufoConnect);f.disconnect(this._oecConnect);f.disconnect(this._opaConnect);f.disconnect(this._ozsConnect);f.disconnect(this._ozeConnect);f.disconnect(this._omsConnect);this._moveableHandle&&this._moveableHandle.destroy()},_syncOverviewMap:function(b,c,d,h){this._suspendPanHandling?this._suspendPanHandling=
!1:(this._focusExtent=b,this.overviewMap.setExtent(b.expand(this.expandFactor),!0))},_updateFocus:function(b){this._suspendPanHandling||(this._focusExtent=b,this._drawFocusDiv(b))},_drawFocusDiv:function(b,d){var h=this.overviewMap,f=h.toScreen(new c(b.xmin,b.ymax,h.spatialReference)),k=h.toScreen(new c(b.xmax,b.ymin,h.spatialReference)),h=k.x-f.x,k=k.y-f.y,q=!0;h>this.overviewMap.width&&k>this.overviewMap.height&&(q=!1);r.set(this._focusDiv,{left:f.x+(d?d.x:0)+"px",top:f.y+(d?d.y:0)+"px",width:h+
"px",height:k+"px",display:q?"block":"none"})},_moveStopHandler:function(b){var h=this._moveableHandle.node.style;b=this._focusExtent;var d=this.overviewMap,h=d.toMap(new z(parseInt(h.left,10),parseInt(h.top,10))),f=new c(b.xmin,b.ymax,d.spatialReference);this._focusExtent=b.offset(h.x-f.x,h.y-f.y);this._maximized?this._maximizeHandler():d.centerAt(this._focusExtent.getCenter());this._suspendPanHandling=!0;this.map.setExtent(this._focusExtent)},_ovwExtentChangeHandler:function(){this._drawFocusDiv(this._focusExtent)},
_ovwPanHandler:function(b,c){this._drawFocusDiv(this._focusExtent,c)}})})},"esri/layers/VectorTileLayer":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/url dojo/dom-construct dojo/dom-style dojo/has dojo/Deferred ../lang ../domUtils ../urlUtils ../kernel ../config ../request ../SpatialReference ../geometry/Extent ./layer ./TileInfo ./unitBezier".split(" "),function(g,l,f,w,x,m,r,n,y,u,d,c,z,B,D,h,q,k,K){var F=l(q,{declaredClass:"esri.layers.VectorTileLayer",_mapsWithAttribution:["World_Basemap"],
_eventMap:{"style-change":["style"]},constructor:function(a,e){this._displayLevels=e?e.displayLevels:null;this._serviceOverrides={};e&&(e.tileServers&&e.tileServers.length)&&(this._serviceOverrides.tileServers=e.tileServers.map(function(a){return t.isMapboxUrl(a)?a:d.getAbsoluteUrl(d.urlToObject(a).path)},this));if("string"===typeof a){var p=t.isMapboxUrl(a),b=p?a:d.getAbsoluteUrl(a);if(!p&&(p=/token=([^&]+)/i.exec(b)))b=d.urlToObject(a).path,this._serviceOverrides.credential={url:b,token:p[1]};urlOrObbject=
b}this.setStyle(a);this.registerConnectEvents()},setStyle:function(a){if(a)return this._loadStyle(a)},opacity:1,setOpacity:function(a){if(this.opacity!=a)this.onOpacityChange(this.opacity=a)},onOpacityChange:function(){},refresh:function(){},_loadStyle:function(a){return(new n).resolve().then(function(){var a=new n;null==r("ie")||9<r("ie")?s?s.supported()?a.resolve():a.reject(Error("layer not supported"),!0):g(["./vector-tile"],function(p){s=p;s.supported()?a.resolve():a.reject(Error("layer not supported"),
!0)}):a.reject(Error("layer not supported"),!0);return a.promise}).then(function(){s.tokenHandler?G=s.tokenHandler:(G=new P,s.tokenHandler=G);this._serviceOverrides&&this._serviceOverrides.credential&&G.addToken(this._serviceOverrides.credential);return t.loadMetadata(a,this._serviceOverrides)}.bind(this)).then(f.hitch(this,function(e){var p=e.layerDefinition;this.serviceUrl=e.serviceUrl||null;this.styleUrl=e.styleUrl||null;p?(this.spatialReference=p.initialExtent&&p.initialExtent.spatialReference&&
new D(p.initialExtent.spatialReference),this.initialExtent=p.initialExtent&&new h(p.initialExtent),this.fullExtent=p.fullExtent&&new h(p.fullExtent),this.version=p.currentVersion,this.tileInfo=new k(p.tileInfo),y.isDefined(p.minScale)&&!this._hasMin&&this.setMinScale(p.minScale),y.isDefined(p.maxScale)&&!this._hasMax&&this.setMaxScale(p.maxScale),p=null,a&&(p=d.urlToObject(e.serviceUrl).path.toLowerCase(),p=this._getDefaultAttribution(this._getMapName(p))),p&&(this.attributionDataUrl=p,this.hasAttributionData=
!0)):(this.spatialReference=b,this.initialExtent=L,this.fullExtent=M,this.tileInfo=H,this.version=null);for(var p=this.tileInfo.lods,f=this.scales=[],q=this._displayLevels,g=-Infinity,l=Infinity,C,n=0,m=p.length;n<m;n++)if(C=p[n],!q||-1!==q.indexOf(C.level))f[n]=C.scale,g=C.scale>g?C.scale:g,l=C.scale<l?C.scale:l;-Infinity!==g&&!this._hasMin&&this.setMinScale(g);Infinity!==l&&!this._hasMax&&this.setMaxScale(l);this.style=e.style;this.gl&&(s.identityManager=c.id,this._applyGLStyle(this.style));this.onStyleChange(this.style)})).then(f.hitch(this,
function(){!this.loaded&&!this.loadError&&(this.loaded=!0,this.onLoad(this))})).otherwise(f.hitch(this,function(a){this._errorHandler(a);throw a;}))},_setMap:function(a,e,p){this.inherited(arguments);this._map=a;var b=this._div=x.create("div",null,e);m.set(b,{position:"absolute",width:a.width+"px",height:a.height+"px",overflow:"visible",opacity:this.opacity});this._onResizeHandle=a.on("resize",f.hitch(this,this._onResizeHandler));this._onOpacityHandle=this.on("opacity-change",f.hitch(this,this._opacityChangeHandler));
s.identityManager=c.id;this.gl=new s.Renderer({container:b});this.gl.setSize(a.width,a.height);this._applyGLStyle(this.style);this.evaluateSuspension();if(this.suspended&&!a.loaded)var h=a.on("load",f.hitch(this,function(){h.remove();this.evaluateSuspension()}));return b},_unsetMap:function(a,e){this.gl.remove();this.gl=null;x.destroy(this._div);this._map=this._div=null;this._onResizeHandle=this._onResizeHandle&&this._onResizeHandle.remove()&&null;this._onOpacityHandle=this._onOpacityHandle&&this._onOpacityHandle.remove()&&
null;this._disableDrawConnectors();this._animation&&(this._animation.stop(),this._animation=null);this.inherited(arguments)},_applyGLStyle:function(a){var e=this.gl;e&&(a?(a.animationLoop=e.animationLoop,e.setStyle(a),a._loaded&&(Object.getOwnPropertyNames(a.sources).forEach(function(a){this.fire("source.add",{source:this.sources[a]})},a),a.fire("load"),a.sprite.loaded()&&a.fire("change"))):e.setStyle(null))},_enableDrawConnectors:function(){var a=this._map;a&&(this._panHandle=a.on("pan",f.hitch(this,
this._onPanExtentChangeHandler)),this._extentChangeHandle=a.on("extent-change",f.hitch(this,this._onPanExtentChangeHandler)),this._onScaleHandle=a.on("scale",f.hitch(this,this._onScaleHandler)))},_disableDrawConnectors:function(){this._onScaleHandle=this._onScaleHandle&&this._onScaleHandle.remove()&&null;this._panHandle=this._panHandle&&this._panHandle.remove()&&null;this._extentChangeHandle=this._extentChangeHandle&&this._extentChangeHandle.remove()&&null},_getZoom:function(a,e){var b=this.tileInfo.lods,
c=null,h=null;e=0;var d=b.length-1;for(e;e<d;e++){c=b[e];h=b[e+1];if(c.scale<=a)return e;if(h.scale===a)return e+1;if(c.scale>a&&h.scale<a){e=e+1-(a-h.scale)/(c.scale-h.scale);e=Math.ceil(e)-Math.log(Math.abs(Math.ceil(e)-e+1))/Math.LN2;if(0.995<e-Math.floor(e)||0.0050>e-Math.floor(e))e=Math.round(e);return e}}return a>b[0].scale?b[0].level:b[b.length-1].level},_isMapAtVisibleScale:function(){var a=this.inherited(arguments);if(a){for(var e=this._map,a=this.scales,b=e.getScale(),c=!1,e=e.width>e.height?
e.width:e.height,h=0,d=a.length;h<d;h++)if(Math.abs(a[h]-b)/a[h]<1/e){c=!0;break}a=c}return a},_getMapName:function(a){return(a=a.match(/^https?\:\/\/(basemaps|basemapsbeta)\.arcgis\.com\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/vectortileserver/i))&&a[2]},_getDefaultAttribution:function(a){if(a){var e;a=a.toLowerCase();for(var b=0,c=this._mapsWithAttribution.length;b<c;b++)if(e=this._mapsWithAttribution[b],-1<e.toLowerCase().indexOf(a))return"file:"===window.location.protocol?"http:":window.location.protocol+
"//static.arcgis.com/attribution/Vector/"+e}},onStyleChange:function(a){},_opacityChangeHandler:function(a){this.gl&&(this._div.style.opacity=a.opacity)},_onResizeHandler:function(a){if(this.gl){var e=a.extent.getCenter();this.gl.setSize(a.width,a.height);this.gl.jumpTo({center:[e.getLongitude(),e.getLatitude()]});this._div.style.width=a.width+"px";this._div.style.height=a.height+"px"}},onSuspend:function(){this.inherited(arguments);u.hide(this._div);this._disableDrawConnectors()},onResume:function(){this.inherited(arguments);
if(this.gl&&this.style){u.show(this._div);var a=this._map,e=this._getZoom(a.getScale()),a=a.extent.getCenter();this._animate(a,e,!0)}this._enableDrawConnectors()},_onPanExtentChangeHandler:function(a){var e=this._getZoom(this._map.getScale());a=a.extent.getCenter();this._animate(a,e,!0)},_onScaleHandler:function(a){var e=this._map,b=e._zoomAnimDiv.anchor,c=e._zoomAnimDiv.extent.getCenter(),e=this._getZoom(e._zoomAnimDiv.newLod.scale,e._zoomAnimDiv.newLod.level);this._animate(c,e,a.immediate,b)},_animate:function(a,
e,b,c){this._animation&&(this._animation.stop(),this._animation=null);this._animation=Q(this.gl,a.getLongitude(),a.getLatitude(),e,b,this._map,c)}}),s=null,G=null;q=Object.freeze||function(a){};for(var A=[],v=0;20>v;v++){var E=78271.51696402048/Math.pow(2,v);A.push({level:v,scale:Math.floor(3779.527559055118*E),resolution:E})}var H=new k({rows:512,cols:512,dpi:96,format:"pbf",origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:{wkid:102100},lods:A});q(H);var b=new D(102100);q(b);var L=
new h(-2.003750834E7,-2.003750834E7,2.003750834E7,2.003750834E7,b);q(L);var M=new h(-2.003750834E7,-2.003750834E7,2.003750834E7,2.003750834E7,b);q(M);var I=function(){var a,e=window.performance||{},b=e.now||e.webkitNow||e.msNow||e.oNow||e.mozNow;if(void 0!==b)return function(){return b.call(e)};a=window.performance&&window.performance.timing&&window.performance.timing.navigationStart?window.performance.timing.navigationStart:(new Date).getTime();return function(){return(new Date).getTime()-a}}();
q=r("ff");var A=r("ie"),v=r("webkit"),E=r("opera"),N=(new Date).getTime(),J=window.requestAnimationFrame;J||(J=window[(v&&"webkit"||q&&"moz"||E&&"o"||A&&"ms")+"RequestAnimationFrame"])||(J=function(a){var e=I(),b=Math.max(0,16-(e-N)),c=window.setTimeout(function(){a(I())},b);N=e+b;return c});var R=K.ease,Q=function(a,e,b,c,h,d,f){if(h=h||0===z.defaults.map.zoomDuration)return a.jumpTo({center:[e,b],zoom:Math.ceil(c)-Math.log(Math.abs(Math.ceil(c)-c+1))/Math.LN2}),null;var k=!0,q=z.defaults.map.zoomDuration,
g=a.transform.center.lat,l=a.transform.center.lng,n=a.transform.zoom,m=I()+16,s=f?[f.x-d.width/2,f.y-d.height/2]:null,r=function(){if(k){var h=(I()+16-m)/q;1<=h&&(h=1,k=!1);var h=R(h),d=n+(c-n)*h,d=Math.ceil(d)-Math.log(Math.abs(Math.ceil(d)-d+1))/Math.LN2;s?a.zoomTo(d,{animate:!1,offset:s}):a.jumpTo({center:[l+(e-l)*h,g+(b-g)*h],zoom:d});k&&J(r)}};r();return{stop:function(){k=!1}}},O=l(String,{constructor:function(a,e){this.value=a;this.token=e},valueOf:function(){var a=this.value,e=this.token;if(!e){var b=
c.id&&c.id.findCredential(a);b&&b.token&&(e=b.token)}e&&(a+=(-1===a.indexOf("?")?"?":"\x26")+"token\x3d"+e);return a},toString:function(){return this.valueOf()},replace:function(a,e){return String.prototype.replace.call(this.valueOf(),a,e)}}),t={loadMetadata:function(a,e){var b=null,c=null,h=e&&e.credential;return(new n).resolve(a).then(function(){s.config.ACCESS_TOKEN=F.ACCESS_TOKEN;if("string"!==typeof a)return a;t.isMapboxUrl(a)?(c=a,b=s.normalizeStyleURL(a)):c=b=d.normalize(a).replace(/\/*$/,
"");t._corsify(b);b=t._appendToken(b,h);return B({url:b,content:{f:"json"},handleAs:"json"})}).then(function(a){return t._processMetadata(c,a,e)}).then(function(a){return t._loadStyle(a,e)})},isMapboxUrl:function(a){return-1<a.search(/^mapbox:\/\/styles\//)},_appendToken:function(a,e){return!e||!e.token?a:a+=(-1===a.indexOf("?")?"?":"\x26")+"token\x3d"+e.token},_configureStyle:function(a,e){var b=a.layerDefinition,c=a.style,h=a.serviceUrl,d=a.styleUrl,f=t._getAbsolutePath,k=t._corsify;if(b&&c&&c.sources.esri){var q=
b.tilejson||"2.0.0",g=b.tileInfo&&b.tileInfo.format||"pbf",l=b.tileMap?k(f(b.tileMap,h)):null,n=(b.tiles||[]).map(function(a){return new O(t._getAbsolutePath(a,h),e&&e.credential&&e.credential.token)});c.sources.esri={type:"vector",scheme:"xyz",tilejson:q,format:g,index:l,tiles:n,description:b.description,name:b.name};n.forEach(k);c.glyphs=k(f(c.glyphs,d));c.sprite=k(f(c.sprite,d))}return{style:c,layerDefinition:b,serviceUrl:h,styleUrl:d}},_loadStyle:function(a,b){var h=new n,d=a.style,k=d.sources;
b&&b.tileServers&&Object.getOwnPropertyNames(k).forEach(f.hitch(this,function(c){c=k[c];var h=b.tileServers.map(function(c){return new O(t._getAbsolutePath(c,a.serviceUrl,b))});c.tiles=h;h.forEach(t._corsify)}));s.identityManager=c.id;var d=new s.Style(d),q=function(){d.off("load",q);d.off("error",g);a.style=d;h.resolve(a)},g=function(a){d.off("load",q);d.off("error",g);h.reject(a)};d.on("load",q);d.on("error",g);return h.promise},_getAbsolutePath:function(a,b){var c;b=d.urlToObject(b||"").path;if(/^https?:\/\//i.test(a))c=
a;else{if(0===a.indexOf("//"))return location.protocol+a;b=b.replace(/(\/+\w+\.\w+)$/,"");/\/+$/.test(b)||(b+="/");0===a.indexOf("/")&&(a=a.substring(1));c=b+a}return d.normalize(c)},_corsify:function(a){a=a.valueOf();var b=z.defaults.io.corsEnabledServers;if(!d.canUseXhr(a)){var c=new w(a),c=(c.host+(c.port?":"+c.port:"")).toLowerCase();-1===b.indexOf(c)&&b.push(c)}return a},_processMetadata:function(a,b,c){var h={},d,k,q=t._getAbsolutePath,g=t._configureStyle,l=t._corsify,n=c&&c.credential;delete b._ssl;
if(b.currentVersion)return d=a,k=q(b.defaultStyles,d),B({url:t._appendToken(k,n),content:{f:"json"},handleAs:"json"}).then(f.hitch(this,function(a){return g({style:a,layerDefinition:b,styleUrl:k,serviceUrl:d},c)}));h=b;k=a;return b.sources.esri&&b.sources.esri.url?(d=l(q(b.sources.esri.url,k)),B({url:t._appendToken(d,n),content:{f:"json"},handleAs:"json"}).then(f.hitch(this,function(a){return g({style:h,layerDefinition:a,styleUrl:k,serviceUrl:d},c)}))):g({style:h})}},P=l([],{constructor:function(){this._credentials=
[]},addToken:function(a){if(!a||!a.url||!a.token)return!1;var b=this.getServiceRoot(a.url);this._credentials.push({rootUrl:b,token:a.token})},findCredential:function(a){var b=-1,c=this._credentials,h=this.getServiceRoot(a);c.some(function(a,c){if(a.rootUrl===h)return b=c,!0});return-1<b?c[b]:null},getServiceRoot:function(a){var b=/(.+\/rest\/services\/.*\/?vectortileserver)/i,c=/(.+\/sharing\/.*)/i;return b.test(a)?a.match(b)[1].toLowerCase():c.test(a)?a.match(c)[1].toLowerCase():null},shareSameService:function(a,
b){a=this.getServiceRoot(a);b=this.getServiceRoot(b);a=a.substr(a.indexOf(":"));b=b.substr(b.indexOf(":"));return a===b}});F.ACCESS_TOKEN=null;return F})},"esri/layers/unitBezier":function(){define([],function(){var g=function(f,g,l,m){function r(c,d){var h,f,k,g;d=null==d?1E-6:d;k=c;for(f=0;8>f;f++){g=((u*k+y)*k+n)*k-c;if(Math.abs(g)<d)return k;h=(3*u*k+2*y)*k+n;if(1E-6>Math.abs(h))break;k-=g/h}h=0;f=1;k=c;if(k<h)return h;if(k>f)return f;for(;h<f;){g=((u*k+y)*k+n)*k;if(Math.abs(g-c)<d)break;c>g?
h=k:f=k;k=0.5*(f-h)+h}return k}var n=3*f,y=3*(l-f)-n,u=1-n-y,d=3*g,c=3*(m-g)-d,z=1-d-c;return function(f,g){var h=r(f,g);return((z*h+c)*h+d)*h}},l=/^cubic-bezier\((.*)\)/;g.parse=function(f){var w=g[f]||null;if(!w&&(f=l.exec(f)))f=f[1].split(",").map(function(f){return parseFloat(f.trim())}),4===f.length&&!f.some(function(f){return isNaN(f)})&&(w=g.apply(g,f));return w};g.ease=g(0.25,0.1,0.25,1);g.linear=g(0,0,1,1);g.easeIn=g["ease-in"]=g(0.42,0,1,1);g.easeOut=g["ease-out"]=g(0,0,0.58,1);g.easeInOut=
g["ease-in-out"]=g(0.42,0,0.58,1);return g})},"esri/layers/ArcGISImageServiceLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../config ./DynamicMapServiceLayer ./ImageServiceLayerMixin".split(" "),function(g,l,f,w,x,m,r){return g([m,r],{declaredClass:"esri.layers.ArcGISImageServiceLayer",constructor:function(f,g){this._initialize(f,g);this.useMapImage=g&&g.useMapImage||!1},refresh:function(f){if(f)this.inherited(arguments);else{var g=this.disableClientCaching;this.disableClientCaching=
!0;this.inherited(arguments);this.disableClientCaching=g}},exportMapImage:function(f,g){var m=x.defaults.map,m=l.mixin({size:m.width+","+m.height},this._params,f?f.toJson(this.normalization):{},{f:"json"});delete m._ts;this._exportMapImage(this._url.path+"/exportImage",m,g)}})})},"esri/virtualearth/VETiledLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/_base/array dojo/_base/config dojo/has dojo/string dojo/_base/Deferred ../kernel ../urlUtils ../SpatialReference ../layers/TileInfo ../layers/TiledMapServiceLayer ../geometry/Extent ../request".split(" "),
function(g,l,f,w,x,m,r,n,y,u,d,c,z,B,D){g=g(z,{declaredClass:"esri.virtualearth.VETiledLayer",constructor:function(h){try{h=l.mixin({bingMapsKey:null,culture:"en-US"},h||{});var f=window.location.protocol;"file:"===f&&(f="http:");this.url=f+"//dev.virtualearth.net/REST/v1";this._url=u.urlToObject(this.url);this.spatialReference=new d({wkid:102100});this.tileInfo=new c({rows:256,cols:256,dpi:96,origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:{wkid:102100},lods:[{level:1,resolution:78271.5169639999,
scale:2.95828763795777E8},{level:2,resolution:39135.7584820001,scale:1.47914381897889E8},{level:3,resolution:19567.8792409999,scale:7.3957190948944E7},{level:4,resolution:9783.93962049996,scale:3.6978595474472E7},{level:5,resolution:4891.96981024998,scale:1.8489297737236E7},{level:6,resolution:2445.98490512499,scale:9244648.868618},{level:7,resolution:1222.99245256249,scale:4622324.434309},{level:8,resolution:611.49622628138,scale:2311162.217155},{level:9,resolution:305.748113140558,scale:1155581.108577},
{level:10,resolution:152.874056570411,scale:577790.554289},{level:11,resolution:76.4370282850732,scale:288895.277144},{level:12,resolution:38.2185141425366,scale:144447.638572},{level:13,resolution:19.1092570712683,scale:72223.819286},{level:14,resolution:9.55462853563415,scale:36111.909643},{level:15,resolution:4.77731426794937,scale:18055.954822},{level:16,resolution:2.38865713397468,scale:9027.977411},{level:17,resolution:1.19432856685505,scale:4513.988705},{level:18,resolution:0.597164283559817,
scale:2256.994353},{level:19,resolution:0.298582141647617,scale:1128.497176}]});this.initialExtent=this.fullExtent=new B(-2.0037508342787E7,-2.003750834278E7,2.003750834278E7,2.0037508342787E7,new d({wkid:102100}));l.mixin(this,h);this.hasAttributionData=this.showAttribution;this._initLayer=l.hitch(this,this._initLayer);this._errorHandler=l.hitch(this,this._errorHandler);this._getTileInfo=l.hitch(this,this._getTileInfo);if(this.bingMapsKey)this._getTileInfo();else throw Error("BingMapsKey must be provided.");
}catch(g){throw this.onError(g),g;}},_unsetMap:function(c,d){this.inherited("_unsetMap",arguments)},_getTileInfo:function(){if(this.mapStyle){var c=this._url.path+"/Imagery/Metadata/"+this.mapStyle;if(this.bingMapsKey){var d=this.resourceInfo;!this.loaded&&d?this._initLayer(d):D({url:c,content:l.mixin({},{key:this.bingMapsKey,ss:!0,c:this.culture,include:this.hasAttributionData?"imageryProviders":null}),callbackParamName:"jsonp",load:this._initLayer,error:this._errorHandler})}}},_initLayer:function(c,
d){if(200!==c.statusCode){var g=Error();g.code=c.statusCode;g.message=c.statusDescription;g.details=c.errorDetails;g.authenticationResultCode=c.authenticationResultCode;this.onError(g)}else try{this.resourceInfo=f.toJson(c);var g=c.resourceSets[0].resources[0],l=g.imageUrl.replace("{","${");this.tileServers=w.map(g.imageUrlSubdomains,function(c){var d=window.location.protocol;"file:"===d&&(d="http:");return r.substitute(l,{subdomain:c}).replace("http:",d)});this._tsLength=this.tileServers.length;
if(this.loaded)this.refresh(),this.onMapStyleChange();else{this.copyright=this.copyright||"\x26copy; 2012 Microsoft Corporation and its data suppliers";this.loaded=!0;this.onLoad(this);var m=this.loadCallback;m&&(delete this.loadCallback,m(this))}}catch(n){this.onError(n)}},getAttributionData:function(){var c=new n,d=f.fromJson(this.resourceInfo),g;this.hasAttributionData&&d&&(g=l.getObject("resourceSets.0.resources.0.imageryProviders",!1,d));g?c.callback({contributors:g}):(d=Error("Layer does not have attribution data"),
d.log=x.isDebug,c.errback(d));return c},getTileUrl:function(c,d,f){return r.substitute(this.tileServers[d%this._tsLength].replace(/\{/g,"${"),{quadkey:this._getQuadKey(c,d,f),culture:this.culture,token:this.bingMapsKey})},_getQuadKey:function(c,d,f){var g="",l,m;for(m=c;0<m;m--)c="0",l=1<<m-1,0!=(f&l)&&c++,0!=(d&l)&&(c++,c++),g+=c;return g},setMapStyle:function(c){this.mapStyle=c;this._getTileInfo()},setCulture:function(c){this.culture=c;this._getTileInfo()},setBingMapsKey:function(c){this.bingMapsKey=
c},onMapStyleChange:function(){}});l.mixin(g,{MAP_STYLE_AERIAL:"aerial",MAP_STYLE_AERIAL_WITH_LABELS:"aerialWithLabels",MAP_STYLE_ROAD:"road"});return g})},"widgets/OverviewMap/_build-generate_module":function(){define(["dojo/i18n!./nls/strings","dojo/text!./config.json"],function(){})},"url:esri/dijit/templates/OverviewMap.html":'\x3cdiv class\x3d"esriOverviewMap"\x3e\r\n  \x3cdiv class\x3d"ovwContainer" dojoattachpoint\x3d"_body" style\x3d"width: ${width}px; height: ${height}px;"\x3e\r\n    \x3cdiv id\x3d"${id}-map" style\x3d"width: 100%; height: 100%;"\x3e\r\n      \x3cdiv class\x3d"ovwHighlight" dojoattachpoint\x3d"_focusDiv" title\x3d"${NLS_drag}" style\x3d"border: 1px solid ${color}; background-color: ${color};"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"ovwButton ovwController" title\x3d"${NLS_show}" dojoattachpoint\x3d"_controllerDiv" dojoattachevent\x3d"onclick: _visibilityHandler"\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"ovwButton ovwMaximizer" title\x3d"${NLS_maximize}" dojoattachpoint\x3d"_maximizerDiv" dojoattachevent\x3d"onclick: _maximizeHandler"\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/OverviewMap/config.json":'{\r\n  "overviewMap":{\r\n    "visible": false\r\n  }\r\n}',"*now":function(g){g(['dojo/i18n!*preload*widgets/OverviewMap/nls/Widget*["ar","cs","da","de","en","el","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/aspect jimu/BaseWidget esri/dijit/OverviewMap jimu/utils dojo/dom-style".split(" "),function(g,l,f,w,x,m,r,n,y,u){return g([r],{baseClass:"jimu-widget-overview",overviewMapDijit:null,_showDijit:!1,_handles:null,startup:function(){this._handles=[];this.inherited(arguments);this.createOverviewMap();this.map&&(this.own(x(this.map,"layer-add",l.hitch(this,this._onMainMapBasemapChange))),this.own(x(this.map,"resize",
l.hitch(this,this._onMainMapResize))))},setPosition:function(d){this.position=d;f.place(this.domNode,this.map.id);this._processAttachTo(this.config,d);this.started&&this._updateDomPosition(this.config.attachTo)},_processAttachTo:function(d,c){!d.attachTo&&c&&(void 0!==c.top&&void 0!==c.left?d.attachTo=!window.isRTL?"top-left":"top-right":void 0!==c.top&&void 0!==c.right?d.attachTo=!window.isRTL?"top-right":"top-left":void 0!==c.bottom&&void 0!==c.left?d.attachTo=!window.isRTL?"bottom-left":"bottom-right":
void 0!==c.bottom&&void 0!==c.right&&(d.attachTo=!window.isRTL?"bottom-right":"bottom-left"))},_updateDomPosition:function(d){if(this.overviewMapDijit){var c={left:"auto",right:"auto",top:"auto",bottom:"auto",width:"auto",zIndex:this.position&&this.position.zIndex||0};d=this._getOverviewPositionByAttach(d);l.mixin(c,d);c=y.getPositionStyle(c);c.position="absolute";u.set(this.domNode,c);u.set(this.overviewMapDijit.domNode,c)}},createOverviewMap:function(d){var c=l.clone(this.config.overviewMap);c.map=
this.map;void 0!==d&&(c.visible=d);this._processAttachTo(c,this.position);d=c.visible;c.visible=!1;c.maximizeButton="maximizeButton"in c?c.maximizeButton:!0;this.overviewMapDijit=new n(c);this._handles.push(m.after(this.overviewMapDijit,"show",l.hitch(this,"_afterOverviewShow")));this._handles.push(m.after(this.overviewMapDijit,"hide",l.hitch(this,"_afterOverviewHide")));this.overviewMapDijit.startup();this._updateDomPosition(c.attachTo);this.domNode.appendChild(this.overviewMapDijit.domNode);d&&
this.overviewMapDijit.show()},_getOverviewPositionByAttach:function(d){var c={};"top-left"===d?(c.left=0,c.top=0):"top-right"===d?(c.right=0,c.top=0):"bottom-left"===d?(c.bottom=0,c.left=0):"bottom-right"===d&&(c.bottom=0,c.right=0);window.isRTL&&(isFinite(c.left)?(c.right=c.left,delete c.left):(c.left=c.right,delete c.right));return c},_onMainMapBasemapChange:function(d){d.layer&&d.layer._basemapGalleryLayerType&&(this._destroyOverviewMap(),this.createOverviewMap(this._showDijit))},onPositionChange:function(d){this.position=
d;this.config.overviewMap.attachTo||(this._destroyOverviewMap(),this.createOverviewMap(this._showDijit))},_destroyOverviewMap:function(){w.forEach(this._handles,function(d){d&&"function"===typeof d.remove&&d.remove()});this.overviewMapDijit&&this.overviewMapDijit.destroy&&(this.overviewMapDijit.destroy(),this.overviewMapDijit=null,f.empty(this.domNode))},_onMainMapResize:function(){this._destroyOverviewMap();this.createOverviewMap(this._showDijit)},onReceiveData:function(d){"BasemapGallery"===d&&
(this._destroyOverviewMap(),this.createOverviewMap(this._showDijit))},onOpen:function(){this._destroyOverviewMap();this.createOverviewMap(this._showDijit)},onClose:function(){this._destroyOverviewMap()},_afterOverviewHide:function(){this._showDijit=!1;u.set(this.domNode,{width:"auto",height:"auto"})},_afterOverviewShow:function(){this._showDijit=!0;u.set(this.domNode,{width:this.overviewMapDijit.width+"px",height:this.overviewMapDijit.height+"px"})}})});