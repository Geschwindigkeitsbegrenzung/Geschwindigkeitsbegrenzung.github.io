// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"esri/tasks/locator":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ./Task ./AddressCandidate".split(" "),function(t,k,q,s,f,d,a,c,e,l,g){return t(l,{declaredClass:"esri.tasks.Locator",_eventMap:{"address-to-locations-complete":["addresses"],"addresses-to-locations-complete":["addresses"],"location-to-address-complete":["address"],"suggest-locations-complete":["suggestions"]},
constructor:function(a){this._geocodeHandler=k.hitch(this,this._geocodeHandler);this._geocodeAddressesHandler=k.hitch(this,this._geocodeAddressesHandler);this._reverseGeocodeHandler=k.hitch(this,this._reverseGeocodeHandler);this.registerConnectEvents()},outSpatialReference:null,setOutSpatialReference:function(a){this.outSpatialReference=a},_geocodeHandler:function(a,c,e,d,l){try{var b=a.candidates,f;c=[];var u,p=b.length,y=a.spatialReference,B;for(u=0;u<p;u++){f=b[u];if(B=f.location)B.spatialReference=
y;c[u]=new g(f)}this._successHandler([c],"onAddressToLocationsComplete",e,l)}catch(k){this._errorHandler(k,d,l)}},_geocodeAddressesHandler:function(a,c,e,d,l){try{var b=a.locations;c=[];var f,u=b.length,p=a.spatialReference,y;for(f=0;f<u;f++){if(y=b[f].location)y.spatialReference=p;c[f]=new g(b[f])}this._successHandler([c],"onAddressesToLocationsComplete",e,l)}catch(B){this._errorHandler(B,d,l)}},addressToLocations:function(a,d,g,l,n){var b,v,u,p,y,B,q;a.address&&(l=g,g=d,d=a.outFields,n=a.searchExtent,
q=a.countryCode,b=a.magicKey,v=a.distance,B=a.categories,a.location&&this.normalization&&(u=a.location.normalize()),p=a.maxLocations,y=a.forStorage,a=a.address);n&&(n=n.shiftCentralMeridian());var t=this.outSpatialReference;a=this._encode(k.mixin({},this._url.query,a,{f:"json",outSR:t&&f.toJson(t.toJson()),outFields:d&&d.join(",")||null,searchExtent:n&&f.toJson(n.toJson()),category:B&&B.join(",")||null,countryCode:q||null,magicKey:b||null,distance:v||null,location:u||null,maxLocations:p||null,forStorage:y||
null}));var D=this._geocodeHandler,A=this._errorHandler,E=new s(e._dfdCanceller);E._pendingDfd=c({url:this._url.path+"/findAddressCandidates",content:a,callbackParamName:"callback",load:function(b,a){D(b,a,g,l,E)},error:function(b){A(b,l,E)}});return E},suggestLocations:function(a){var d;d=new s(e._dfdCanceller);a.hasOwnProperty("location")&&this.normalization&&(a.location=a.location.normalize());a.searchExtent&&(a.searchExtent=a.searchExtent.shiftCentralMeridian());a=this._encode(k.mixin({},this._url.query,
{f:"json",text:a.text,maxSuggestions:a.maxSuggestions,searchExtent:a.searchExtent&&f.toJson(a.searchExtent.toJson()),category:a.categories&&a.categories.join(",")||null,countryCode:a.countryCode||null,location:a.location||null,distance:a.distance||null},{f:"json"}));a=c({url:this._url.path+"/suggest",content:a,callbackParamName:"callback"});d._pendingDfd=a;a.then(k.hitch(this,function(a){a=a.suggestions||[];this.onSuggestLocationsComplete(a);d.resolve(a)}),k.hitch(this,function(a){this._errorHandler(a);
d.reject(a)}));return d},addressesToLocations:function(a,d,g){var l=this.outSpatialReference,n=[],b=a.categories,v=a.countryCode;q.forEach(a.addresses,function(b,a){n.push({attributes:b})});a=this._encode(k.mixin({},this._url.query,{category:b&&b.join(",")||null,sourceCountry:v||null},{addresses:f.toJson({records:n})},{f:"json",outSR:l&&f.toJson(l.toJson())}));var u=this._geocodeAddressesHandler,p=this._errorHandler,y=new s(e._dfdCanceller);y._pendingDfd=c({url:this._url.path+"/geocodeAddresses",
content:a,callbackParamName:"callback",load:function(b,a){u(b,a,d,g,y)},error:function(b){p(b,g,y)}});return y},_reverseGeocodeHandler:function(a,c,e,d,l){try{var b=new g({address:a.address,location:a.location,score:100});this._successHandler([b],"onLocationToAddressComplete",e,l)}catch(f){this._errorHandler(f,d,l)}},locationToAddress:function(a,d,g,l){a&&this.normalization&&(a=a.normalize());var n=this.outSpatialReference;a=this._encode(k.mixin({},this._url.query,{outSR:n&&f.toJson(n.toJson()),location:a&&
f.toJson(a.toJson()),distance:d,f:"json"}));var b=this._reverseGeocodeHandler,v=this._errorHandler,u=new s(e._dfdCanceller);u._pendingDfd=c({url:this._url.path+"/reverseGeocode",content:a,callbackParamName:"callback",load:function(a,c){b(a,c,g,l,u)},error:function(b){v(b,l,u)}});return u},onSuggestLocationsComplete:function(){},onAddressToLocationsComplete:function(){},onAddressesToLocationsComplete:function(){},onLocationToAddressComplete:function(){}})})},"esri/tasks/AddressCandidate":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel","../geometry/Point"],function(t,k,q,s,f){return t(null,{declaredClass:"esri.tasks.AddressCandidate",constructor:function(d){k.mixin(this,d);this.location=new f(this.location)}})})},"esri/tasks/BufferParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../geometry/Polygon ../geometry/jsonUtils".split(" "),function(t,k,q,s,f,d,a,c){return t(null,{declaredClass:"esri.tasks.BufferParameters",geometries:null,
outSpatialReference:null,bufferSpatialReference:null,distances:null,unit:null,unionResults:!1,geodesic:!1,toJson:function(){var e={unit:this.unit,unionResults:this.unionResults,geodesic:this.geodesic},d=this.distances,g=this.outSpatialReference,x=this.bufferSpatialReference,r=q.map(this.geometries,function(c){c="extent"===c.type?a.fromExtent(c):c;return c.toJson()},this),f=this.geometries;if(f&&0<f.length){var m="extent"===f[0].type?"esriGeometryPolygon":c.getJsonType(f[0]);e.geometries=s.toJson({geometryType:m,
geometries:r});e.inSR=f[0].spatialReference.wkid?f[0].spatialReference.wkid:s.toJson(f[0].spatialReference.toJson())}d&&(e.distances=d.join(","));g&&(e.outSR=g.wkid?g.wkid:s.toJson(g.toJson()));x&&(e.bufferSR=x.wkid?x.wkid:s.toJson(x.toJson()));return e}})})},"esri/dijit/AttributeInspector":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/sniff dojo/_base/kernel dojo/has dojo/dom-style dojo/dom-construct ../kernel ../lang ../domUtils ../layers/InheritedDomain ../layers/FeatureLayer dojo/i18n!../nls/jsapi dojo/fx dojox/gfx dijit/_Widget dijit/_Templated dijit/Editor dijit/_editor/plugins/LinkDialog dijit/_editor/plugins/TextColor ./_EventedWidget ./editing/AttachmentEditor ./editing/Util ../tasks/query dijit/form/DateTextBox dijit/form/TextBox dijit/form/NumberTextBox dijit/form/FilteringSelect dijit/form/NumberSpinner dijit/form/Button dijit/form/SimpleTextarea dijit/form/ValidationTextBox dijit/form/TimeTextBox dijit/Tooltip dojo/data/ItemFileReadStore dojox/date/islamic dojox/date/islamic/Date dojox/date/islamic/locale dojo/text!./templates/AttributeInspector.html".split(" "),
function(t,k,q,s,f,d,a,c,e,l,g,x,r,z,m,n,b,v,u,p,y,B,F,I,D,A,E,G,C,h,w,H,O,K,L,N,P,Q,S,R,M){var J=t([F,v,u],{declaredClass:"esri.dijit.AttributeInspector",widgetsInTemplate:!0,templateString:M,onUpdate:function(){},onDelete:function(){},onAttributeChange:function(){},onNext:function(){},onReset:function(){},onCancel:function(){},_navMessage:"( ${idx} ${of} ${numFeatures} )",_currentAttributeFieldName:null,_aiConnects:[],_selection:[],_toolTips:[],_numFeatures:0,_featureIdx:0,_currentLInfo:null,_currentFeature:null,
_rollbackInfo:null,_eventMap:{update:!0,"delete":["feature"],"attribute-change":["feature","fieldName","fieldValue"],next:["feature"],reset:!0,cancel:!0},constructor:function(h,b){k.mixin(this,m.widgets.attributeInspector);h=h||{};!h.featureLayer&&!h.layerInfos&&console.error("esri.AttributeInspector: please provide correct parameter in the constructor");this._datePackage=this._getDatePackage(h);this._layerInfos=h.layerInfos||[{featureLayer:h.featureLayer,options:h.options||[]}];this._layerInfos=
q.filter(this._layerInfos,function(h){return!h.disableAttributeUpdate});this._hideNavButtons=h.hideNavButtons||!1},postCreate:function(){if(q.every(this._layerInfos,function(h){return h.featureLayer.loaded}))this._initLayerInfos(),this._createAttachmentEditor(),this.onFirstFeature();else{var h=this._layerInfos.length;q.forEach(this._layerInfos,function(b){b=b.featureLayer;if(b.loaded)h--;else var a=s.connect(b,"onLoad",this,function(b){s.disconnect(a);a=null;h--;h||(this._initLayerInfos(),this._createAttachmentEditor(),
this.onFirstFeature())})},this)}},destroy:function(){this._destroyAttributeTable();q.forEach(this._aiConnects,s.disconnect);delete this._aiConnects;this._attachmentEditor&&(this._attachmentEditor.destroy(),delete this._attachmentEditor);delete this._layerInfos;this._selection=this._currentFeature=this._currentLInfo=this._attributes=this._layerInfos=null;this.inherited(arguments)},refresh:function(){this._updateSelection()},first:function(){this.onFirstFeature()},last:function(){this.onLastFeature()},
next:function(){this.onNextFeature()},previous:function(){this.onPreviousFeature()},showFeature:function(h,b){b&&(this._createOnlyFirstTime=!0);this._updateSelection([h],b);this._updateUI()},onLayerSelectionChange:function(h,b,a){this._createOnlyFirstTime=!1;this._featureIdx=a===z.SELECTION_NEW?0:this._featureIdx;this._updateSelection();this._updateUI()},onLayerSelectionClear:function(){this._selection&&!(0>=this._selection.length)&&(this._featureIdx=this._numFeatures=0,this._selection=[],this._currentLInfo=
this._currentFeature=null,this._updateUI())},onLayerUpdateEnd:function(h,b,a,c){},onLayerError:function(h,b,a,c){},onLayerEditsError:function(h,b,a,c){},onLayerEditsComplete:function(h,b,a,c){c=c||[];if(c.length){var w=this._selection,e=h.featureLayer.objectIdField;q.forEach(c,k.hitch(this,function(h){q.some(w,k.hitch(this,function(b,a){if(b.attributes[e]!==h.objectId)return!1;this._selection.splice(a,1);return!0}))}))}b=b||[];b.length&&(this._selection=D.findFeatures(b,h.featureLayer),this._featureIdx=
0);c=this._numFeatures=this._selection?this._selection.length:0;if(b.length){if(b=c?this._selection[this._featureIdx]:null)c=b.getLayer().getEditCapabilities(),(!c.canCreate||c.canUpdate)&&this._showFeature(b);this._updateUI()}a=a||[];if(a.length){var d=this._rollbackInfo;q.forEach(a,function(b){var c=D.findFeatures(a,h.featureLayer)[0];if(!b.success&&c.attributes[h.featureLayer.objectIdField]===b.objectId&&d){b=d.graphic.attributes[d.field.name];var w=q.filter(this._currentLInfo.fieldInfos,function(h){return h.fieldName===
d.field.name},this)[0].dijit;c.attributes[d.field.name]=b;this._setValue(w,b)}},this)}this._rollbackInfo=null},onFieldValueChange:function(h,b){var a=h.field,c=h.dijit,w=this._currentFeature,d=this._currentLInfo,e=a.name;if(""!==c.displayedValue&&"undefined"===typeof b&&!c.isValid())this._setValue(c,w.attributes[a.name]);else if(""!==c.displayedValue&&c.displayedValue!==b&&c.isValid&&!c.isValid())this._setValue(c,w.attributes[a.name]);else{b="undefined"===typeof b?null:b;if("esriFieldTypeDate"===
a.type){if(c instanceof Array){var g=c[0].getValue(),c=c[1].getValue();b=g&&c?new Date(g.getFullYear(),g.getMonth(),g.getDate(),c.getHours(),c.getMinutes(),c.getSeconds(),c.getMilliseconds()):g||c||null}else b=c.getValue();b=b&&b.getTime?b.getTime():b&&b.toGregorian?b.toGregorian().getTime():b}if(this._currentFeature.attributes[a.name]!==b){if(e===d.typeIdField){var l=this._findFirst(d.types,"id",b);q.forEach(d.fieldInfos,function(h){if((a=h.field)&&a.name!==d.typeIdField)h=h.dijit,this._setFieldDomain(h,
l,a)&&h&&(this._setValue(h,w.attributes[a.name]+""),!1===h.isValid()&&this._setValue(h,null))},this)}this.onAttributeChange(w,e,b)}}},onDeleteBtn:function(h){this._deleteFeature()},onNextFeature:function(h){this._onNextFeature(1)},onPreviousFeature:function(h){this._onNextFeature(-1)},onFirstFeature:function(h){this._onNextFeature(-1*this._featureIdx)},onLastFeature:function(h){this._onNextFeature(this._numFeatures-1-this._featureIdx)},_initLayerInfos:function(){var h=this._layerInfos;this._editorTrackingInfos=
{};q.forEach(h,this._initLayerInfo,this)},_initLayerInfo:function(h){var b=h.featureLayer,a,c;this._userIds={};c=b.id;b.credential&&(this._userIds[c]=b.credential.userId);h.userId&&(this._userIds[c]=h.userId);this._connect(b,"onSelectionComplete",k.hitch(this,"onLayerSelectionChange",h));this._connect(b,"onSelectionClear",k.hitch(this,"onLayerSelectionClear",h));this._connect(b,"onEditsComplete",k.hitch(this,"onLayerEditsComplete",h));this._connect(b,"error",k.hitch(this,"onLayerError",h));this._connect(b,
"onUpdateEnd",k.hitch(this,"onLayerUpdateEnd",h));h.showAttachments=b.hasAttachments?g.isDefined(h.showAttachments)?h.showAttachments:!0:!1;h.hideFields=h.hideFields||[];h.htmlFields=h.htmlFields||[];h.isEditable=b.isEditable()?g.isDefined(h.isEditable)?h.isEditable:!0:!1;h.typeIdField=b.typeIdField;h.layerId=b.id;h.types=b.types;b.globalIdField&&(a=this._findFirst(h.fieldInfos,"fieldName",b.globalIdField),!a&&!h.showGlobalID&&h.hideFields.push(b.globalIdField));c=this._findFirst(h.fieldInfos,"fieldName",
b.objectIdField);!c&&!h.showObjectID&&h.hideFields.push(b.objectIdField);var w=this._getFields(h.featureLayer);if(w){var d=h.fieldInfos||[],d=q.map(d,function(h){return k.mixin({},h)});d.length?h.fieldInfos=q.filter(q.map(d,k.hitch(this,function(b){var a=b.stringFieldOption||(this._isInFields(b.fieldName,h.htmlFields)?J.STRING_FIELD_OPTION_RICHTEXT:J.STRING_FIELD_OPTION_TEXTBOX);return k.mixin(b,{field:this._findFirst(w,"name",b.fieldName),stringFieldOption:a})})),"return item.field;"):(w=q.filter(w,
k.hitch(this,function(b){return!this._isInFields(b.name,h.hideFields)})),h.fieldInfos=q.map(w,k.hitch(this,function(b){var a=this._isInFields(b.name,h.htmlFields)?J.STRING_FIELD_OPTION_RICHTEXT:J.STRING_FIELD_OPTION_TEXTBOX;return{fieldName:b.name,field:b,stringFieldOption:a}})));h.showGlobalID&&!a&&d.push(this._findFirst(w,"name",b.globalIdField));h.showObjectID&&!c&&d.push(this._findFirst(w,"name",b.objectIdField));a=[];b.editFieldsInfo&&(b.editFieldsInfo.creatorField&&a.push(b.editFieldsInfo.creatorField),
b.editFieldsInfo.creationDateField&&a.push(b.editFieldsInfo.creationDateField),b.editFieldsInfo.editorField&&a.push(b.editFieldsInfo.editorField),b.editFieldsInfo.editDateField&&a.push(b.editFieldsInfo.editDateField));this._editorTrackingInfos[b.id]=a}},_createAttachmentEditor:function(){this._attachmentEditor=null;var h=q.filter(this._layerInfos,function(h){return h.showAttachments});h&&h.length&&(this._attachmentEditor=new I({"class":"atiAttachmentEditor"},this.attachmentEditor),this._attachmentEditor.startup())},
_setCurrentLInfo:function(h){var b=this._currentLInfo?this._currentLInfo.featureLayer:null,a=h.featureLayer;if(b&&(b.id===a.id&&!b.ownershipBasedAccessControlForFeatures)&&(b=a.getEditCapabilities(),!b.canCreate||b.canUpdate))return;this._currentLInfo=h;this._createTable()},_updateSelection:function(h,b){this._selection=h||[];q.forEach(this._layerInfos,this._getSelection,this);var a=this._selection.length;this._numFeatures=this._selection.length;this._showFeature(a?this._selection[this._featureIdx]:
null,b)},_getSelection:function(h){h=h.featureLayer.getSelectedFeatures();this._selection=this._selection.concat(h)},_updateUI:function(){var h=this._numFeatures,b=this._currentLInfo;this.layerName.innerHTML=!b||0===h?this.NLS_noFeaturesSelected:b.featureLayer?b.featureLayer.name:"";c.set(this.attributeTable,"display",h?"":"none");c.set(this.editButtons,"display",h?"":"none");c.set(this.navButtons,"display",!this._hideNavButtons&&1<h?"":"none");this.navMessage.innerHTML=g.substitute({idx:this._featureIdx+
1,of:this.NLS_of,numFeatures:this._numFeatures},this._navMessage);this._attachmentEditor&&c.set(this._attachmentEditor.domNode,"display",b&&b.showAttachments&&h?"":"none");c.set(this.deleteBtn.domNode,"display",!(b&&!1===b.showDeleteButton)&&this._canDelete?"":"none");this.domNode.parentNode&&0<this.domNode.parentNode.scrollTop&&(this.domNode.parentNode.scrollTop=0)},_onNextFeature:function(h){this._featureIdx+=h;0>this._featureIdx?this._featureIdx=this._numFeatures-1:this._featureIdx>=this._numFeatures&&
(this._featureIdx=0);h=this._selection.length?this._selection[this._featureIdx]:null;this._showFeature(h);this._updateUI();this.onNext(h)},_deleteFeature:function(){this.onDelete(this._currentFeature)},_showFeature:function(h,b){if(h){this._currentFeature=h;var a=b?b:h.getLayer(),c=a.getEditCapabilities({feature:h,userId:this._userIds[a.id]});this._canUpdate=c.canUpdate;this._canDelete=c.canDelete;if(c=this._getLInfoFromFeatureLayer(a)){this._setCurrentLInfo(c);var w=h.attributes,d=this._findFirst(c.types,
"id",w[c.typeIdField]),e=null;q.forEach(c.fieldInfos,function(h){e=h.field;var b=[];h.dijit&&1<h.dijit.length?q.forEach(h.dijit,function(h){b.push(h)}):b.push(h.dijit);q.forEach(b,k.hitch(this,function(h){if(h){var b=this._setFieldDomain(h,d,e),a=w[e.name],a=a&&b&&b.codedValues&&b.codedValues.length?b.codedValues[a]?b.codedValues[a].name:a:a;g.isDefined(a)||(a="");"dijit.form.DateTextBox"===h.declaredClass||"dijit.form.TimeTextBox"===h.declaredClass?a=""===a?null:new Date(a):"dijit.form.FilteringSelect"===
h.declaredClass&&(h._lastValueReported=null,a=w[e.name]+"");try{this._setValue(h,a),"dijit.form.FilteringSelect"===h.declaredClass&&!1===h.isValid()&&this._setValue(h,null)}catch(c){h.set("displayedValue",this.NLS_errorInvalid,!1)}}}))},this);this._attachmentEditor&&c.showAttachments&&this._attachmentEditor.showAttachments(this._currentFeature,a);(a=a.getEditSummary(h))?(this.editorTrackingInfoDiv.innerHTML=a,x.show(this.editorTrackingInfoDiv)):x.hide(this.editorTrackingInfoDiv)}}},_setFieldDomain:function(h,
b,a){if(!h)return null;var c=a.domain;b&&b.domains&&b.domains[a.name]&&!1===b.domains[a.name]instanceof r&&(c=b.domains[a.name]);if(!c)return null;c.codedValues&&0<c.codedValues.length?(h.set("store",this._toStore(q.map(c.codedValues,function(h){return{id:h.code+="",name:h.name}}))),this._setValue(h,c.codedValues[0].code)):(h.constraints={min:g.isDefined(c.minValue)?c.minValue:Number.MIN_VALUE,max:g.isDefined(c.maxValue)?c.maxValue:Number.MAX_VALUE},this._setValue(h,h.constraints.min));return c},
_setValue:function(h,b){h.set&&(h._onChangeActive=!1,h.set("value",b,!0),h._onChangeActive=!0)},_getFields:function(h){var b=h._getOutFields();if(!b)return null;h=h.fields;return"*"==b?h:q.filter(q.map(b,k.hitch(this,"_findFirst",h,"name")),g.isDefined)},_isInFields:function(h,b){return!h||!b&&!b.length?!1:q.some(b,function(b){return b.toLowerCase()===h.toLowerCase()})},_findFirst:function(h,b,a){return(h=q.filter(h,function(h){return h.hasOwnProperty(b)&&h[b]===a}))&&h.length?h[0]:null},_getLInfoFromFeatureLayer:function(h){return this._findFirst(this._layerInfos,
"layerId",h?h.id:null)},_createTable:function(){this._destroyAttributeTable();this.attributeTable.innerHTML="";this._attributes=e.create("table",{cellspacing:"0",cellpadding:"0"},this.attributeTable);var h=e.create("tbody",null,this._attributes),b=this._currentLInfo,a=this._findFirst(b.types,"id",this._currentFeature.attributes[b.typeIdField]);q.forEach(b.fieldInfos,k.hitch(this,"_createField",a,h),this);this._createOnlyFirstTime=!1},_createField:function(h,b,a){var c=this._currentLInfo,w=a.field;
if(!this._isInFields(w.name,c.hideFields)&&!this._isInFields(w.name,this._editorTrackingInfos[c.featureLayer.id])){var d=e.create("tr",null,b);b=e.create("td",{innerHTML:a.label||w.alias||w.name,"class":"atiLabel"},d);b=e.create("td",null,d);var g,d=null,l=!1;if(a.customField)e.place(a.customField.domNode||a.customField,e.create("div",null,b),"first"),g=a.customField;else if(!1===c.isEditable||!1===w.editable||!1===a.isEditable||"esriFieldTypeOID"===w.type||"esriFieldTypeGlobalID"===w.type||!this._canUpdate&&
!this._createOnlyFirstTime)l=!0;!g&&c.typeIdField&&w.name.toLowerCase()==c.typeIdField.toLowerCase()?g=this._createTypeField(w,a,b):g||(g=this._createDomainField(w,a,h,b));if(!g)switch(w.type){case "esriFieldTypeString":g=this._createStringField(w,a,b);break;case "esriFieldTypeDate":g=this._createDateField(w,a,b);a.format&&a.format.time&&(d=this._createTimeField(w,a,b));break;case "esriFieldTypeInteger":case "esriFieldTypeSmallInteger":g=this._createIntField(w,a,b);break;case "esriFieldTypeSingle":case "esriFieldTypeDouble":g=
this._createFltField(w,a,b);break;default:g=this._createStringField(w,a,b)}a.tooltip&&a.tooltip.length&&this._toolTips.push(new N({connectId:[g.id],label:a.tooltip}));g.onChange=k.hitch(this,"onFieldValueChange",a);g.set("disabled",l);d?(a.dijit=[g,d],d.onChange=k.hitch(this,"onFieldValueChange",a),d.set("disabled",l)):a.dijit=g}},_createTypeField:function(b,a,c){return(a=b.domain)&&"range"===a.type&&a.minValue===a.maxValue?new G({"class":"atiField"},e.create("div",null,c)):new h({"class":"atiField",
name:b.alias||b.name,required:!b.nullable||!1,store:this._toStore(q.map(this._currentLInfo.types,function(h){return{id:h.id,name:h.name}})),searchAttr:"name"},e.create("div",null,c))},_createDomainField:function(b,a,c,d){a=b.domain;c&&c.domains&&c.domains[b.name]&&!1===c.domains[b.name]instanceof r&&(a=c.domains[b.name]);return!a?null:a.codedValues?new h({"class":"atiField",name:b.alias||b.name,searchAttr:"name",required:!b.nullable||!1},e.create("div",null,d)):new w({"class":"atiField"},e.create("div",
null,d))},_createStringField:function(h,b,a){var c={"class":"atiField",trim:!0,maxLength:h.length};return b.stringFieldOption===J.STRING_FIELD_OPTION_TEXTAREA?(c["class"]+=" atiTextAreaField",new O(c,e.create("div",null,a))):b.stringFieldOption===J.STRING_FIELD_OPTION_RICHTEXT?(c["class"]+=" atiRichTextField",c.height="100%",c.width="100%",c.plugins=b.richTextPlugins||"bold italic underline foreColor hiliteColor | justifyLeft justifyCenter justifyRight justifyFull | insertOrderedList insertUnorderedList indent outdent | createLink".split(" "),
h=new p(c,e.create("div",null,a)),h.startup(),h):!h.nullable||!b.field||!b.field.nullable?new K({required:!0},e.create("div",null,a)):new G(c,e.create("div",null,a))},_createTimeField:function(h,b,a){h={"class":"atiField",trim:!0,constraints:{formatLength:"medium"}};this._datePackage&&(h.datePackage=this._datePackage);return new L(h,e.create("div",null,a))},_createDateField:function(h,b,a){h={"class":"atiField",trim:!0};this._datePackage&&(h.datePackage=this._datePackage);return new E(h,e.create("div",
null,a))},_createIntField:function(h,b,a){return new C({"class":"atiField",constraints:"esriFieldTypeSmallInteger"===h.type?{min:-32768,max:32767,places:0}:{places:0},invalidMessage:this.NLS_validationInt,trim:!0},e.create("div",null,a))},_createFltField:function(h,b,a){var c=/\de[-+]?\d/i,w=/[0-9]\d{0,2}(\.\d{3})*(,\d+)?$/i;return new K({validator:function(h,b){this._maskValidSubsetError=!1;this._hasBeenBlurred=!0;return""===h||null===h?!0:c.test(h)?!0:w.test(h)?("min"in b?0<=this.compare(h,b.min):
1)&&("max"in b?0>=this.compare(h,b.max):1)?!0:!1:!1},"class":"atiField",trim:!0,constraints:{places:"0,40",min:-Infinity,max:Infinity,exponent:!0},invalidMessage:this.NLS_validationFlt},e.create("div",null,a))},_toStore:function(h){return new P({data:{identifier:"id",label:"name",items:h}})},_connect:function(h,b,a){this._aiConnects.push(s.connect(h,b,a))},_getDatePackage:function(h){return null===h.datePackage?null:h.datePackage?h.datePackage:"ar"===d.locale?"dojox.date.islamic":null},_destroyAttributeTable:function(){q.forEach(this._layerInfos,
function(h){q.forEach(h.fieldInfos,function(h){var b=h.dijit;if(b){b._onChangeHandle=null;if(h.customField)return;b instanceof Array?q.forEach(b,k.hitch(this,function(h){h.destroyRecursive?h.destroyRecursive():h.destroy&&h.destroy();h._onChangeHandle=null})):b.destroyRecursive?b.destroyRecursive():b.destroy&&b.destroy()}h.dijit=null},this)},this);q.forEach(this._toolTips,function(h){h.destroy()});this._toolTips=[];this._attributes&&e.destroy(this._attributes)}});k.mixin(J,{STRING_FIELD_OPTION_RICHTEXT:"richtext",
STRING_FIELD_OPTION_TEXTAREA:"textarea",STRING_FIELD_OPTION_TEXTBOX:"textbox"});return J})},"dijit/Editor":function(){define("require dojo/_base/array dojo/_base/declare dojo/Deferred dojo/i18n dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/string dojo/topic ./_Container ./Toolbar ./ToolbarSeparator ./layout/_LayoutWidget ./form/ToggleButton ./_editor/_Plugin ./_editor/plugins/EnterKeyHandling ./_editor/html ./_editor/range ./_editor/RichText ./main dojo/i18n!./_editor/nls/commands".split(" "),
function(t,k,q,s,f,d,a,c,e,l,g,x,r,z,m,n,b,v,u,p,y,B,F,I,D){function A(b){return new p({command:b.name})}function E(b){return new p({buttonClass:u,command:b.name})}q=q("dijit.Editor",I,{plugins:null,extraPlugins:null,constructor:function(){g.isArray(this.plugins)||(this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull",y]);this._plugins=
[];this._editInterval=1E3*this.editActionInterval;if(x("ie")||x("trident"))this.events.push("onBeforeDeactivate"),this.events.push("onBeforeActivate")},postMixInProperties:function(){this.setValueDeferred=new s;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._steps=this._steps.slice(0);this._undoedSteps=this._undoedSteps.slice(0);g.isArray(this.extraPlugins)&&(this.plugins=this.plugins.concat(this.extraPlugins));this.commands=f.getLocalization("dijit._editor","commands",
this.lang);x("webkit")&&e.set(this.domNode,"KhtmlUserSelect","none")},startup:function(){this.inherited(arguments);this.toolbar||(this.toolbar=new n({ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,"aria-label":this.id}),this.header.appendChild(this.toolbar.domNode));k.forEach(this.plugins,this.addPlugin,this);this.setValueDeferred.resolve(!0);a.add(this.iframe.parentNode,"dijitEditorIFrameContainer");a.add(this.iframe,"dijitEditorIFrame");d.set(this.iframe,"allowTransparency",!0);this.toolbar.startup();
this.onNormalizedDisplayChanged()},destroy:function(){k.forEach(this._plugins,function(b){b&&b.destroy&&b.destroy()});this._plugins=[];this.toolbar.destroyRecursive();delete this.toolbar;this.inherited(arguments)},addPlugin:function(b,a){var h=g.isString(b)?{name:b}:g.isFunction(b)?{ctor:b}:b;if(!h.setEditor){var c={args:h,plugin:null,editor:this};h.name&&(p.registry[h.name]?c.plugin=p.registry[h.name](h):z.publish(D._scopeName+".Editor.getPlugin",c));if(!c.plugin)try{var d=h.ctor||g.getObject(h.name)||
t(h.name);d&&(c.plugin=new d(h))}catch(e){throw Error(this.id+": cannot find plugin ["+h.name+"]");}if(!c.plugin)throw Error(this.id+": cannot find plugin ["+h.name+"]");b=c.plugin}1<arguments.length?this._plugins[a]=b:this._plugins.push(b);b.setEditor(this);g.isFunction(b.setToolbar)&&b.setToolbar(this.toolbar)},resize:function(b){b&&v.prototype.resize.apply(this,arguments)},layout:function(){var b=this._contentBox.h-(this.getHeaderHeight()+this.getFooterHeight()+c.getPadBorderExtents(this.iframe.parentNode).h+
c.getMarginExtents(this.iframe.parentNode).h);this.editingArea.style.height=b+"px";this.iframe&&(this.iframe.style.height="100%");this._layoutMode=!0},_onIEMouseDown:function(b){var a,h=this.document.body,c=h.clientWidth,d=h.clientHeight,e=h.clientLeft,g=h.offsetWidth,l=h.offsetHeight,r=h.offsetLeft;/^rtl$/i.test(h.dir||"")?c<g&&(b.x>c&&b.x<g)&&(a=!0):b.x<e&&b.x>r&&(a=!0);a||d<l&&(b.y>d&&b.y<l)&&(a=!0);a||(delete this._cursorToStart,delete this._savedSelection,"BODY"==b.target.tagName&&this.defer("placeCursorAtEnd"),
this.inherited(arguments))},onBeforeActivate:function(){this._restoreSelection()},onBeforeDeactivate:function(b){this.customUndo&&this.endEditing(!0);"BODY"!=b.target.tagName&&this._saveSelection()},customUndo:!0,editActionInterval:3,beginEditing:function(b){this._inEditing||(this._inEditing=!0,this._beginEditing(b));0<this.editActionInterval&&(this._editTimer&&this._editTimer.remove(),this._editTimer=this.defer("endEditing",this._editInterval))},_steps:[],_undoedSteps:[],execCommand:function(b){if(this.customUndo&&
("undo"==b||"redo"==b))return this[b]();this.customUndo&&(this.endEditing(),this._beginEditing());var a=this.inherited(arguments);this.customUndo&&this._endEditing();return a},_pasteImpl:function(){return this._clipboardCommand("paste")},_cutImpl:function(){return this._clipboardCommand("cut")},_copyImpl:function(){return this._clipboardCommand("copy")},_clipboardCommand:function(b){var a;try{if(a=this.document.execCommand(b,!1,null),x("webkit")&&!a)throw{code:1011};}catch(h){if(1011==h.code||9==
h.code&&x("opera"))a=r.substitute,alert(a(this.commands.systemShortcut,[this.commands[b],a(this.commands[x("mac")?"appleKey":"ctrlKey"],[{cut:"X",copy:"C",paste:"V"}[b]])]));a=!1}return a},queryCommandEnabled:function(b){return this.customUndo&&("undo"==b||"redo"==b)?"undo"==b?1<this._steps.length:0<this._undoedSteps.length:this.inherited(arguments)},_moveToBookmark:function(b){var a=b.mark,h=b.mark;b=b.isCollapsed;var c,d,e;if(h)if(9>x("ie")||9===x("ie")&&x("quirks"))if(g.isArray(h))a=[],k.forEach(h,
function(h){a.push(F.getNode(h,this.editNode))},this),this.selection.moveToBookmark({mark:a,isCollapsed:b});else{if(h.startContainer&&h.endContainer&&(e=F.getSelection(this.window))&&e.removeAllRanges)e.removeAllRanges(),b=F.create(this.window),c=F.getNode(h.startContainer,this.editNode),d=F.getNode(h.endContainer,this.editNode),c&&d&&(b.setStart(c,h.startOffset),b.setEnd(d,h.endOffset),e.addRange(b))}else if((e=F.getSelection(this.window))&&e.removeAllRanges)e.removeAllRanges(),b=F.create(this.window),
c=F.getNode(h.startContainer,this.editNode),d=F.getNode(h.endContainer,this.editNode),c&&d&&(b.setStart(c,h.startOffset),b.setEnd(d,h.endOffset),e.addRange(b))},_changeToStep:function(b,a){this.setValue(a.text);var h=a.bookmark;h&&this._moveToBookmark(h)},undo:function(){var b=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var a=this._steps.pop();a&&0<this._steps.length&&(this.focus(),this._changeToStep(a,this._steps[this._steps.length-1]),this._undoedSteps.push(a),this.onDisplayChanged(),
delete this._undoRedoActive,b=!0);delete this._undoRedoActive}return b},redo:function(){var b=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var a=this._undoedSteps.pop();a&&0<this._steps.length&&(this.focus(),this._changeToStep(this._steps[this._steps.length-1],a),this._steps.push(a),this.onDisplayChanged(),b=!0);delete this._undoRedoActive}return b},endEditing:function(b){this._editTimer&&(this._editTimer=this._editTimer.remove());this._inEditing&&(this._endEditing(b),
this._inEditing=!1)},_getBookmark:function(){var b=this.selection.getBookmark(),a=[];if(b&&b.mark){var h=b.mark;if(9>x("ie")||9===x("ie")&&x("quirks")){var c=F.getSelection(this.window);if(g.isArray(h))k.forEach(b.mark,function(b){a.push(F.getIndex(b,this.editNode).o)},this),b.mark=a;else if(c){var d;c.rangeCount&&(d=c.getRangeAt(0));b.mark=d?d.cloneRange():this.selection.getBookmark()}}try{b.mark&&b.mark.startContainer&&(a=F.getIndex(b.mark.startContainer,this.editNode).o,b.mark={startContainer:a,
startOffset:b.mark.startOffset,endContainer:b.mark.endContainer===b.mark.startContainer?a:F.getIndex(b.mark.endContainer,this.editNode).o,endOffset:b.mark.endOffset})}catch(e){b.mark=null}}return b},_beginEditing:function(){0===this._steps.length&&this._steps.push({text:B.getChildrenHtml(this.editNode),bookmark:this._getBookmark()})},_endEditing:function(){var b=B.getChildrenHtml(this.editNode);this._undoedSteps=[];this._steps.push({text:b,bookmark:this._getBookmark()})},onKeyDown:function(b){!x("ie")&&
(!this.iframe&&b.keyCode==l.TAB&&!this.tabIndent)&&this._saveSelection();if(this.customUndo){var a=b.keyCode;if(b.ctrlKey&&!b.shiftKey&&!b.altKey){if(90==a||122==a){b.stopPropagation();b.preventDefault();this.undo();return}if(89==a||121==a){b.stopPropagation();b.preventDefault();this.redo();return}}this.inherited(arguments);switch(a){case l.ENTER:case l.BACKSPACE:case l.DELETE:this.beginEditing();break;case 88:case 86:if(b.ctrlKey&&!b.altKey&&!b.metaKey){this.endEditing();88==b.keyCode?this.beginEditing("cut"):
this.beginEditing("paste");this.defer("endEditing",1);break}default:if(!b.ctrlKey&&!b.altKey&&!b.metaKey&&(b.keyCode<l.F1||b.keyCode>l.F15)){this.beginEditing();break}case l.ALT:this.endEditing();break;case l.UP_ARROW:case l.DOWN_ARROW:case l.LEFT_ARROW:case l.RIGHT_ARROW:case l.HOME:case l.END:case l.PAGE_UP:case l.PAGE_DOWN:this.endEditing(!0);case l.CTRL:case l.SHIFT:case l.TAB:}}else this.inherited(arguments)},_onBlur:function(){this.inherited(arguments);this.endEditing(!0)},_saveSelection:function(){try{this._savedSelection=
this._getBookmark()}catch(b){}},_restoreSelection:function(){this._savedSelection&&(delete this._cursorToStart,this.selection.isCollapsed()&&this._moveToBookmark(this._savedSelection),delete this._savedSelection)},onClick:function(){this.endEditing(!0);this.inherited(arguments)},replaceValue:function(b){this.customUndo?this.isClosed?this.setValue(b):(this.beginEditing(),b||(b="\x26#160;"),this.setValue(b),this.endEditing()):this.inherited(arguments)},_setDisabledAttr:function(b){this.setValueDeferred.then(g.hitch(this,
function(){!this.disabled&&b||!this._buttonEnabledPlugins&&b?k.forEach(this._plugins,function(b){b.set("disabled",!0)}):this.disabled&&!b&&k.forEach(this._plugins,function(b){b.set("disabled",!1)})}));this.inherited(arguments)},_setStateClass:function(){try{this.inherited(arguments),this.document&&this.document.body&&e.set(this.document.body,"color",e.get(this.iframe,"color"))}catch(b){}}});g.mixin(p.registry,{undo:A,redo:A,cut:A,copy:A,paste:A,insertOrderedList:A,insertUnorderedList:A,indent:A,outdent:A,
justifyCenter:A,justifyFull:A,justifyLeft:A,justifyRight:A,"delete":A,selectAll:A,removeFormat:A,unlink:A,insertHorizontalRule:A,bold:E,italic:E,underline:E,strikethrough:E,subscript:E,superscript:E,"|":function(){return new p({setEditor:function(a){this.editor=a;this.button=new b({ownerDocument:a.ownerDocument})}})}});return q})},"dijit/Toolbar":function(){define("require dojo/_base/declare dojo/has dojo/keys dojo/ready ./_Widget ./_KeyNavContainer ./_TemplatedMixin".split(" "),function(t,k,q,s,
f,d,a,c){q("dijit-legacy-requires")&&f(0,function(){t(["dijit/ToolbarSeparator"])});return k("dijit.Toolbar",[d,c,a],{templateString:'\x3cdiv class\x3d"dijit" role\x3d"toolbar" tabIndex\x3d"${tabIndex}" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e',baseClass:"dijitToolbar",_onLeftArrow:function(){this.focusPrev()},_onRightArrow:function(){this.focusNext()}})})},"dijit/ToolbarSeparator":function(){define(["dojo/_base/declare","dojo/dom","./_Widget","./_TemplatedMixin"],function(t,k,q,
s){return t("dijit.ToolbarSeparator",[q,s],{templateString:'\x3cdiv class\x3d"dijitToolbarSeparator dijitInline" role\x3d"presentation"\x3e\x3c/div\x3e',buildRendering:function(){this.inherited(arguments);k.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/_editor/_Plugin":function(){define(["dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","../Destroyable","../form/Button"],function(t,k,q,s,f){k=k("dijit._editor._Plugin",s,{constructor:function(d){this.params=
d||{};q.mixin(this,this.params);this._attrPairNames={}},editor:null,iconClassPrefix:"dijitEditorIcon",button:null,command:"",useDefaultCommand:!0,buttonClass:f,disabled:!1,getLabel:function(d){return this.editor.commands[d]},_initButton:function(){if(this.command.length){var d=this.getLabel(this.command),a=this.editor,c=this.iconClassPrefix+" "+this.iconClassPrefix+this.command.charAt(0).toUpperCase()+this.command.substr(1);this.button||(d=q.mixin({label:d,ownerDocument:a.ownerDocument,dir:a.dir,
lang:a.lang,showLabel:!1,iconClass:c,dropDown:this.dropDown,tabIndex:"-1"},this.params||{}),delete d.name,this.button=new this.buttonClass(d))}this.get("disabled")&&this.button&&this.button.set("disabled",this.get("disabled"))},destroy:function(){this.dropDown&&this.dropDown.destroyRecursive();this.inherited(arguments)},connect:function(d,a,c){this.own(t.connect(d,a,this,c))},updateState:function(){var d=this.editor,a=this.command,c,e;if(d&&d.isLoaded&&a.length){var l=this.get("disabled");if(this.button)try{e=
!l&&d.queryCommandEnabled(a),this.enabled!==e&&(this.enabled=e,this.button.set("disabled",!e)),e&&"boolean"==typeof this.button.checked&&(c=d.queryCommandState(a),this.checked!==c&&(this.checked=c,this.button.set("checked",d.queryCommandState(a))))}catch(g){console.log(g)}}},setEditor:function(d){this.editor=d;this._initButton();this.button&&this.useDefaultCommand&&(this.editor.queryCommandAvailable(this.command)?this.own(this.button.on("click",q.hitch(this.editor,"execCommand",this.command,this.commandArg))):
this.button.domNode.style.display="none");this.own(this.editor.on("NormalizedDisplayChanged",q.hitch(this,"updateState")))},setToolbar:function(d){this.button&&d.addChild(this.button)},set:function(d,a){if("object"===typeof d){for(var c in d)this.set(c,d[c]);return this}c=this._getAttrNames(d);if(this[c.s])var e=this[c.s].apply(this,Array.prototype.slice.call(arguments,1));else this._set(d,a);return e||this},get:function(d){var a=this._getAttrNames(d);return this[a.g]?this[a.g]():this[d]},_setDisabledAttr:function(d){this._set("disabled",
d);this.updateState()},_getAttrNames:function(d){var a=this._attrPairNames;if(a[d])return a[d];var c=d.charAt(0).toUpperCase()+d.substr(1);return a[d]={s:"_set"+c+"Attr",g:"_get"+c+"Attr"}},_set:function(d,a){this[d]=a}});k.registry={};return k})},"dijit/_editor/plugins/EnterKeyHandling":function(){define("dojo/_base/declare dojo/dom-construct dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ../_Plugin ../RichText ../range".split(" "),function(t,k,q,s,f,d,a,c,e,l,g){return t("dijit._editor.plugins.EnterKeyHandling",
e,{blockNodeForEnter:"BR",constructor:function(a){a&&("blockNodeForEnter"in a&&(a.blockNodeForEnter=a.blockNodeForEnter.toUpperCase()),s.mixin(this,a))},setEditor:function(a){if(this.editor!==a)if(this.editor=a,"BR"==this.blockNodeForEnter)this.editor.customUndo=!0,a.onLoadDeferred.then(s.hitch(this,function(c){this.own(f(a.document,"keydown",s.hitch(this,function(a){if(a.keyCode==q.ENTER){var c=s.mixin({},a);c.shiftKey=!0;this.handleEnterKey(c)||(a.stopPropagation(),a.preventDefault())}})));9<=d("ie")&&
10>=d("ie")&&this.own(f(a.document,"paste",s.hitch(this,function(a){setTimeout(s.hitch(this,function(){var a=this.editor.document.selection.createRange();a.move("character",-1);a.select();a.move("character",1);a.select()}),0)})));return c}));else if(this.blockNodeForEnter){var c=s.hitch(this,"handleEnterKey");a.addKeyHandler(13,0,0,c);a.addKeyHandler(13,0,1,c);this.own(this.editor.on("KeyPressed",s.hitch(this,"onKeyPressed")))}},onKeyPressed:function(){if(this._checkListLater){if(this.editor.selection.isCollapsed()){var a=
this.editor.selection.getAncestorElement("LI");if(a){d("mozilla")&&"LI"==a.parentNode.parentNode.nodeName&&(a=a.parentNode.parentNode);var c=a.firstChild;if(c&&1==c.nodeType&&("UL"==c.nodeName||"OL"==c.nodeName))a.insertBefore(c.ownerDocument.createTextNode("\u00a0"),c),c=g.create(this.editor.window),c.setStart(a.firstChild,0),a=g.getSelection(this.editor.window,!0),a.removeAllRanges(),a.addRange(c)}else l.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter),(a=this.editor.selection.getAncestorElement(this.blockNodeForEnter))?
(a.innerHTML=this.bogusHtmlContent,9>=d("ie")&&(a=this.editor.document.selection.createRange(),a.move("character",-1),a.select())):console.error("onKeyPressed: Cannot find the new block node")}this._checkListLater=!1}this._pressedEnterInBlock&&(this._pressedEnterInBlock.previousSibling&&this.removeTrailingBr(this._pressedEnterInBlock.previousSibling),delete this._pressedEnterInBlock)},bogusHtmlContent:"\x26#160;",blockNodes:/^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,handleEnterKey:function(a){var e,f,m,n,b=this.editor.document,
v,u,p;if(a.shiftKey){a=this.editor.selection.getParentElement();if(n=g.getAncestor(a,this.blockNodes)){if("LI"==n.tagName)return!0;a=g.getSelection(this.editor.window);e=a.getRangeAt(0);e.collapsed||(e.deleteContents(),a=g.getSelection(this.editor.window),e=a.getRangeAt(0));if(g.atBeginningOfContainer(n,e.startContainer,e.startOffset))v=b.createElement("br"),e=g.create(this.editor.window),n.insertBefore(v,n.firstChild),e.setStartAfter(v),a.removeAllRanges(),a.addRange(e);else if(g.atEndOfContainer(n,
e.startContainer,e.startOffset))e=g.create(this.editor.window),v=b.createElement("br"),n.appendChild(v),n.appendChild(b.createTextNode("\u00a0")),e.setStart(n.lastChild,0),a.removeAllRanges(),a.addRange(e);else return(u=e.startContainer)&&3==u.nodeType?(p=u.nodeValue,f=b.createTextNode(p.substring(0,e.startOffset)),m=b.createTextNode(p.substring(e.startOffset)),n=b.createElement("br"),""==m.nodeValue&&d("webkit")&&(m=b.createTextNode("\u00a0")),k.place(f,u,"after"),k.place(n,f,"after"),k.place(m,
n,"after"),k.destroy(u),e=g.create(this.editor.window),e.setStart(m,0),a.removeAllRanges(),a.addRange(e),!1):!0}else if(a=g.getSelection(this.editor.window),a.rangeCount){if((e=a.getRangeAt(0))&&e.startContainer)e.collapsed||(e.deleteContents(),a=g.getSelection(this.editor.window),e=a.getRangeAt(0)),(u=e.startContainer)&&3==u.nodeType?(n=e.startOffset,u.length<n&&(m=this._adjustNodeAndOffset(u,n),u=m.node,n=m.offset),p=u.nodeValue,f=b.createTextNode(p.substring(0,n)),m=b.createTextNode(p.substring(n)),
n=b.createElement("br"),m.length||(m=b.createTextNode("\u00a0")),f.length?k.place(f,u,"after"):f=u,k.place(n,f,"after"),k.place(m,n,"after"),k.destroy(u)):(0<=e.startOffset&&(v=u.childNodes[e.startOffset]),n=b.createElement("br"),m=b.createTextNode("\u00a0"),v?(k.place(n,v,"before"),k.place(m,n,"after")):(u.appendChild(n),u.appendChild(m))),e=g.create(this.editor.window),e.setStart(m,0),e.setEnd(m,m.length),a.removeAllRanges(),a.addRange(e),this.editor.selection.collapse(!0)}else l.prototype.execCommand.call(this.editor,
"inserthtml","\x3cbr\x3e");return!1}var y=!0;a=g.getSelection(this.editor.window);e=a.getRangeAt(0);e.collapsed||(e.deleteContents(),a=g.getSelection(this.editor.window),e=a.getRangeAt(0));v=g.getBlockAncestor(e.endContainer,null,this.editor.editNode);var B=v.blockNode;if(this._checkListLater=B&&("LI"==B.nodeName||"LI"==B.parentNode.nodeName))return d("mozilla")&&(this._pressedEnterInBlock=B),/^(\s|&nbsp;|&#160;|\xA0|<span\b[^>]*\bclass=['"]Apple-style-span['"][^>]*>(\s|&nbsp;|&#160;|\xA0)<\/span>)?(<br>)?$/.test(B.innerHTML)&&
(B.innerHTML="",d("webkit")&&(e=g.create(this.editor.window),e.setStart(B,0),a.removeAllRanges(),a.addRange(e)),this._checkListLater=!1),!0;if(!v.blockNode||v.blockNode===this.editor.editNode){try{l.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter)}catch(q){}v={blockNode:this.editor.selection.getAncestorElement(this.blockNodeForEnter),blockContainer:this.editor.editNode};if(v.blockNode){if(v.blockNode!=this.editor.editNode&&!(v.blockNode.textContent||v.blockNode.innerHTML).replace(/^\s+|\s+$/g,
"").length)return this.removeTrailingBr(v.blockNode),!1}else v.blockNode=this.editor.editNode;a=g.getSelection(this.editor.window);e=a.getRangeAt(0)}B=b.createElement(this.blockNodeForEnter);B.innerHTML=this.bogusHtmlContent;this.removeTrailingBr(v.blockNode);m=e.endOffset;y=e.endContainer;y.length<m&&(m=this._adjustNodeAndOffset(y,m),y=m.node,m=m.offset);if(g.atEndOfContainer(v.blockNode,y,m))v.blockNode===v.blockContainer?v.blockNode.appendChild(B):k.place(B,v.blockNode,"after"),y=!1,e=g.create(this.editor.window),
e.setStart(B,0),a.removeAllRanges(),a.addRange(e),this.editor.height&&c.scrollIntoView(B);else if(g.atBeginningOfContainer(v.blockNode,e.startContainer,e.startOffset))k.place(B,v.blockNode,v.blockNode===v.blockContainer?"first":"before"),B.nextSibling&&this.editor.height&&(e=g.create(this.editor.window),e.setStart(B.nextSibling,0),a.removeAllRanges(),a.addRange(e),c.scrollIntoView(B.nextSibling)),y=!1;else{v.blockNode===v.blockContainer?v.blockNode.appendChild(B):k.place(B,v.blockNode,"after");y=
!1;v.blockNode.style&&(B.style&&v.blockNode.style.cssText)&&(B.style.cssText=v.blockNode.style.cssText);if((u=e.startContainer)&&3==u.nodeType){m=e.endOffset;u.length<m&&(m=this._adjustNodeAndOffset(u,m),u=m.node,m=m.offset);p=u.nodeValue;f=b.createTextNode(p.substring(0,m));m=b.createTextNode(p.substring(m,p.length));k.place(f,u,"before");k.place(m,u,"after");k.destroy(u);for(f=f.parentNode;f!==v.blockNode;){p=b.createElement(f.tagName);f.style&&(p.style&&f.style.cssText)&&(p.style.cssText=f.style.cssText);
"FONT"===f.tagName&&(f.color&&(p.color=f.color),f.face&&(p.face=f.face),f.size&&(p.size=f.size));for(e=m;e;)u=e.nextSibling,p.appendChild(e),e=u;k.place(p,f,"after");m=p;f=f.parentNode}e=m;if(1==e.nodeType||3==e.nodeType&&e.nodeValue)B.innerHTML="";for(f=e;e;)u=e.nextSibling,B.appendChild(e),e=u}e=g.create(this.editor.window);b=f;if("BR"!==this.blockNodeForEnter){for(;b;)n=b,b=u=b.firstChild;n&&n.parentNode?(B=n.parentNode,e.setStart(B,0),a.removeAllRanges(),a.addRange(e),this.editor.height&&c.scrollIntoView(B),
d("mozilla")&&(this._pressedEnterInBlock=v.blockNode)):y=!0}else e.setStart(B,0),a.removeAllRanges(),a.addRange(e),this.editor.height&&c.scrollIntoView(B),d("mozilla")&&(this._pressedEnterInBlock=v.blockNode)}return y},_adjustNodeAndOffset:function(a,c){for(;a.length<c&&a.nextSibling&&3==a.nextSibling.nodeType;)c-=a.length,a=a.nextSibling;return{node:a,offset:c}},removeTrailingBr:function(a){if(a=/P|DIV|LI/i.test(a.tagName)?a:this.editor.selection.getParentOfType(a,["P","DIV","LI"]))a.lastChild&&
(1<a.childNodes.length&&3==a.lastChild.nodeType&&/^[\s\xAD]*$/.test(a.lastChild.nodeValue)||"BR"==a.lastChild.tagName)&&k.destroy(a.lastChild),a.childNodes.length||(a.innerHTML=this.bogusHtmlContent)}})})},"dijit/_editor/RichText":function(){define("dojo/_base/array dojo/_base/config dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/query dojo/domReady dojo/sniff dojo/topic dojo/_base/unload dojo/_base/url dojo/window ../_Widget ../_CssStateMixin ../selection ./range ./html ../focus ../main".split(" "),
function(t,k,q,s,f,d,a,c,e,l,g,x,r,z,m,n,b,v,u,p,y,B,F,I,D,A,E,G){var C=q("dijit._editor.RichText",[B,F],{constructor:function(b){this.contentPreFilters=[];this.contentPostFilters=[];this.contentDomPreFilters=[];this.contentDomPostFilters=[];this.editingAreaStyleSheets=[];this.events=[].concat(this.events);this._keyHandlers={};b&&r.isString(b.value)&&(this.value=b.value);this.onLoadDeferred=new s},baseClass:"dijitEditor",inheritWidth:!1,focusOnLoad:!1,name:"",styleSheets:"",height:"300px",minHeight:"1em",
isClosed:!0,isLoaded:!1,_SEPARATOR:"@@**%%__RICHTEXTBOUNDRY__%%**@@",_NAME_CONTENT_SEP:"@@**%%:%%**@@",onLoadDeferred:null,isTabIndent:!1,disableSpellCheck:!1,postCreate:function(){"textarea"===this.domNode.tagName.toLowerCase()&&console.warn("RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.");this.contentPreFilters=[r.trim,r.hitch(this,"_preFixUrlAttributes")].concat(this.contentPreFilters);b("mozilla")&&(this.contentPreFilters=[this._normalizeFontStyle].concat(this.contentPreFilters),
this.contentPostFilters=[this._removeMozBogus].concat(this.contentPostFilters));b("webkit")&&(this.contentPreFilters=[this._removeWebkitBogus].concat(this.contentPreFilters),this.contentPostFilters=[this._removeWebkitBogus].concat(this.contentPostFilters));if(b("ie")||b("trident"))this.contentPostFilters=[this._normalizeFontStyle].concat(this.contentPostFilters),this.contentDomPostFilters=[r.hitch(this,"_stripBreakerNodes")].concat(this.contentDomPostFilters);this.contentDomPostFilters=[r.hitch(this,
"_stripTrailingEmptyNodes")].concat(this.contentDomPostFilters);this.inherited(arguments);v.publish(G._scopeName+"._editor.RichText::init",this)},startup:function(){this.inherited(arguments);this.open();this.setupDefaultShortcuts()},setupDefaultShortcuts:function(){var h=r.hitch(this,function(b,h){return function(){return!this.execCommand(b,h)}}),a={b:h("bold"),i:h("italic"),u:h("underline"),a:h("selectall"),s:function(){this.save(!0)},m:function(){this.isTabIndent=!this.isTabIndent},1:h("formatblock",
"h1"),2:h("formatblock","h2"),3:h("formatblock","h3"),4:h("formatblock","h4"),"\\":h("insertunorderedlist")};b("ie")||(a.Z=h("redo"));for(var c in a)this.addKeyHandler(c,!0,!1,a[c])},events:["onKeyDown","onKeyUp"],captureEvents:[],_editorCommandsLocalized:!1,_localizeEditorCommands:function(){if(C._editorCommandsLocalized)this._local2NativeFormatNames=C._local2NativeFormatNames,this._native2LocalFormatNames=C._native2LocalFormatNames;else{C._editorCommandsLocalized=!0;C._local2NativeFormatNames={};
C._native2LocalFormatNames={};this._local2NativeFormatNames=C._local2NativeFormatNames;this._native2LocalFormatNames=C._native2LocalFormatNames;for(var b="div p pre h1 h2 h3 h4 h5 h6 ol ul address".split(" "),a="",e,d=0;e=b[d++];)a="l"!==e.charAt(1)?a+("\x3c"+e+"\x3e\x3cspan\x3econtent\x3c/span\x3e\x3c/"+e+"\x3e\x3cbr/\x3e"):a+("\x3c"+e+"\x3e\x3cli\x3econtent\x3c/li\x3e\x3c/"+e+"\x3e\x3cbr/\x3e");var g=c.create("div",{style:{position:"absolute",top:"0px",zIndex:10,opacity:0.01},innerHTML:a});this.ownerDocumentBody.appendChild(g);
b=r.hitch(this,function(){for(var b=g.firstChild;b;)try{this.selection.selectElement(b.firstChild);var h=b.tagName.toLowerCase();this._local2NativeFormatNames[h]=document.queryCommandValue("formatblock");this._native2LocalFormatNames[this._local2NativeFormatNames[h]]=h;b=b.nextSibling.nextSibling}catch(a){}c.destroy(g)});this.defer(b)}},open:function(h){if(!this.onLoadDeferred||0<=this.onLoadDeferred.fired)this.onLoadDeferred=new s;this.isClosed||this.close();v.publish(G._scopeName+"._editor.RichText::open",
this);1===arguments.length&&h.nodeName&&(this.domNode=h);var e=this.domNode,g;if(r.isString(this.value))g=this.value,e.innerHTML="";else if(e.nodeName&&"textarea"==e.nodeName.toLowerCase()){var p=this.textarea=e;this.name=p.name;g=p.value;e=this.domNode=this.ownerDocument.createElement("div");e.setAttribute("widgetId",this.id);p.removeAttribute("widgetId");e.cssText=p.cssText;e.className+=" "+p.className;c.place(e,p,"before");var m=r.hitch(this,function(){l.set(p,{display:"block",position:"absolute",
top:"-1000px"});if(b("ie")){var h=p.style;this.__overflow=h.overflow;h.overflow="hidden"}});b("ie")?this.defer(m,10):m();if(p.form){var n=p.value;this.reset=function(){this.getValue()!==n&&this.replaceValue(n)};z(p.form,"submit",r.hitch(this,function(){d.set(p,"disabled",this.disabled);p.value=this.getValue()}))}}else g=A.getChildrenHtml(e),e.innerHTML="";this.value=g;e.nodeName&&"LI"===e.nodeName&&(e.innerHTML=" \x3cbr\x3e");this.header=e.ownerDocument.createElement("div");e.appendChild(this.header);
this.editingArea=e.ownerDocument.createElement("div");e.appendChild(this.editingArea);this.footer=e.ownerDocument.createElement("div");e.appendChild(this.footer);this.name||(this.name=this.id+"_AUTOGEN");if(""!==this.name&&(!k.useXDomain||k.allowXdRichTextSave)){if((g=f.byId(G._scopeName+"._editor.RichText.value"))&&""!==g.value)for(var m=g.value.split(this._SEPARATOR),y=0,B;B=m[y++];)if(B=B.split(this._NAME_CONTENT_SEP),B[0]===this.name){this.value=B[1];m=m.splice(y,1);g.value=m.join(this._SEPARATOR);
break}C._globalSaveHandler||(C._globalSaveHandler={},u.addOnUnload(function(){for(var b in C._globalSaveHandler){var h=C._globalSaveHandler[b];r.isFunction(h)&&h()}}));C._globalSaveHandler[this.id]=r.hitch(this,"_saveContent")}this.isClosed=!1;g=this.editorObject=this.iframe=this.ownerDocument.createElement("iframe");g.id=this.id+"_iframe";g.style.border="none";g.style.width="100%";this._layoutMode?g.style.height="100%":7<=b("ie")?(this.height&&(g.style.height=this.height),this.minHeight&&(g.style.minHeight=
this.minHeight)):g.style.height=this.height?this.height:this.minHeight;g.frameBorder=0;g._loadFunc=r.hitch(this,function(h){this.window=h;this.document=h.document;this.selection=new I.SelectionManager(h);b("ie")&&this._localizeEditorCommands();this.onLoad(this.get("value"))});m=this._getIframeDocTxt().replace(/\\/g,"\\\\").replace(/'/g,"\\'");m=11>b("ie")?'javascript:document.open();try{parent.window;}catch(e){document.domain\x3d"'+document.domain+"\";}document.write('"+m+"');document.close()":"javascript: '"+
m+"'";9==b("ie")?(this.editingArea.appendChild(g),g.src=m):(g.setAttribute("src",m),this.editingArea.appendChild(g));"LI"===e.nodeName&&(e.lastChild.style.marginTop="-1.2em");a.add(this.domNode,this.baseClass)},_local2NativeFormatNames:{},_native2LocalFormatNames:{},_getIframeDocTxt:function(){var h=l.getComputedStyle(this.domNode),a=[h.fontWeight,h.fontSize,h.fontFamily].join(" "),c=h.lineHeight,c=0<=c.indexOf("px")?parseFloat(c)/parseFloat(h.fontSize):0<=c.indexOf("em")?parseFloat(c):"normal",e=
"",d=this;this.style.replace(/(^|;)\s*(line-|font-?)[^;]+/ig,function(b){b=b.replace(/^;/ig,"")+";";var h=b.split(":")[0];if(h){var h=r.trim(h),h=h.toLowerCase(),a,c="";for(a=0;a<h.length;a++){var g=h.charAt(a);switch(g){case "-":a++,g=h.charAt(a).toUpperCase();default:c+=g}}l.set(d.domNode,c,"")}e+=b+";"});var h=m('label[for\x3d"'+this.id+'"]'),g="";h.length?g=h[0].innerHTML:this["aria-label"]?g=this["aria-label"]:this["aria-labelledby"]&&(g=f.byId(this["aria-labelledby"]).innerHTML);this.iframe.setAttribute("title",
g);return["\x3c!DOCTYPE html\x3e",this.isLeftToRight()?"\x3chtml lang\x3d'"+this.lang+"'\x3e\n\x3chead\x3e\n":"\x3chtml dir\x3d'rtl' lang\x3d'"+this.lang+"'\x3e\n\x3chead\x3e\n",g?"\x3ctitle\x3e"+g+"\x3c/title\x3e":"","\x3cmeta http-equiv\x3d'Content-Type' content\x3d'text/html'\x3e\n\x3cstyle\x3e\n\tbody,html {\n\t\tbackground:transparent;\n\t\tpadding: 1px 0 0 0;\n\t\tmargin: -1px 0 0 0;\n\t}\n\tbody,html,#dijitEditorBody { outline: none; }html { height: 100%; width: 100%; overflow: hidden; }\n",
this.height?"\tbody,#dijitEditorBody { height: 100%; width: 100%; overflow: auto; }\n":"\tbody,#dijitEditorBody { min-height: "+this.minHeight+"; width: 100%; overflow-x: auto; overflow-y: hidden; }\n","\tbody{\n\t\ttop:0px;\n\t\tleft:0px;\n\t\tright:0px;\n\t\tfont:",a,";\n",this.height||b("opera")?"":"\t\tposition: fixed;\n","\t\tline-height:",c,";\n\t}\n\tp{ margin: 1em 0; }\n\tli \x3e ul:-moz-first-node, li \x3e ol:-moz-first-node{ padding-top: 1.2em; }\n",b("ie")||b("trident")?"":"\tli{ min-height:1.2em; }\n",
"\x3c/style\x3e\n",this._applyEditingAreaStyleSheets(),"\n\x3c/head\x3e\n\x3cbody role\x3d'main' ","onload\x3d'try{frameElement \x26\x26 frameElement._loadFunc(window,document)}catch(e){document.domain\x3d\""+document.domain+"\";frameElement._loadFunc(window,document)}' ","style\x3d'"+e+"'\x3e","\x3cdiv id\x3d'dijitEditorBody'\x3e\x3c/div\x3e\x3c/body\x3e\n\x3c/html\x3e"].join("")},_applyEditingAreaStyleSheets:function(){var b=[];this.styleSheets&&(b=this.styleSheets.split(";"),this.styleSheets="");
b=b.concat(this.editingAreaStyleSheets);this.editingAreaStyleSheets=[];for(var a="",c=0,e,d=y.get(this.ownerDocument);e=b[c++];)e=(new p(d.location,e)).toString(),this.editingAreaStyleSheets.push(e),a+='\x3clink rel\x3d"stylesheet" type\x3d"text/css" href\x3d"'+e+'"/\x3e';return a},addStyleSheet:function(b){var a=b.toString(),c=y.get(this.ownerDocument);if("."===a.charAt(0)||"/"!==a.charAt(0)&&!b.host)a=(new p(c.location,a)).toString();-1<t.indexOf(this.editingAreaStyleSheets,a)||(this.editingAreaStyleSheets.push(a),
this.onLoadDeferred.then(r.hitch(this,function(){if(this.document.createStyleSheet)this.document.createStyleSheet(a);else{var b=this.document.getElementsByTagName("head")[0],h=this.document.createElement("link");h.rel="stylesheet";h.type="text/css";h.href=a;b.appendChild(h)}})))},removeStyleSheet:function(b){var a=b.toString(),c=y.get(this.ownerDocument);if("."===a.charAt(0)||"/"!==a.charAt(0)&&!b.host)a=(new p(c.location,a)).toString();b=t.indexOf(this.editingAreaStyleSheets,a);-1!==b&&(delete this.editingAreaStyleSheets[b],
m('link[href\x3d"'+a+'"]',this.window.document).orphan())},disabled:!1,_mozSettingProps:{styleWithCSS:!1},_setDisabledAttr:function(h){h=!!h;this._set("disabled",h);if(this.isLoaded){var a=b("ie")&&(this.isLoaded||!this.focusOnLoad);a&&(this.editNode.unselectable="on");this.editNode.contentEditable=!h;this.editNode.tabIndex=h?"-1":this.tabIndex;a&&this.defer(function(){this.editNode&&(this.editNode.unselectable="off")});if(b("mozilla")&&!h&&this._mozSettingProps){h=this._mozSettingProps;for(var c in h)if(h.hasOwnProperty(c))try{this.document.execCommand(c,
!1,h[c])}catch(e){}}this._disabledOK=!0}},onLoad:function(h){this.window.__registeredWindow||(this.window.__registeredWindow=!0,this._iframeRegHandle=E.registerIframe(this.iframe));this.editNode=this.document.body.firstChild;var a=this;this.beforeIframeNode=c.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"before");this.afterIframeNode=c.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"after");this.iframe.onfocus=this.document.onfocus=function(){a.editNode.focus()};this.focusNode=
this.editNode;var e=this.events.concat(this.captureEvents),d=this.iframe?this.document:this.editNode;this.own.apply(this,t.map(e,function(b){var h=b.toLowerCase().replace(/^on/,"");return z(d,h,r.hitch(this,b))},this));this.own(z(d,"mouseup",r.hitch(this,"onClick")));b("ie")&&(this.own(z(this.document,"mousedown",r.hitch(this,"_onIEMouseDown"))),this.editNode.style.zoom=1);b("webkit")&&(this._webkitListener=this.own(z(this.document,"mouseup",r.hitch(this,"onDisplayChanged")))[0],this.own(z(this.document,
"mousedown",r.hitch(this,function(b){(b=b.target)&&(b===this.document.body||b===this.document)&&this.defer("placeCursorAtEnd")}))));if(b("ie"))try{this.document.execCommand("RespectVisibilityInDesign",!0,null)}catch(g){}this.isLoaded=!0;this.set("disabled",this.disabled);e=r.hitch(this,function(){this.setValue(h);this.onLoadDeferred&&!this.onLoadDeferred.isFulfilled()&&this.onLoadDeferred.resolve(!0);this.onDisplayChanged();this.focusOnLoad&&n(r.hitch(this,"defer","focus",this.updateInterval));this.value=
this.getValue(!0)});this.setValueDeferred?this.setValueDeferred.then(e):e()},onKeyDown:function(h){if(h.keyCode===x.SHIFT||h.keyCode===x.ALT||h.keyCode===x.META||h.keyCode===x.CTRL)return!0;if(h.keyCode===x.TAB&&this.isTabIndent&&(h.stopPropagation(),h.preventDefault(),this.queryCommandEnabled(h.shiftKey?"outdent":"indent")))this.execCommand(h.shiftKey?"outdent":"indent");if(h.keyCode==x.TAB&&!this.isTabIndent&&!h.ctrlKey&&!h.altKey)return h.shiftKey?this.beforeIframeNode.focus():this.afterIframeNode.focus(),
!0;9>b("ie")&&(h.keyCode===x.BACKSPACE&&"Control"===this.document.selection.type)&&(h.stopPropagation(),h.preventDefault(),this.execCommand("delete"));b("ff")&&(h.keyCode===x.PAGE_UP||h.keyCode===x.PAGE_DOWN)&&this.editNode.clientHeight>=this.editNode.scrollHeight&&h.preventDefault();var a=this._keyHandlers[h.keyCode],c=arguments;a&&!h.altKey&&t.some(a,function(b){if(!(b.shift^h.shiftKey)&&!(b.ctrl^(h.ctrlKey||h.metaKey)))return b.handler.apply(this,c)||h.preventDefault(),!0},this);this.defer("onKeyPressed",
1);return!0},onKeyUp:function(){},setDisabled:function(b){g.deprecated("dijit.Editor::setDisabled is deprecated",'use dijit.Editor::attr("disabled",boolean) instead',2);this.set("disabled",b)},_setValueAttr:function(b){this.setValue(b)},_setDisableSpellCheckAttr:function(b){this.document?d.set(this.document.body,"spellcheck",!b):this.onLoadDeferred.then(r.hitch(this,function(){d.set(this.document.body,"spellcheck",!b)}));this._set("disableSpellCheck",b)},addKeyHandler:function(b,a,c,e){"string"==
typeof b&&(b=b.toUpperCase().charCodeAt(0));r.isArray(this._keyHandlers[b])||(this._keyHandlers[b]=[]);this._keyHandlers[b].push({shift:c||!1,ctrl:a||!1,handler:e})},onKeyPressed:function(){this.onDisplayChanged()},onClick:function(b){this.onDisplayChanged(b)},_onIEMouseDown:function(){!this.focused&&!this.disabled&&this.focus()},_onBlur:function(a){(b("ie")||b("trident"))&&this.defer(function(){E.curNode||this.ownerDocumentBody.focus()});this.inherited(arguments);var c=this.getValue(!0);if(c!==this.value)this.onChange(c);
this._set("value",c)},_onFocus:function(b){this.disabled||(this._disabledOK||this.set("disabled",!1),this.inherited(arguments))},blur:function(){!b("ie")&&this.window.document.documentElement&&this.window.document.documentElement.focus?this.window.document.documentElement.focus():this.ownerDocumentBody.focus&&this.ownerDocumentBody.focus()},focus:function(){this.isLoaded?9>b("ie")?this.iframe.fireEvent("onfocus",document.createEventObject()):this.editNode.focus():this.focusOnLoad=!0},updateInterval:200,
_updateTimer:null,onDisplayChanged:function(){this._updateTimer&&this._updateTimer.remove();this._updateTimer=this.defer("onNormalizedDisplayChanged",this.updateInterval)},onNormalizedDisplayChanged:function(){delete this._updateTimer},onChange:function(){},_normalizeCommand:function(a,c){var e=a.toLowerCase();"formatblock"===e?b("safari")&&void 0===c&&(e="heading"):"hilitecolor"===e&&!b("mozilla")&&(e="backcolor");return e},_qcaCache:{},queryCommandAvailable:function(b){var a=this._qcaCache[b];return void 0!==
a?a:this._qcaCache[b]=this._queryCommandAvailable(b)},_queryCommandAvailable:function(a){function c(b){return{ie:Boolean(b&e),mozilla:Boolean(b&d),webkit:Boolean(b&g),opera:Boolean(b&l)}}var e=1,d=2,g=4,l=8,p=null;switch(a.toLowerCase()){case "bold":case "italic":case "underline":case "subscript":case "superscript":case "fontname":case "fontsize":case "forecolor":case "hilitecolor":case "justifycenter":case "justifyfull":case "justifyleft":case "justifyright":case "delete":case "selectall":case "toggledir":p=
c(d|e|g|l);break;case "createlink":case "unlink":case "removeformat":case "inserthorizontalrule":case "insertimage":case "insertorderedlist":case "insertunorderedlist":case "indent":case "outdent":case "formatblock":case "inserthtml":case "undo":case "redo":case "strikethrough":case "tabindent":p=c(d|e|l|g);break;case "blockdirltr":case "blockdirrtl":case "dirltr":case "dirrtl":case "inlinedirltr":case "inlinedirrtl":p=c(e);break;case "cut":case "copy":case "paste":p=c(e|d|g|l);break;case "inserttable":p=
c(d|e);break;case "insertcell":case "insertcol":case "insertrow":case "deletecells":case "deletecols":case "deleterows":case "mergecells":case "splitcell":p=c(e|d);break;default:return!1}return(b("ie")||b("trident"))&&p.ie||b("mozilla")&&p.mozilla||b("webkit")&&p.webkit||b("opera")&&p.opera},execCommand:function(a,c){var e;this.focused&&this.focus();a=this._normalizeCommand(a,c);if(void 0!==c){if("heading"===a)throw Error("unimplemented");if("formatblock"===a&&(b("ie")||b("trident")))c="\x3c"+c+"\x3e"}var d=
"_"+a+"Impl";if(this[d])e=this[d](c);else if((c=1<arguments.length?c:null)||"createlink"!==a)e=this.document.execCommand(a,!1,c);this.onDisplayChanged();return e},queryCommandEnabled:function(b){if(this.disabled||!this._disabledOK)return!1;b=this._normalizeCommand(b);var a="_"+b+"EnabledImpl";return this[a]?this[a](b):this._browserQueryCommandEnabled(b)},queryCommandState:function(b){if(this.disabled||!this._disabledOK)return!1;b=this._normalizeCommand(b);try{return this.document.queryCommandState(b)}catch(a){return!1}},
queryCommandValue:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);if((b("ie")||b("trident"))&&"formatblock"===a)a=this._native2LocalFormatNames[this.document.queryCommandValue(a)];else if(b("mozilla")&&"hilitecolor"===a){var c;try{c=this.document.queryCommandValue("styleWithCSS")}catch(e){c=!1}this.document.execCommand("styleWithCSS",!1,!0);a=this.document.queryCommandValue(a);this.document.execCommand("styleWithCSS",!1,c)}else a=this.document.queryCommandValue(a);
return a},_sCall:function(b,a){return this.selection[b].apply(this.selection,a)},placeCursorAtStart:function(){this.focus();var a=!1;if(b("mozilla"))for(var c=this.editNode.firstChild;c;){if(3===c.nodeType){if(0<c.nodeValue.replace(/^\s+|\s+$/g,"").length){a=!0;this.selection.selectElement(c);break}}else if(1===c.nodeType){var a=!0,e=c.tagName?c.tagName.toLowerCase():"";/br|input|img|base|meta|area|basefont|hr|link/.test(e)?this.selection.selectElement(c):this.selection.selectElementChildren(c);break}c=
c.nextSibling}else a=!0,this.selection.selectElementChildren(this.editNode);a&&this.selection.collapse(!0)},placeCursorAtEnd:function(){this.focus();var a=!1;if(b("mozilla"))for(var c=this.editNode.lastChild;c;){if(3===c.nodeType){if(0<c.nodeValue.replace(/^\s+|\s+$/g,"").length){a=!0;this.selection.selectElement(c);break}}else if(1===c.nodeType){a=!0;this.selection.selectElement(c.lastChild||c);break}c=c.previousSibling}else a=!0,this.selection.selectElementChildren(this.editNode);a&&this.selection.collapse(!1)},
getValue:function(b){return this.textarea&&(this.isClosed||!this.isLoaded)?this.textarea.value:this.isLoaded?this._postFilterContent(null,b):this.value},_getValueAttr:function(){return this.getValue(!0)},setValue:function(b){if(this.isLoaded){if(this.textarea&&(this.isClosed||!this.isLoaded))this.textarea.value=b;else{b=this._preFilterContent(b);var a=this.isClosed?this.domNode:this.editNode;a.innerHTML=b;this._preDomFilterContent(a)}this.onDisplayChanged();this._set("value",this.getValue(!0))}else this.onLoadDeferred.then(r.hitch(this,
function(){this.setValue(b)}))},replaceValue:function(a){this.isClosed?this.setValue(a):this.window&&this.window.getSelection&&!b("mozilla")?this.setValue(a):this.window&&this.window.getSelection?(a=this._preFilterContent(a),this.execCommand("selectall"),this.execCommand("inserthtml",a),this._preDomFilterContent(this.editNode)):this.document&&this.document.selection&&this.setValue(a);this._set("value",this.getValue(!0))},_preFilterContent:function(b){var a=b;t.forEach(this.contentPreFilters,function(b){b&&
(a=b(a))});return a},_preDomFilterContent:function(b){b=b||this.editNode;t.forEach(this.contentDomPreFilters,function(a){a&&r.isFunction(a)&&a(b)},this)},_postFilterContent:function(b,a){var c;r.isString(b)?c=b:(b=b||this.editNode,this.contentDomPostFilters.length&&(a&&(b=r.clone(b)),t.forEach(this.contentDomPostFilters,function(a){b=a(b)})),c=A.getChildrenHtml(b));r.trim(c.replace(/^\xA0\xA0*/,"").replace(/\xA0\xA0*$/,"")).length||(c="");t.forEach(this.contentPostFilters,function(b){c=b(c)});return c},
_saveContent:function(){var b=f.byId(G._scopeName+"._editor.RichText.value");b&&(b.value&&(b.value+=this._SEPARATOR),b.value+=this.name+this._NAME_CONTENT_SEP+this.getValue(!0))},escapeXml:function(b,a){b=b.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");a||(b=b.replace(/'/gm,"\x26#39;"));return b},getNodeHtml:function(b){g.deprecated("dijit.Editor::getNodeHtml is deprecated","use dijit/_editor/html::getNodeHtml instead",2);return A.getNodeHtml(b)},
getNodeChildrenHtml:function(b){g.deprecated("dijit.Editor::getNodeChildrenHtml is deprecated","use dijit/_editor/html::getChildrenHtml instead",2);return A.getChildrenHtml(b)},close:function(h){if(!this.isClosed){arguments.length||(h=!0);h&&this._set("value",this.getValue(!0));this.interval&&clearInterval(this.interval);this._webkitListener&&(this._webkitListener.remove(),delete this._webkitListener);b("ie")&&(this.iframe.onfocus=null);this.iframe._loadFunc=null;this._iframeRegHandle&&(this._iframeRegHandle.remove(),
delete this._iframeRegHandle);if(this.textarea){var e=this.textarea.style;e.position="";e.left=e.top="";b("ie")&&(e.overflow=this.__overflow,this.__overflow=null);this.textarea.value=this.value;c.destroy(this.domNode);this.domNode=this.textarea}else this.domNode.innerHTML=this.value;delete this.iframe;a.remove(this.domNode,this.baseClass);this.isClosed=!0;this.isLoaded=!1;delete this.editNode;delete this.focusNode;this.window&&this.window._frameElement&&(this.window._frameElement=null);this.editorObject=
this.editingArea=this.document=this.window=null}},destroy:function(){this.isClosed||this.close(!1);this._updateTimer&&this._updateTimer.remove();this.inherited(arguments);C._globalSaveHandler&&delete C._globalSaveHandler[this.id]},_removeMozBogus:function(b){return b.replace(/\stype="_moz"/gi,"").replace(/\s_moz_dirty=""/gi,"").replace(/_moz_resizing="(true|false)"/gi,"")},_removeWebkitBogus:function(b){b=b.replace(/\sclass="webkit-block-placeholder"/gi,"");b=b.replace(/\sclass="apple-style-span"/gi,
"");return b=b.replace(/<meta charset=\"utf-8\" \/>/gi,"")},_normalizeFontStyle:function(b){return b.replace(/<(\/)?strong([ \>])/gi,"\x3c$1b$2").replace(/<(\/)?em([ \>])/gi,"\x3c$1i$2")},_preFixUrlAttributes:function(b){return b.replace(/(?:(<a(?=\s).*?\shref=)("|')(.*?)\2)|(?:(<a\s.*?href=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2").replace(/(?:(<img(?=\s).*?\ssrc=)("|')(.*?)\2)|(?:(<img\s.*?src=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2")},_browserQueryCommandEnabled:function(a){if(!a)return!1;
var c=9>b("ie")?this.document.selection.createRange():this.document;try{return c.queryCommandEnabled(a)}catch(e){return!1}},_createlinkEnabledImpl:function(){var a=!0;return a=b("opera")?this.window.getSelection().isCollapsed?!0:this.document.queryCommandEnabled("createlink"):this._browserQueryCommandEnabled("createlink")},_unlinkEnabledImpl:function(){var a=!0;return a=b("mozilla")||b("webkit")?this.selection.hasAncestorElement("a"):this._browserQueryCommandEnabled("unlink")},_inserttableEnabledImpl:function(){var a=
!0;return a=b("mozilla")||b("webkit")?!0:this._browserQueryCommandEnabled("inserttable")},_cutEnabledImpl:function(){var a=!0;b("webkit")?((a=this.window.getSelection())&&(a=a.toString()),a=!!a):a=this._browserQueryCommandEnabled("cut");return a},_copyEnabledImpl:function(){var a=!0;b("webkit")?((a=this.window.getSelection())&&(a=a.toString()),a=!!a):a=this._browserQueryCommandEnabled("copy");return a},_pasteEnabledImpl:function(){var a=!0;return b("webkit")?!0:a=this._browserQueryCommandEnabled("paste")},
_inserthorizontalruleImpl:function(a){return b("ie")?this._inserthtmlImpl("\x3chr\x3e"):this.document.execCommand("inserthorizontalrule",!1,a)},_unlinkImpl:function(a){return this.queryCommandEnabled("unlink")&&(b("mozilla")||b("webkit"))?(a=this.selection.getAncestorElement("a"),this.selection.selectElement(a),this.document.execCommand("unlink",!1,null)):this.document.execCommand("unlink",!1,a)},_hilitecolorImpl:function(a){var c;this._handleTextColorOrProperties("hilitecolor",a)||(b("mozilla")?
(this.document.execCommand("styleWithCSS",!1,!0),console.log("Executing color command."),c=this.document.execCommand("hilitecolor",!1,a),this.document.execCommand("styleWithCSS",!1,!1)):c=this.document.execCommand("hilitecolor",!1,a));return c},_backcolorImpl:function(a){b("ie")&&(a=a?a:null);var c=this._handleTextColorOrProperties("backcolor",a);c||(c=this.document.execCommand("backcolor",!1,a));return c},_forecolorImpl:function(a){b("ie")&&(a=a?a:null);var c=!1;(c=this._handleTextColorOrProperties("forecolor",
a))||(c=this.document.execCommand("forecolor",!1,a));return c},_inserthtmlImpl:function(a){a=this._preFilterContent(a);var e=!0;if(9>b("ie")){var d=this.document.selection.createRange();if("CONTROL"===this.document.selection.type.toUpperCase()){for(var g=d.item(0);d.length;)d.remove(d.item(0));g.outerHTML=a}else d.pasteHTML(a);d.select()}else if(8>b("trident")){var l=D.getSelection(this.window);if(l&&l.rangeCount&&l.getRangeAt){d=l.getRangeAt(0);d.deleteContents();var p=c.create("div");p.innerHTML=
a;for(var f,g=this.document.createDocumentFragment();a=p.firstChild;)f=g.appendChild(a);d.insertNode(g);f&&(d=d.cloneRange(),d.setStartAfter(f),d.collapse(!1),l.removeAllRanges(),l.addRange(d))}}else b("mozilla")&&!a.length?this.selection.remove():e=this.document.execCommand("inserthtml",!1,a);return e},_boldImpl:function(a){var c=!1;if(b("ie")||b("trident"))this._adaptIESelection(),c=this._adaptIEFormatAreaAndExec("bold");c||(c=this.document.execCommand("bold",!1,a));return c},_italicImpl:function(a){var c=
!1;if(b("ie")||b("trident"))this._adaptIESelection(),c=this._adaptIEFormatAreaAndExec("italic");c||(c=this.document.execCommand("italic",!1,a));return c},_underlineImpl:function(a){var c=!1;if(b("ie")||b("trident"))this._adaptIESelection(),c=this._adaptIEFormatAreaAndExec("underline");c||(c=this.document.execCommand("underline",!1,a));return c},_strikethroughImpl:function(a){var c=!1;if(b("ie")||b("trident"))this._adaptIESelection(),c=this._adaptIEFormatAreaAndExec("strikethrough");c||(c=this.document.execCommand("strikethrough",
!1,a));return c},_superscriptImpl:function(a){var c=!1;if(b("ie")||b("trident"))this._adaptIESelection(),c=this._adaptIEFormatAreaAndExec("superscript");c||(c=this.document.execCommand("superscript",!1,a));return c},_subscriptImpl:function(a){var c=!1;if(b("ie")||b("trident"))this._adaptIESelection(),c=this._adaptIEFormatAreaAndExec("subscript");c||(c=this.document.execCommand("subscript",!1,a));return c},_fontnameImpl:function(a){var c;if(b("ie")||b("trident"))c=this._handleTextColorOrProperties("fontname",
a);c||(c=this.document.execCommand("fontname",!1,a));return c},_fontsizeImpl:function(a){var c;if(b("ie")||b("trident"))c=this._handleTextColorOrProperties("fontsize",a);c||(c=this.document.execCommand("fontsize",!1,a));return c},_insertorderedlistImpl:function(a){var c=!1;if(b("ie")||b("trident"))c=this._adaptIEList("insertorderedlist",a);c||(c=this.document.execCommand("insertorderedlist",!1,a));return c},_insertunorderedlistImpl:function(a){var c=!1;if(b("ie")||b("trident"))c=this._adaptIEList("insertunorderedlist",
a);c||(c=this.document.execCommand("insertunorderedlist",!1,a));return c},getHeaderHeight:function(){return this._getNodeChildrenHeight(this.header)},getFooterHeight:function(){return this._getNodeChildrenHeight(this.footer)},_getNodeChildrenHeight:function(b){var a=0;if(b&&b.childNodes){var c;for(c=0;c<b.childNodes.length;c++)var d=e.position(b.childNodes[c]),a=a+d.h}return a},_isNodeEmpty:function(b,a){return 1===b.nodeType?0<b.childNodes.length?this._isNodeEmpty(b.childNodes[0],a):!0:3===b.nodeType?
""===b.nodeValue.substring(a):!1},_removeStartingRangeFromRange:function(b,a){if(b.nextSibling)a.setStart(b.nextSibling,0);else{for(var c=b.parentNode;c&&null==c.nextSibling;)c=c.parentNode;c&&a.setStart(c.nextSibling,0)}return a},_adaptIESelection:function(){var b=D.getSelection(this.window);if(b&&b.rangeCount&&!b.isCollapsed){for(var a=b.getRangeAt(0),c=a.startContainer,e=a.startOffset;3===c.nodeType&&e>=c.length&&c.nextSibling;)e-=c.length,c=c.nextSibling;for(var d=null;this._isNodeEmpty(c,e)&&
c!==d;)d=c,a=this._removeStartingRangeFromRange(c,a),c=a.startContainer,e=0;b.removeAllRanges();b.addRange(a)}},_adaptIEFormatAreaAndExec:function(b){var a=D.getSelection(this.window),e=this.document,d,g,l,p,f,m,n;if(b&&a&&a.isCollapsed){if(this.queryCommandValue(b)){b=this._tagNamesForCommand(b);l=a.getRangeAt(0);p=l.startContainer;3===p.nodeType&&(g=l.endOffset,p.length<g&&(g=this._adjustNodeAndOffset(d,g),p=g.node));for(;p&&p!==this.editNode;){d=p.tagName?p.tagName.toLowerCase():"";if(-1<t.indexOf(b,
d)){n=p;break}p=p.parentNode}if(n&&(d=l.startContainer,b=e.createElement(n.tagName),c.place(b,n,"after"),d&&3===d.nodeType)){g=l.endOffset;d.length<g&&(g=this._adjustNodeAndOffset(d,g),d=g.node,g=g.offset);p=d.nodeValue;l=e.createTextNode(p.substring(0,g));var y=p.substring(g,p.length);y&&(f=e.createTextNode(y));c.place(l,d,"before");f&&(m=e.createElement("span"),m.className="ieFormatBreakerSpan",c.place(m,d,"after"),c.place(f,m,"after"),f=m);c.destroy(d);l=l.parentNode;for(d=[];l!==n;){p=l.tagName;
g={tagName:p};d.push(g);p=e.createElement(p);l.style&&(p.style&&l.style.cssText)&&(p.style.cssText=l.style.cssText,g.cssText=l.style.cssText);"FONT"===l.tagName&&(l.color&&(p.color=l.color,g.color=l.color),l.face&&(p.face=l.face,g.face=l.face),l.size&&(p.size=l.size,g.size=l.size));l.className&&(p.className=l.className,g.className=l.className);if(f)for(;f;)g=f.nextSibling,p.appendChild(f),f=g;p.tagName==l.tagName?(m=e.createElement("span"),m.className="ieFormatBreakerSpan",c.place(m,l,"after"),c.place(p,
m,"after")):c.place(p,l,"after");f=p;l=l.parentNode}if(f){if(1===f.nodeType||3===f.nodeType&&f.nodeValue)b.innerHTML="";for(;f;)g=f.nextSibling,b.appendChild(f),f=g}if(d.length){g=d.pop();f=e.createElement(g.tagName);g.cssText&&f.style&&(f.style.cssText=g.cssText);g.className&&(f.className=g.className);"FONT"===g.tagName&&(g.color&&(f.color=g.color),g.face&&(f.face=g.face),g.size&&(f.size=g.size));for(c.place(f,b,"before");d.length;)g=d.pop(),n=e.createElement(g.tagName),g.cssText&&n.style&&(n.style.cssText=
g.cssText),g.className&&(n.className=g.className),"FONT"===g.tagName&&(g.color&&(n.color=g.color),g.face&&(n.face=g.face),g.size&&(n.size=g.size)),f.appendChild(n),f=n;n=e.createTextNode(".");m.appendChild(n);f.appendChild(n)}else m=e.createElement("span"),m.className="ieFormatBreakerSpan",n=e.createTextNode("."),m.appendChild(n),c.place(m,b,"before");f=D.create(this.window);f.setStart(n,0);f.setEnd(n,n.length);a.removeAllRanges();a.addRange(f);this.selection.collapse(!1);n.parentNode.innerHTML="";
b.firstChild||c.destroy(b);return!0}return!1}l=a.getRangeAt(0);if((d=l.startContainer)&&3===d.nodeType)return g=l.startOffset,d.length<g&&(g=this._adjustNodeAndOffset(d,g),d=g.node,g=g.offset),p=d.nodeValue,l=e.createTextNode(p.substring(0,g)),y=p.substring(g),""!==y&&(f=e.createTextNode(p.substring(g))),m=e.createElement("span"),n=e.createTextNode("."),m.appendChild(n),l.length?c.place(l,d,"after"):l=d,c.place(m,l,"after"),f&&c.place(f,m,"after"),c.destroy(d),f=D.create(this.window),f.setStart(n,
0),f.setEnd(n,n.length),a.removeAllRanges(),a.addRange(f),e.execCommand(b),c.place(m.firstChild,m,"before"),c.destroy(m),f.setStart(n,0),f.setEnd(n,n.length),a.removeAllRanges(),a.addRange(f),this.selection.collapse(!1),n.parentNode.innerHTML="",!0}else return!1},_adaptIEList:function(b){var a=D.getSelection(this.window);if(a.isCollapsed&&a.rangeCount&&!this.queryCommandValue(b)){var e=a.getRangeAt(0),d=e.startContainer;if(d&&3==d.nodeType&&!e.startOffset)return e="ul","insertorderedlist"===b&&(e=
"ol"),b=this.document.createElement(e),e=c.create("li",null,b),c.place(b,d,"before"),e.appendChild(d),c.create("br",null,b,"after"),b=D.create(this.window),b.setStart(d,0),b.setEnd(d,d.length),a.removeAllRanges(),a.addRange(b),this.selection.collapse(!0),!0}return!1},_handleTextColorOrProperties:function(a,e){var d=D.getSelection(this.window),g=this.document,p,f,m,n,y;e=e||null;if(a&&(d&&d.isCollapsed)&&d.rangeCount&&(f=d.getRangeAt(0),(p=f.startContainer)&&3===p.nodeType)){y=f.startOffset;p.length<
y&&(f=this._adjustNodeAndOffset(p,y),p=f.node,y=f.offset);m=p.nodeValue;f=g.createTextNode(m.substring(0,y));""!==m.substring(y)&&(n=g.createTextNode(m.substring(y)));m=g.createElement("span");y=g.createTextNode(".");m.appendChild(y);g=g.createElement("span");m.appendChild(g);f.length?c.place(f,p,"after"):f=p;c.place(m,f,"after");n&&c.place(n,m,"after");c.destroy(p);p=D.create(this.window);p.setStart(y,0);p.setEnd(y,y.length);d.removeAllRanges();d.addRange(p);if(b("webkit")){d="color";if("hilitecolor"===
a||"backcolor"===a)d="backgroundColor";l.set(m,d,e);this.selection.remove();c.destroy(g);m.innerHTML="\x26#160;";this.selection.selectElement(m);this.focus()}else this.execCommand(a,e),c.place(m.firstChild,m,"before"),c.destroy(m),p.setStart(y,0),p.setEnd(y,y.length),d.removeAllRanges(),d.addRange(p),this.selection.collapse(!1),y.parentNode.removeChild(y);return!0}return!1},_adjustNodeAndOffset:function(b,a){for(;b.length<a&&b.nextSibling&&3===b.nextSibling.nodeType;)a-=b.length,b=b.nextSibling;return{node:b,
offset:a}},_tagNamesForCommand:function(b){return"bold"===b?["b","strong"]:"italic"===b?["i","em"]:"strikethrough"===b?["s","strike"]:"superscript"===b?["sup"]:"subscript"===b?["sub"]:"underline"===b?["u"]:[]},_stripBreakerNodes:function(b){if(this.isLoaded)return m(".ieFormatBreakerSpan",b).forEach(function(b){for(;b.firstChild;)c.place(b.firstChild,b,"before");c.destroy(b)}),b},_stripTrailingEmptyNodes:function(b){for(;b.lastChild&&(/^(p|div|br)$/i.test(b.lastChild.nodeName)&&0==b.lastChild.children.length&&
/^[\s\xA0]*$/.test(b.lastChild.textContent||b.lastChild.innerText||"")||3===b.lastChild.nodeType&&/^[\s\xA0]*$/.test(b.lastChild.nodeValue));)c.destroy(b.lastChild);return b},_setTextDirAttr:function(b){this._set("textDir",b);this.onLoadDeferred.then(r.hitch(this,function(){this.editNode.dir=b}))}});return C})},"dijit/_editor/range":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/lang"],function(t,k,q){var s={getIndex:function(a,c){for(var e=[],d=[],g=a,f,r;a!=c;){var k=0;for(f=
a.parentNode;r=f.childNodes[k++];)if(r===a){--k;break}e.unshift(k);d.unshift(k-f.childNodes.length);a=f}if(0<e.length&&3==g.nodeType){for(r=g.previousSibling;r&&3==r.nodeType;)e[e.length-1]--,r=r.previousSibling;for(r=g.nextSibling;r&&3==r.nodeType;)d[d.length-1]++,r=r.nextSibling}return{o:e,r:d}},getNode:function(a,c){if(!q.isArray(a)||0==a.length)return c;var e=c;t.every(a,function(a){if(0<=a&&a<e.childNodes.length)e=e.childNodes[a];else return e=null,!1;return!0});return e},getCommonAncestor:function(a,
c,e){e=e||a.ownerDocument.body;var d=function(a){for(var c=[];a;)if(c.unshift(a),a!==e)a=a.parentNode;else break;return c};a=d(a);c=d(c);for(var d=Math.min(a.length,c.length),g=a[0],f=1;f<d;f++)if(a[f]===c[f])g=a[f];else break;return g},getAncestor:function(a,c,e){for(e=e||a.ownerDocument.body;a&&a!==e;){var d=a.nodeName.toUpperCase();if(c.test(d))return a;a=a.parentNode}return null},BlockTagNames:/^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/,getBlockAncestor:function(a,c,e){e=e||a.ownerDocument.body;
c=c||s.BlockTagNames;for(var d=null,g;a&&a!==e;){var f=a.nodeName.toUpperCase();!d&&c.test(f)&&(d=a);!g&&/^(?:BODY|TD|TH|CAPTION)$/.test(f)&&(g=a);a=a.parentNode}return{blockNode:d,blockContainer:g||a.ownerDocument.body}},atBeginningOfContainer:function(a,c,e){var d=!1,g=0==e;!g&&3==c.nodeType&&/^[\s\xA0]+$/.test(c.nodeValue.substr(0,e))&&(g=!0);if(g)for(d=!0;c&&c!==a;){if(c.previousSibling){d=!1;break}c=c.parentNode}return d},atEndOfContainer:function(a,c,e){var d=!1,g=e==(c.length||c.childNodes.length);
!g&&3==c.nodeType&&/^[\s\xA0]+$/.test(c.nodeValue.substr(e))&&(g=!0);if(g)for(d=!0;c&&c!==a;){if(c.nextSibling){d=!1;break}c=c.parentNode}return d},adjacentNoneTextNode:function(a,c){for(var e=a,d=0-a.length||0,g=c?"nextSibling":"previousSibling";e&&3==e.nodeType;)d+=e.length,e=e[g];return[e,d]},create:function(a){a=a||window;return a.getSelection?a.document.createRange():new d},getSelection:function(a,c){if(a.getSelection)return a.getSelection();var e=new f.selection(a);c||e._getCurrentSelection();
return e}};if(!window.getSelection)var f=s.ie={cachedSelection:{},selection:function(a){this._ranges=[];this.addRange=function(a,e){this._ranges.push(a);e||a._select();this.rangeCount=this._ranges.length};this.removeAllRanges=function(){this._ranges=[];this.rangeCount=0};this.getRangeAt=function(a){return this._ranges[a]};this._getCurrentSelection=function(){this.removeAllRanges();var c;c=a.document.selection.createRange();c="CONTROL"==a.document.selection.type.toUpperCase()?new d(f.decomposeControlRange(c)):
new d(f.decomposeTextRange(c));c?(this.addRange(c,!0),this.isCollapsed=c.collapsed):this.isCollapsed=!0}},decomposeControlRange:function(a){var c=a.item(0),e=a.item(a.length-1);a=c.parentNode;var d=e.parentNode,c=s.getIndex(c,a).o[0],e=s.getIndex(e,d).o[0]+1;return[a,c,d,e]},getEndPoint:function(a,c){var e=a.duplicate();e.collapse(!c);var d="EndTo"+(c?"End":"Start"),g=e.parentElement(),f,r,k;0<g.childNodes.length?t.every(g.childNodes,function(c,b){var m;if(3!=c.nodeType)if(e.moveToElementText(c),
0<e.compareEndPoints(d,a))if(k&&3==k.nodeType)f=k,m=!0;else return f=g,r=b,!1;else{if(b==g.childNodes.length-1)return f=g,r=g.childNodes.length,!1}else b==g.childNodes.length-1&&(f=c,m=!0);if(m&&f){f=(m=s.adjacentNoneTextNode(f)[0])?m.nextSibling:g.firstChild;var u=s.adjacentNoneTextNode(f);m=u[0];u=u[1];m?(e.moveToElementText(m),e.collapse(!1)):e.moveToElementText(g);e.setEndPoint(d,a);r=e.text.length-u;return!1}k=c;return!0}):(f=g,r=0);if(!c&&1==f.nodeType&&r==f.childNodes.length){var m=f.nextSibling;
m&&3==m.nodeType&&(f=m,r=0)}return[f,r]},setEndPoint:function(a,c,e){a=a.duplicate();var d;if(3!=c.nodeType)if(0<e){if(d=c.childNodes[e-1])if(3==d.nodeType)c=d,e=d.length;else if(d.nextSibling&&3==d.nextSibling.nodeType)c=d.nextSibling,e=0;else{a.moveToElementText(d.nextSibling?d:c);var g=d.parentNode;d=g.insertBefore(d.ownerDocument.createTextNode(" "),d.nextSibling);a.collapse(!1);g.removeChild(d)}}else a.moveToElementText(c),a.collapse(!0);3==c.nodeType&&(d=s.adjacentNoneTextNode(c),g=d[0],d=d[1],
g?(a.moveToElementText(g),a.collapse(!1),"inherit"!=g.contentEditable&&d++):(a.moveToElementText(c.parentNode),a.collapse(!0),a.move("character",1),a.move("character",-1)),e+=d,0<e&&a.move("character",e)!=e&&console.error("Error when moving!"));return a},decomposeTextRange:function(a){var c=f.getEndPoint(a),e=c[0],d=c[1],g=c[0],c=c[1];a.htmlText.length&&(a.htmlText==a.text?c=d+a.text.length:(c=f.getEndPoint(a,!0),g=c[0],c=c[1]));return[e,d,g,c]},setRange:function(a,c,e,d,g,k){c=f.setEndPoint(a,c,
e);a.setEndPoint("StartToStart",c);if(!k)var r=f.setEndPoint(a,d,g);a.setEndPoint("EndToEnd",r||c);return a}},d=s.W3CRange=k(null,{constructor:function(){0<arguments.length?(this.setStart(arguments[0][0],arguments[0][1]),this.setEnd(arguments[0][2],arguments[0][3])):(this.startContainer=this.commonAncestorContainer=null,this.startOffset=0,this.endContainer=null,this.endOffset=0,this.collapsed=!0)},_updateInternal:function(){this.commonAncestorContainer=this.startContainer!==this.endContainer?s.getCommonAncestor(this.startContainer,
this.endContainer):this.startContainer;this.collapsed=this.startContainer===this.endContainer&&this.startOffset==this.endOffset},setStart:function(a,c){c=parseInt(c);this.startContainer===a&&this.startOffset==c||(delete this._cachedBookmark,this.startContainer=a,this.startOffset=c,this.endContainer?this._updateInternal():this.setEnd(a,c))},setEnd:function(a,c){c=parseInt(c);this.endContainer===a&&this.endOffset==c||(delete this._cachedBookmark,this.endContainer=a,this.endOffset=c,this.startContainer?
this._updateInternal():this.setStart(a,c))},setStartAfter:function(a,c){this._setPoint("setStart",a,c,1)},setStartBefore:function(a,c){this._setPoint("setStart",a,c,0)},setEndAfter:function(a,c){this._setPoint("setEnd",a,c,1)},setEndBefore:function(a,c){this._setPoint("setEnd",a,c,0)},_setPoint:function(a,c,e,d){e=s.getIndex(c,c.parentNode).o;this[a](c.parentNode,e.pop()+d)},_getIERange:function(){var a=(this._body||this.endContainer.ownerDocument.body).createTextRange();f.setRange(a,this.startContainer,
this.startOffset,this.endContainer,this.endOffset,this.collapsed);return a},getBookmark:function(){this._getIERange();return this._cachedBookmark},_select:function(){this._getIERange().select()},deleteContents:function(){var a=this.startContainer,c=this._getIERange();3===a.nodeType&&!this.startOffset&&this.setStartBefore(a);c.pasteHTML("");this.endContainer=this.startContainer;this.endOffset=this.startOffset;this.collapsed=!0},cloneRange:function(){var a=new d([this.startContainer,this.startOffset,
this.endContainer,this.endOffset]);a._body=this._body;return a},detach:function(){this.startContainer=this.commonAncestorContainer=this._body=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=!0}});q.setObject("dijit.range",s);return s})},"dijit/_editor/html":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/sniff"],function(t,k,q){var s={};k.setObject("dijit._editor.html",s);var f=s.escapeXml=function(d,a){d=d.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,
"\x26gt;").replace(/"/gm,"\x26quot;");a||(d=d.replace(/'/gm,"\x26#39;"));return d};s.getNodeHtml=function(d){var a=[];s.getNodeHtmlHelper(d,a);return a.join("")};s.getNodeHtmlHelper=function(d,a){switch(d.nodeType){case 1:var c=d.nodeName.toLowerCase();if(!c||"/"==c.charAt(0))return"";a.push("\x3c",c);var e=[],l={},g;if(q("dom-attributes-explicit")||q("dom-attributes-specified-flag"))for(var k=0;g=d.attributes[k++];){var r=g.name;if("_dj"!==r.substr(0,3)&&(!q("dom-attributes-specified-flag")||g.specified)&&
!(r in l)){g=g.value;if("src"==r||"href"==r)d.getAttribute("_djrealurl")&&(g=d.getAttribute("_djrealurl"));8===q("ie")&&"style"===r&&(g=g.replace("HEIGHT:","height:").replace("WIDTH:","width:"));e.push([r,g]);l[r]=g}}else{var z=(/^input$|^img$/i.test(d.nodeName)?d:d.cloneNode(!1)).outerHTML,l=z.match(/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi),z=z.substr(0,z.indexOf("\x3e"));t.forEach(l,function(a){if(a){var g=a.indexOf("\x3d");if(0<g&&(a=a.substring(0,g),"_dj"!=a.substr(0,3)))if(("src"==a||"href"==a)&&d.getAttribute("_djrealurl"))e.push([a,
d.getAttribute("_djrealurl")]);else{var b;switch(a){case "style":b=d.style.cssText.toLowerCase();break;case "class":b=d.className;break;case "width":if("img"===c){(g=/width=(\S+)/i.exec(z))&&(b=g[1]);break}case "height":if("img"===c){(g=/height=(\S+)/i.exec(z))&&(b=g[1]);break}default:b=d.getAttribute(a)}null!=b&&e.push([a,b.toString()])}}},this)}e.sort(function(a,c){return a[0]<c[0]?-1:a[0]==c[0]?0:1});for(l=0;g=e[l++];)a.push(" ",g[0],'\x3d"',"string"===typeof g[1]?f(g[1],!0):g[1],'"');switch(c){case "br":case "hr":case "img":case "input":case "base":case "meta":case "area":case "basefont":a.push(" /\x3e");
break;case "script":a.push("\x3e",d.innerHTML,"\x3c/",c,"\x3e");break;default:a.push("\x3e"),d.hasChildNodes()&&s.getChildrenHtmlHelper(d,a),a.push("\x3c/",c,"\x3e")}break;case 4:case 3:a.push(f(d.nodeValue,!0));break;case 8:a.push("\x3c!--",f(d.nodeValue,!0),"--\x3e");break;default:a.push("\x3c!-- Element not recognized - Type: ",d.nodeType," Name: ",d.nodeName,"--\x3e")}};s.getChildrenHtml=function(d){var a=[];s.getChildrenHtmlHelper(d,a);return a.join("")};s.getChildrenHtmlHelper=function(d,a){if(d)for(var c=
d.childNodes||d,e=!q("ie")||c!==d,f,g=0;f=c[g++];)(!e||f.parentNode==d)&&s.getNodeHtmlHelper(f,a)};return s})},"dijit/_editor/plugins/LinkDialog":function(){define("require dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/query dojo/string ../_Plugin ../../form/DropDownButton ../range".split(" "),function(t,k,q,s,f,d,a,c,e,l,g,x){var r=k("dijit._editor.plugins.LinkDialog",l,{buttonClass:g,useDefaultCommand:!1,urlRegExp:"((https?|ftps?|file)\\://|./|../|/|)(/[a-zA-Z]{1,1}:/|)(((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)*(?:[a-zA-Z](?:[-\\da-zA-Z]{0,80}[\\da-zA-Z])?)\\.?)|(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])|(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]|(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]|(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])|0[xX]0*[\\da-fA-F]{1,8}|([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}|([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])))(\\:\\d+)?(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]{0,}(?:\\?[^?#\\s/]*)?(?:#.*)?)?)?",
emailRegExp:"\x3c?(mailto\\:)([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)|localhost|^[^-][a-zA-Z0-9_-]*\x3e?",htmlTemplate:'\x3ca href\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" target\x3d"${targetSelect}"\x3e${textInput}\x3c/a\x3e',tag:"a",_hostRxp:/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,_userAtRxp:/^([!#-'*+\-\/-9=?A-Z^-~]+[.])*[!#-'*+\-\/-9=?A-Z^-~]+@/i,
linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_targetSelect'\x3e${target}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cselect id\x3d'${id}_targetSelect' name\x3d'targetSelect' data-dojo-type\x3d'dijit.form.Select'\x3e\x3coption selected\x3d'selected' value\x3d'_self'\x3e${currentWindow}\x3c/option\x3e\x3coption value\x3d'_blank'\x3e${newWindow}\x3c/option\x3e\x3coption value\x3d'_top'\x3e${topWindow}\x3c/option\x3e\x3coption value\x3d'_parent'\x3e${parentWindow}\x3c/option\x3e\x3c/select\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
_initButton:function(){this.inherited(arguments);this.button.loadDropDown=f.hitch(this,"_loadDropDown");this._connectTagEvents()},_loadDropDown:function(a){t("dojo/i18n ../../TooltipDialog ../../registry ../../form/Button ../../form/Select ../../form/ValidationTextBox dojo/i18n!../../nls/common dojo/i18n!../nls/LinkDialog".split(" "),f.hitch(this,function(c,b,g){var l=this;this.tag="insertImage"==this.command?"img":"a";c=f.delegate(c.getLocalization("dijit","common",this.lang),c.getLocalization("dijit._editor",
"LinkDialog",this.lang));var p=this.dropDown=this.button.dropDown=new b({title:c[this.command+"Title"],ownerDocument:this.editor.ownerDocument,dir:this.editor.dir,execute:f.hitch(this,"setValue"),onOpen:function(){l._onOpenDialog();b.prototype.onOpen.apply(this,arguments)},onCancel:function(){setTimeout(f.hitch(l,"_onCloseDialog"),0)}});c.urlRegExp=this.urlRegExp;c.id=g.getUniqueId(this.editor.id);this._uniqueId=c.id;this._setContent(p.title+"\x3cdiv style\x3d'border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'\x3e\x3c/div\x3e"+
e.substitute(this.linkDialogTemplate,c));p.startup();this._urlInput=g.byId(this._uniqueId+"_urlInput");this._textInput=g.byId(this._uniqueId+"_textInput");this._setButton=g.byId(this._uniqueId+"_setButton");this.own(g.byId(this._uniqueId+"_cancelButton").on("click",f.hitch(this.dropDown,"onCancel")));this._urlInput&&this.own(this._urlInput.on("change",f.hitch(this,"_checkAndFixInput")));this._textInput&&this.own(this._textInput.on("change",f.hitch(this,"_checkAndFixInput")));this._urlRegExp=RegExp("^"+
this.urlRegExp+"$","i");this._emailRegExp=RegExp("^"+this.emailRegExp+"$","i");this._urlInput.isValid=f.hitch(this,function(){var b=this._urlInput.get("value");return this._urlRegExp.test(b)||this._emailRegExp.test(b)});this.own(d(p.domNode,"keydown",f.hitch(this,f.hitch(this,function(b){b&&(b.keyCode==s.ENTER&&!b.shiftKey&&!b.metaKey&&!b.ctrlKey&&!b.altKey)&&!this._setButton.get("disabled")&&(p.onExecute(),p.execute(p.get("value")))}))));a()}))},_checkAndFixInput:function(){var a=this,c=this._urlInput.get("value");
this._delayedCheck&&(clearTimeout(this._delayedCheck),this._delayedCheck=null);this._delayedCheck=setTimeout(function(){var b=c,e=!1,d=!1;b&&1<b.length&&(b=f.trim(b),0!==b.indexOf("mailto:")&&(0<b.indexOf("/")?-1===b.indexOf("://")&&"/"!==b.charAt(0)&&b.indexOf("./")&&0!==b.indexOf("../")&&a._hostRxp.test(b)&&(e=!0):a._userAtRxp.test(b)&&(d=!0)));e&&a._urlInput.set("value","http://"+b);d&&a._urlInput.set("value","mailto:"+b);a._setButton.set("disabled",!a._isValid())},250)},_connectTagEvents:function(){this.editor.onLoadDeferred.then(f.hitch(this,
function(){this.own(d(this.editor.editNode,"dblclick",f.hitch(this,"_onDblClick")))}))},_isValid:function(){return this._urlInput.isValid()&&this._textInput.isValid()},_setContent:function(a){this.dropDown.set({parserScope:"dojo",content:a})},_checkValues:function(a){a&&a.urlInput&&(a.urlInput=a.urlInput.replace(/"/g,"\x26quot;"));return a},setValue:function(d){this._onCloseDialog();if(9>a("ie")){var g=x.getSelection(this.editor.window).getRangeAt(0).endContainer;3===g.nodeType&&(g=g.parentNode);
g&&(g.nodeName&&g.nodeName.toLowerCase()!==this.tag)&&(g=this.editor.selection.getSelectedElement(this.tag));g&&(g.nodeName&&g.nodeName.toLowerCase()===this.tag)&&this.editor.queryCommandEnabled("unlink")&&(this.editor.selection.selectElementChildren(g),this.editor.execCommand("unlink"))}d=this._checkValues(d);this.editor.execCommand("inserthtml",e.substitute(this.htmlTemplate,d));c("a",this.editor.document).forEach(function(b){!b.innerHTML&&!q.has(b,"name")&&b.parentNode.removeChild(b)},this)},_onCloseDialog:function(){this.editor.focused&&
this.editor.focus()},_getCurrentValues:function(a){var c,b,e;a&&a.tagName.toLowerCase()===this.tag?(c=a.getAttribute("_djrealurl")||a.getAttribute("href"),e=a.getAttribute("target")||"_self",b=a.textContent||a.innerText,this.editor.selection.selectElement(a,!0)):b=this.editor.selection.getSelectedText();return{urlInput:c||"",textInput:b||"",targetSelect:e||""}},_onOpenDialog:function(){var c,e;if(a("ie")){if(e=x.getSelection(this.editor.window),e.rangeCount){var b=e.getRangeAt(0);c=b.endContainer;
3===c.nodeType&&(c=c.parentNode);c&&(c.nodeName&&c.nodeName.toLowerCase()!==this.tag)&&(c=this.editor.selection.getSelectedElement(this.tag));if(!c||c.nodeName&&c.nodeName.toLowerCase()!==this.tag)if((e=this.editor.selection.getAncestorElement(this.tag))&&e.nodeName&&e.nodeName.toLowerCase()==this.tag)c=e,this.editor.selection.selectElement(c);else if(b.startContainer===b.endContainer&&(e=b.startContainer.firstChild)&&e.nodeName&&e.nodeName.toLowerCase()==this.tag)c=e,this.editor.selection.selectElement(c)}}else c=
this.editor.selection.getAncestorElement(this.tag);this.dropDown.reset();this._setButton.set("disabled",!0);this.dropDown.set("value",this._getCurrentValues(c))},_onDblClick:function(a){if(a&&a.target&&(a=a.target,(a.tagName?a.tagName.toLowerCase():"")===this.tag&&q.get(a,"href"))){var c=this.editor;this.editor.selection.selectElement(a);c.onDisplayChanged();c._updateTimer&&(c._updateTimer.remove(),delete c._updateTimer);c.onNormalizedDisplayChanged();var b=this.button;setTimeout(function(){b.set("disabled",
!1);b.loadAndOpenDropDown().then(function(){b.dropDown.focus&&b.dropDown.focus()})},10)}}}),z=k("dijit._editor.plugins.ImgLinkDialog",[r],{linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' regExp\x3d'${urlRegExp}' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'false' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
htmlTemplate:'\x3cimg src\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" alt\x3d"${textInput}" /\x3e',tag:"img",_getCurrentValues:function(a){var c,b;a&&a.tagName.toLowerCase()===this.tag?(c=a.getAttribute("_djrealurl")||a.getAttribute("src"),b=a.getAttribute("alt"),this.editor.selection.selectElement(a,!0)):b=this.editor.selection.getSelectedText();return{urlInput:c||"",textInput:b||""}},_isValid:function(){return this._urlInput.isValid()},_connectTagEvents:function(){this.inherited(arguments);this.editor.onLoadDeferred.then(f.hitch(this,
function(){this.own(d(this.editor.editNode,"mousedown",f.hitch(this,"_selectTag")))}))},_selectTag:function(a){a&&a.target&&(a=a.target,(a.tagName?a.tagName.toLowerCase():"")===this.tag&&this.editor.selection.selectElement(a))},_checkValues:function(a){a&&a.urlInput&&(a.urlInput=a.urlInput.replace(/"/g,"\x26quot;"));a&&a.textInput&&(a.textInput=a.textInput.replace(/"/g,"\x26quot;"));return a},_onDblClick:function(a){if(a&&a.target&&(a=a.target,(a.tagName?a.tagName.toLowerCase():"")===this.tag&&q.get(a,
"src"))){var c=this.editor;this.editor.selection.selectElement(a);c.onDisplayChanged();c._updateTimer&&(c._updateTimer.remove(),delete c._updateTimer);c.onNormalizedDisplayChanged();var b=this.button;setTimeout(function(){b.set("disabled",!1);b.loadAndOpenDropDown().then(function(){b.dropDown.focus&&b.dropDown.focus()})},10)}}});l.registry.createLink=function(){return new r({command:"createLink"})};l.registry.insertImage=function(){return new z({command:"insertImage"})};r.ImgLinkDialog=z;return r})},
"dijit/_editor/plugins/TextColor":function(){define("require dojo/colors dojo/_base/declare dojo/_base/lang ../_Plugin ../../form/DropDownButton".split(" "),function(t,k,q,s,f,d){var a=q("dijit._editor.plugins.TextColor",f,{buttonClass:d,colorPicker:"dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command=this.name;this.inherited(arguments);var a=this;this.button.loadDropDown=function(e){function d(g){a.button.dropDown=new g({dir:a.editor.dir,ownerDocument:a.editor.ownerDocument,
value:a.value,onChange:function(e){a.editor.execCommand(a.command,e)},onExecute:function(){a.editor.execCommand(a.command,this.get("value"))}});e()}"string"==typeof a.colorPicker?t([a.colorPicker],d):d(a.colorPicker)}},updateState:function(){var a=this.editor,e=this.command;if(a&&a.isLoaded&&e.length){if(this.button){var d=this.get("disabled");this.button.set("disabled",d);if(d)return;var g;try{g=a.queryCommandValue(e)||""}catch(f){g=""}}""==g&&(g="#000000");"transparent"==g&&(g="#ffffff");"string"==
typeof g?-1<g.indexOf("rgb")&&(g=k.fromRgb(g).toHex()):(g=((g&255)<<16|g&65280|(g&16711680)>>>16).toString(16),g="#000000".slice(0,7-g.length)+g);this.value=g;(a=this.button.dropDown)&&(a.get&&g!==a.get("value"))&&a.set("value",g,!1)}}});f.registry.foreColor=function(c){return new a(c)};f.registry.hiliteColor=function(c){return new a(c)};return a})},"esri/dijit/editing/AttachmentEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/kernel dojo/has dojo/query dojo/io-query dojo/dom-attr dijit/_Widget dijit/_Templated dijit/ProgressBar ../../kernel ../../lang ../../domUtils dojo/text!./templates/AttachmentEditor.html dojo/i18n!../../nls/jsapi dojo/NodeList-dom".split(" "),
function(t,k,q,s,f,d,a,c,e,l,g,x,r,z,m,n,b){return t([l,g],{declaredClass:"esri.dijit.editing.AttachmentEditor",widgetsInTemplate:!0,templateString:n,_listHtml:"\x3cspan id\x3d'node_${oid}_${attid}'\x3e\x3ca href\x3d'${href}' target\x3d'_blank'\x3e${name}\x3c/a\x3e",_deleteBtnHtml:"(\x3cspan style\x3d'cursor:pointer;color:red;font-weight:bold;' class\x3d'deleteAttachment' id\x3d'${attid}');'\x3eX\x3c/span\x3e)",_endHtml:"\x3cbr/\x3e\x3c/span\x3e",_aeConnects:[],_layerEditingCapChecked:{},_layerEditingCap:{},
constructor:function(a,c){k.mixin(this,b.widgets.attachmentEditor)},startup:function(){this.inherited(arguments);this._uploadField_connect=q.connect(this._uploadField,"onchange",this,function(){0<this._uploadField.value.length&&this._addAttachment()});this._uploadFieldFocus_connect=q.connect(this._uploadField,"onfocus",k.hitch(this,function(a){m.hide(this._attachmentError)}))},destroy:function(){s.forEach(this._aeConnects,q.disconnect);q.disconnect(this._uploadField_connect);q.disconnect(this._uploadFieldFocus_connect);
this.inherited(arguments)},showAttachments:function(a,b){this._attachmentList.innerHTML=this.NLS_none;this._uploadField.value="";s.forEach(this.domNode.children,function(a,b){m.show(a)});m.hide(this._attachmentError);if(a&&(this._featureLayer=a.getLayer()||b))if("esri.layers.FeatureLayer"!==this._featureLayer.declaredClass||!this._featureLayer.getEditCapabilities){if(!b||!b.getEditCapabilities())m.hide(this._uploadForm),s.forEach(this.domNode.children,function(a,b){m.hide(a)})}else this._currentLayerId=
this._featureLayer.id,this._layerEditingCapChecked[this._currentLayerId]||(this._layerEditingCap[this._currentLayerId]=this._featureLayer.getEditCapabilities(),this._layerEditingCapChecked[this._currentLayerId]=!0),this._featureCanUpdate=this._featureLayer.getEditCapabilities({feature:a}).canUpdate,this._oid=a.attributes[this._featureLayer.objectIdField],this._getAttachments(a)},_getAttachments:function(a){this._featureLayer&&this._featureLayer.queryAttachmentInfos&&this._featureLayer.queryAttachmentInfos(this._oid,
k.hitch(this,"_onQueryAttachmentInfosComplete"))},_addAttachment:function(){m.hide(this._attachmentError);!this._featureLayer||!this._featureLayer.addAttachment?this._tempUpload=this._uploadForm:(m.show(this._attachmentProgress),this._featureLayer.addAttachment(this._oid,this._uploadForm,k.hitch(this,"_onAddAttachmentComplete"),k.hitch(this,"_onAddAttachmentError")))},_chainAttachment:function(a,b){this._tempUpload&&(m.show(this._attachmentProgress),b.addAttachment(a,this._tempUpload,k.hitch(this,
"_onAddAttachmentComplete"),k.hitch(this,"_onAddAttachmentError")));this._tempUpload=null},_deleteAttachment:function(a,b){m.show(this._attachmentProgress);this._featureLayer.deleteAttachments(a,[b],k.hitch(this,"_onDeleteAttachmentComplete"))},_onQueryAttachmentInfosComplete:function(a){var b=this._listHtml+this._deleteBtnHtml+this._endHtml;this._uploadForm.style.display="block";!this._featureCanUpdate&&this._layerEditingCap[this._currentLayerId].canUpdate||!this._layerEditingCap[this._currentLayerId].canCreate&&
!this._layerEditingCap[this._currentLayerId].canUpdate?(b=this._listHtml+this._endHtml,this._uploadForm.style.display="none"):this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate&&(b=this._listHtml+this._endHtml);var c=this._attachmentList;a=s.map(a,k.hitch(this,function(a){return z.substitute({href:a.url,name:a.name,oid:a.objectId,attid:a.id},b)}));c.innerHTML=a.join("")||this.NLS_none;this._updateConnects()},_onAddAttachmentComplete:function(a){m.hide(this._attachmentProgress.domNode);
var b=this._attachmentList,e=this._uploadField,d=e.value,g=d.lastIndexOf("\\");-1<g&&(d=d.substring(g+1,d.length));var d=d.replace(/\ /g,"_"),g=c.objectToQuery({gdbVersion:this._featureLayer.gdbVersion,token:this._featureLayer._getToken()}),f=this._listHtml+this._deleteBtnHtml+this._endHtml;this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate&&(f=this._listHtml+this._endHtml);a=z.substitute({href:this._featureLayer._url.path+"/"+a.objectId+
"/attachments/"+a.attachmentId+(g?"?"+g:""),name:d,oid:a.objectId,attid:a.attachmentId},f);b.innerHTML=b.innerHTML==this.NLS_none?a:b.innerHTML+a;this._updateConnects();e.value=""},_onAddAttachmentError:function(a){m.hide(this._attachmentProgress.domNode);if(a&&z.isDefined(a.code)){var b=this._attachmentError;e.set(b,"innerHTML",(400===a.code?this.NLS_fileNotSupported:a.message||a.details&&a.details.length&&a.details[0])||this.NLS_error);m.show(b)}},_onDeleteAttachmentComplete:function(a){m.hide(this._attachmentProgress.domNode);
var b=this._attachmentList;if(s.every(a,function(a){return a.success})&&(f.query("#node_"+a[0].objectId+"_"+a[0].attachmentId).orphan(),!b.children||!b.children.length))b.innerHTML=this.NLS_none},_updateConnects:function(){s.forEach(this._aeConnects,q.disconnect);f.query(".deleteAttachment").forEach(function(a){this._aeConnects.push(q.connect(a,"onclick",k.hitch(this,"_deleteAttachment",this._oid,a.id)))},this)}})})},"dijit/ProgressBar":function(){define("require dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/number ./_Widget ./_TemplatedMixin dojo/text!./templates/ProgressBar.html".split(" "),
function(t,k,q,s,f,d,a,c){return k("dijit.ProgressBar",[d,a],{progress:"0",value:"",maximum:100,places:0,indeterminate:!1,label:"",name:"",templateString:c,_indeterminateHighContrastImagePath:t.toUrl("./themes/a11y/indeterminate_progress.gif"),postMixInProperties:function(){this.inherited(arguments);this.params&&"value"in this.params||(this.value=this.indeterminate?Infinity:this.progress)},buildRendering:function(){this.inherited(arguments);this.indeterminateHighContrastImage.setAttribute("src",this._indeterminateHighContrastImagePath.toString());
this.update()},_setDirAttr:function(a){var c="rtl"==a.toLowerCase();q.toggle(this.domNode,"dijitProgressBarRtl",c);q.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&c);this.inherited(arguments)},update:function(a){s.mixin(this,a||{});a=this.internalProgress;var c=this.domNode,d=1;this.indeterminate?c.removeAttribute("aria-valuenow"):(-1!=String(this.progress).indexOf("%")?(d=Math.min(parseFloat(this.progress)/100,1),this.progress=d*this.maximum):(this.progress=Math.min(this.progress,
this.maximum),d=this.maximum?this.progress/this.maximum:0),c.setAttribute("aria-valuenow",this.progress));c.setAttribute("aria-labelledby",this.labelNode.id);c.setAttribute("aria-valuemin",0);c.setAttribute("aria-valuemax",this.maximum);this.labelNode.innerHTML=this.report(d);q.toggle(this.domNode,"dijitProgressBarIndeterminate",this.indeterminate);q.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&!this.isLeftToRight());a.style.width=100*d+"%";this.onChange()},_setValueAttr:function(a){this._set("value",
a);Infinity==a?this.update({indeterminate:!0}):this.update({indeterminate:!1,progress:a})},_setLabelAttr:function(a){this._set("label",a);this.update()},_setIndeterminateAttr:function(a){this._set("indeterminate",a);this.update()},report:function(a){return this.label?this.label:this.indeterminate?"\x26#160;":f.format(a,{type:"percent",places:this.places,locale:this.lang})},onChange:function(){}})})},"esri/dijit/editing/Util":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/has","../../kernel"],
function(t,k,q,s){t={};return t={findFeatures:function(f,d,a){var c=d.objectIdField;d=k.filter(d.graphics,function(a){return k.some(f,function(d){return a.attributes[c]===d.objectId})});if(a)a(d);else return d},getSelection:function(f){var d=[];k.forEach(f,function(a){a=a.getSelectedFeatures();k.forEach(a,function(a){d.push(a)})});return d}}})},"dijit/form/DateTextBox":function(){define(["dojo/_base/declare","../Calendar","./_DateTimeTextBox"],function(t,k,q){return t("dijit.form.DateTextBox",q,{baseClass:"dijitTextBox dijitComboBox dijitDateTextBox",
popupClass:k,_selector:"date",maxHeight:Infinity,value:new Date("")})})},"dijit/Calendar":function(){define("dojo/_base/array dojo/date dojo/date/locale dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/sniff ./CalendarLite ./_Widget ./_CssStateMixin ./_TemplatedMixin ./form/DropDownButton".split(" "),function(t,k,q,s,f,d,a,c,e,l,g,x,r,z,m,n,b){var v=s("dijit.Calendar",[r,z,m],{baseClass:"dijitCalendar",cssStateNodes:{decrementMonth:"dijitCalendarArrow",
incrementMonth:"dijitCalendarArrow",previousYearLabelNode:"dijitCalendarPreviousYear",nextYearLabelNode:"dijitCalendarNextYear"},setValue:function(a){c.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",a)},_createMonthWidget:function(){return new v._MonthDropDownButton({id:this.id+"_mddb",tabIndex:-1,onMonthSelect:l.hitch(this,"_onMonthSelect"),lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},postCreate:function(){this.inherited(arguments);
this.own(g(this.domNode,"keydown",l.hitch(this,"_onKeyDown")),g(this.dateRowsNode,"mouseover",l.hitch(this,"_onDayMouseOver")),g(this.dateRowsNode,"mouseout",l.hitch(this,"_onDayMouseOut")),g(this.dateRowsNode,"mousedown",l.hitch(this,"_onDayMouseDown")),g(this.dateRowsNode,"mouseup",l.hitch(this,"_onDayMouseUp")))},_onMonthSelect:function(a){var b=new this.dateClassObj(this.currentFocus);b.setDate(1);b.setMonth(a);a=this.dateModule.getDaysInMonth(b);var c=this.currentFocus.getDate();b.setDate(Math.min(c,
a));this._setCurrentFocusAttr(b)},_onDayMouseOver:function(a){if((a=d.contains(a.target,"dijitCalendarDateLabel")?a.target.parentNode:a.target)&&(a.dijitDateValue&&!d.contains(a,"dijitCalendarDisabledDate")||a==this.previousYearLabelNode||a==this.nextYearLabelNode))d.add(a,"dijitCalendarHoveredDate"),this._currentNode=a},_onDayMouseOut:function(a){this._currentNode&&!(a.relatedTarget&&a.relatedTarget.parentNode==this._currentNode)&&(a="dijitCalendarHoveredDate",d.contains(this._currentNode,"dijitCalendarActiveDate")&&
(a+=" dijitCalendarActiveDate"),d.remove(this._currentNode,a),this._currentNode=null)},_onDayMouseDown:function(a){if((a=a.target.parentNode)&&a.dijitDateValue&&!d.contains(a,"dijitCalendarDisabledDate"))d.add(a,"dijitCalendarActiveDate"),this._currentNode=a},_onDayMouseUp:function(a){(a=a.target.parentNode)&&a.dijitDateValue&&d.remove(a,"dijitCalendarActiveDate")},handleKey:function(a){var b=-1,c,d=this.currentFocus;switch(a.keyCode){case e.RIGHT_ARROW:b=1;case e.LEFT_ARROW:c="day";this.isLeftToRight()||
(b*=-1);break;case e.DOWN_ARROW:b=1;case e.UP_ARROW:c="week";break;case e.PAGE_DOWN:b=1;case e.PAGE_UP:c=a.ctrlKey||a.altKey?"year":"month";break;case e.END:d=this.dateModule.add(d,"month",1),c="day";case e.HOME:d=new this.dateClassObj(d);d.setDate(1);break;default:return!0}c&&(d=this.dateModule.add(d,c,b));this._setCurrentFocusAttr(d);return!1},_onKeyDown:function(a){this.handleKey(a)||(a.stopPropagation(),a.preventDefault())},onValueSelected:function(){},onChange:function(a){this.onValueSelected(a)},
getClassForDate:function(){}});v._MonthDropDownButton=s("dijit.Calendar._MonthDropDownButton",b,{onMonthSelect:function(){},postCreate:function(){this.inherited(arguments);this.dropDown=new v._MonthDropDown({id:this.id+"_mdd",onChange:this.onMonthSelect})},_setMonthAttr:function(a){var b=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a);this.dropDown.set("months",b);this.containerNode.innerHTML=(6==x("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+this.dropDown.domNode.innerHTML+
"\x3c/div\x3e")+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+b[a.getMonth()]+"\x3c/div\x3e"}});v._MonthDropDown=s("dijit.Calendar._MonthDropDown",[z,n,m],{months:[],baseClass:"dijitCalendarMonthMenu dijitMenu",templateString:"\x3cdiv data-dojo-attach-event\x3d'ondijitclick:_onClick'\x3e\x3c/div\x3e",_setMonthsAttr:function(b){this.domNode.innerHTML="";t.forEach(b,function(b,c){a.create("div",{className:"dijitCalendarMonthLabel",month:c,innerHTML:b},this.domNode)._cssState=
"dijitCalendarMonthLabel"},this)},_onClick:function(a){this.onChange(f.get(a.target,"month"))},onChange:function(){}});return v})},"dijit/CalendarLite":function(){define("dojo/_base/array dojo/_base/declare dojo/cldr/supplemental dojo/date dojo/date/locale dojo/date/stamp dojo/dom dojo/dom-class dojo/_base/lang dojo/on dojo/sniff dojo/string ./_WidgetBase ./_TemplatedMixin dojo/text!./templates/Calendar.html ./a11yclick ./hccss".split(" "),function(t,k,q,s,f,d,a,c,e,l,g,x,r,z,m){var n=k("dijit.CalendarLite",
[r,z],{templateString:m,dowTemplateString:'\x3cth class\x3d"dijitReset dijitCalendarDayLabelTemplate" role\x3d"columnheader" scope\x3d"col"\x3e\x3cspan class\x3d"dijitCalendarDayLabel"\x3e${d}\x3c/span\x3e\x3c/th\x3e',dateTemplateString:'\x3ctd class\x3d"dijitReset" role\x3d"gridcell" data-dojo-attach-point\x3d"dateCells"\x3e\x3cspan class\x3d"dijitCalendarDateLabel" data-dojo-attach-point\x3d"dateLabels"\x3e\x3c/span\x3e\x3c/td\x3e',weekTemplateString:'\x3ctr class\x3d"dijitReset dijitCalendarWeekTemplate" role\x3d"row"\x3e${d}${d}${d}${d}${d}${d}${d}\x3c/tr\x3e',
value:new Date(""),datePackage:"",dayWidth:"narrow",tabIndex:"0",currentFocus:new Date,_setSummaryAttr:"gridNode",baseClass:"dijitCalendar dijitCalendarLite",_isValidDate:function(a){return a&&!isNaN(a)&&"object"==typeof a&&a.toString()!=this.constructor.prototype.value.toString()},_getValueAttr:function(){var a=this._get("value");if(a&&!isNaN(a)){var c=new this.dateClassObj(a);c.setHours(0,0,0,0);c.getDate()<a.getDate()&&(c=this.dateModule.add(c,"hour",1));return c}return null},_setValueAttr:function(a,
c){"string"==typeof a&&(a=d.fromISOString(a));a=this._patchDate(a);if(this._isValidDate(a)&&!this.isDisabledDate(a,this.lang)){if(this._set("value",a),this.set("currentFocus",a),this._markSelectedDates([a]),this._created&&(c||"undefined"==typeof c))this.onChange(this.get("value"))}else this._set("value",null),this._markSelectedDates([])},_patchDate:function(a){a&&(a=new this.dateClassObj(a),a.setHours(1,0,0,0));return a},_setText:function(a,c){for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(a.ownerDocument.createTextNode(c))},
_populateGrid:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);var a=this._patchDate(a),c=a.getDay(),d=this.dateModule.getDaysInMonth(a),e=this.dateModule.getDaysInMonth(this.dateModule.add(a,"month",-1)),g=new this.dateClassObj,f=q.getFirstDayOfWeek(this.lang);f>c&&(f-=7);if(!this.summary){var l=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a);this.gridNode.setAttribute("summary",l[a.getMonth()])}this._date2cell={};t.forEach(this.dateCells,function(l,
m){var n=m+f,r=new this.dateClassObj(a),k="dijitCalendar",q=0;n<c?(n=e-c+n+1,q=-1,k+="Previous"):n>=c+d?(n=n-c-d+1,q=1,k+="Next"):(n=n-c+1,k+="Current");q&&(r=this.dateModule.add(r,"month",q));r.setDate(n);this.dateModule.compare(r,g,"date")||(k="dijitCalendarCurrentDate "+k);this.isDisabledDate(r,this.lang)?(k="dijitCalendarDisabledDate "+k,l.setAttribute("aria-disabled","true")):(k="dijitCalendarEnabledDate "+k,l.removeAttribute("aria-disabled"),l.setAttribute("aria-selected","false"));(q=this.getClassForDate(r,
this.lang))&&(k=q+" "+k);l.className=k+"Month dijitCalendarDateTemplate";k=r.valueOf();this._date2cell[k]=l;l.dijitDateValue=k;this._setText(this.dateLabels[m],r.getDateLocalized?r.getDateLocalized(this.lang):r.getDate())},this)},_populateControls:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);this.monthWidget.set("month",a);var c=a.getFullYear()-1,d=new this.dateClassObj;t.forEach(["previous","current","next"],function(a){d.setFullYear(c++);this._setText(this[a+"YearLabelNode"],
this.dateLocaleModule.format(d,{selector:"year",locale:this.lang}))},this)},goToToday:function(){this.set("value",new this.dateClassObj)},constructor:function(a){this.dateModule=a.datePackage?e.getObject(a.datePackage,!1):s;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=a.datePackage?e.getObject(a.datePackage+".locale",!1):f},_createMonthWidget:function(){return n._MonthWidget({id:this.id+"_mddb",lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},buildRendering:function(){var b=
this.dowTemplateString,c=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang),d=q.getFirstDayOfWeek(this.lang);this.dayCellsHtml=x.substitute([b,b,b,b,b,b,b].join(""),{d:""},function(){return c[d++%7]});b=x.substitute(this.weekTemplateString,{d:this.dateTemplateString});this.dateRowsHtml=[b,b,b,b,b,b].join("");this.dateCells=[];this.dateLabels=[];this.inherited(arguments);a.setSelectable(this.domNode,!1);b=new this.dateClassObj(this.currentFocus);this.monthWidget=this._createMonthWidget();
this.set("currentFocus",b,!1)},postCreate:function(){this.inherited(arguments);this._connectControls()},_connectControls:function(){var a=e.hitch(this,function(a,b,c){this[a].dojoClick=!0;return l(this[a],"click",e.hitch(this,function(){this._setCurrentFocusAttr(this.dateModule.add(this.currentFocus,b,c))}))});this.own(a("incrementMonth","month",1),a("decrementMonth","month",-1),a("nextYearLabelNode","year",1),a("previousYearLabelNode","year",-1))},_setCurrentFocusAttr:function(a,c){var d=this.currentFocus,
e=this._getNodeByDate(d);a=this._patchDate(a);this._set("currentFocus",a);if(!this._date2cell||0!=this.dateModule.difference(d,a,"month"))this._populateGrid(),this._populateControls(),this._markSelectedDates([this.value]);d=this._getNodeByDate(a);d.setAttribute("tabIndex",this.tabIndex);(this.focused||c)&&d.focus();e&&e!=d&&(g("webkit")?e.setAttribute("tabIndex","-1"):e.removeAttribute("tabIndex"))},focus:function(){this._setCurrentFocusAttr(this.currentFocus,!0)},_onDayClick:function(a){a.stopPropagation();
a.preventDefault();for(a=a.target;a&&!a.dijitDateValue;a=a.parentNode);a&&!c.contains(a,"dijitCalendarDisabledDate")&&this.set("value",a.dijitDateValue)},_getNodeByDate:function(a){return(a=this._patchDate(a))&&this._date2cell?this._date2cell[a.valueOf()]:null},_markSelectedDates:function(a){function d(a,b){c.toggle(b,"dijitCalendarSelectedDate",a);b.setAttribute("aria-selected",a?"true":"false")}t.forEach(this._selectedCells||[],e.partial(d,!1));this._selectedCells=t.filter(t.map(a,this._getNodeByDate,
this),function(a){return a});t.forEach(this._selectedCells,e.partial(d,!0))},onChange:function(){},isDisabledDate:function(){},getClassForDate:function(){}});n._MonthWidget=k("dijit.CalendarLite._MonthWidget",r,{_setMonthAttr:function(a){var c=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a),d=6==g("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+t.map(c,function(a){return"\x3cdiv\x3e"+a+"\x3c/div\x3e"}).join("")+"\x3c/div\x3e";this.domNode.innerHTML=d+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+
c[a.getMonth()]+"\x3c/div\x3e"}});return n})},"dijit/form/_DateTimeTextBox":function(){define("dojo/date dojo/date/locale dojo/date/stamp dojo/_base/declare dojo/_base/lang ./RangeBoundTextBox ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),function(t,k,q,s,f,d,a,c){new Date("X");return s("dijit.form._DateTimeTextBox",[d,a],{templateString:c,hasDownArrow:!0,cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_unboundedConstraints:{},pattern:k.regexp,datePackage:"",postMixInProperties:function(){this.inherited(arguments);
this._set("type","text")},compare:function(a,c){var d=this._isInvalidDate(a),f=this._isInvalidDate(c);if(d||f)return d&&f?0:!d?1:-1;var d=this.format(a,this._unboundedConstraints),f=this.format(c,this._unboundedConstraints),r=this.parse(d,this._unboundedConstraints),k=this.parse(f,this._unboundedConstraints);return d==f?0:t.compare(r,k,this._selector)},autoWidth:!0,format:function(a,c){return!a?"":this.dateLocaleModule.format(a,c)},parse:function(a,c){return this.dateLocaleModule.parse(a,c)||(this._isEmpty(a)?
null:void 0)},serialize:function(a,c){a.toGregorian&&(a=a.toGregorian());return q.toISOString(a,c)},dropDownDefaultValue:new Date,value:new Date(""),_blankValue:null,popupClass:"",_selector:"",constructor:function(a){a=a||{};this.dateModule=a.datePackage?f.getObject(a.datePackage,!1):t;this.dateClassObj=this.dateModule.Date||Date;this.dateClassObj instanceof Date||(this.value=new this.dateClassObj(this.value));this.dateLocaleModule=a.datePackage?f.getObject(a.datePackage+".locale",!1):k;this._set("pattern",
this.dateLocaleModule.regexp);this._invalidDate=this.constructor.prototype.value.toString()},buildRendering:function(){this.inherited(arguments);this.hasDownArrow||(this._buttonNode.style.display="none");this.hasDownArrow||(this._buttonNode=this.domNode,this.baseClass+=" dijitComboBoxOpenOnClick")},_setConstraintsAttr:function(a){a.selector=this._selector;a.fullYear=!0;var c=q.fromISOString;"string"==typeof a.min&&(a.min=c(a.min),this.dateClassObj instanceof Date||(a.min=new this.dateClassObj(a.min)));
"string"==typeof a.max&&(a.max=c(a.max),this.dateClassObj instanceof Date||(a.max=new this.dateClassObj(a.max)));this.inherited(arguments);this._unboundedConstraints=f.mixin({},this.constraints,{min:null,max:null})},_isInvalidDate:function(a){return!a||isNaN(a)||"object"!=typeof a||a.toString()==this._invalidDate},_setValueAttr:function(a,c,d){void 0!==a&&("string"==typeof a&&(a=q.fromISOString(a)),this._isInvalidDate(a)&&(a=null),a instanceof Date&&!(this.dateClassObj instanceof Date)&&(a=new this.dateClassObj(a)));
this.inherited(arguments,[a,c,d]);this.value instanceof Date&&(this.filterString="");this.dropDown&&this.dropDown.set("value",a,!1)},_set:function(a,c){if("value"==a){c instanceof Date&&!(this.dateClassObj instanceof Date)&&(c=new this.dateClassObj(c));var d=this._get("value");if(d instanceof this.dateClassObj&&0==this.compare(c,d))return}this.inherited(arguments)},_setDropDownDefaultValueAttr:function(a){this._isInvalidDate(a)&&(a=new this.dateClassObj);this._set("dropDownDefaultValue",a)},openDropDown:function(a){this.dropDown&&
this.dropDown.destroy();var c=f.isString(this.popupClass)?f.getObject(this.popupClass,!1):this.popupClass,d=this,k=this.get("value");this.dropDown=new c({onChange:function(a){d.set("value",a,!0)},id:this.id+"_popup",dir:d.dir,lang:d.lang,value:k,textDir:d.textDir,currentFocus:!this._isInvalidDate(k)?k:this.dropDownDefaultValue,constraints:d.constraints,filterString:d.filterString,datePackage:d.datePackage,isDisabledDate:function(a){return!d.rangeCheck(a,d.constraints)}});this.inherited(arguments)},
_getDisplayedValueAttr:function(){return this.textbox.value},_setDisplayedValueAttr:function(a,c){this._setValueAttr(this.parse(a,this.constraints),c,a)}})})},"dijit/form/FilteringSelect":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(t,k,q,s,f){return t("dijit.form.FilteringSelect",[s,f],{required:!0,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened},isValid:function(){return!!this.item||!this.required&&""==this.get("displayedValue")},
_refreshState:function(){this.searchTimer||this.inherited(arguments)},_callbackSetLabel:function(d,a,c,e){a&&a[this.searchAttr]!==this._lastQuery||!a&&d.length&&this.store.getIdentity(d[0])!=this._lastQuery||(d.length?this.set("item",d[0],e):this.set("value","",e||void 0===e&&!this.focused,this.textbox.value,null))},_openResultList:function(d,a,c){a[this.searchAttr]===this._lastQuery&&(this.inherited(arguments),void 0===this.item&&this.validate(!0))},_getValueAttr:function(){return this.valueNode.value},
_getValueField:function(){return"value"},_setValueAttr:function(d,a,c,e){this._onChangeActive||(a=null);if(void 0===e){if(null===d||""===d)if(d="",!k.isString(c)){this._setDisplayedValueAttr(c||"",a);return}var f=this;this._lastQuery=d;q(this.store.get(d),function(c){f._callbackSetLabel(c?[c]:[],void 0,void 0,a)})}else this.valueNode.value=d,this.inherited(arguments,[d,a,c,e])},_setItemAttr:function(d,a,c){this.inherited(arguments);this._lastDisplayedValue=this.textbox.value},_getDisplayQueryString:function(d){return d.replace(/([\\\*\?])/g,
"\\$1")},_setDisplayedValueAttr:function(d,a){null==d&&(d="");if(!this._created){if(!("displayedValue"in this.params))return;a=!1}if(this.store){this.closeDropDown();var c=k.clone(this.query),e=this._getDisplayQueryString(d),f;this.store._oldAPI?f=e:(f=this._patternToRegExp(e),f.toString=function(){return e});this._lastQuery=c[this.searchAttr]=f;this._lastDisplayedValue=this.textbox.value=d;this._set("displayedValue",d);var g=this,x={queryOptions:{ignoreCase:this.ignoreCase,deep:!0}};k.mixin(x,this.fetchProperties);
this._fetchHandle=this.store.query(c,x);q(this._fetchHandle,function(d){g._fetchHandle=null;g._callbackSetLabel(d||[],c,x,a)},function(a){g._fetchHandle=null;g._cancelingQuery||console.error("dijit.form.FilteringSelect: "+a.toString())})}},undo:function(){this.set("displayedValue",this._lastDisplayedValue)}})})},"dijit/form/SimpleTextarea":function(){define(["dojo/_base/declare","dojo/dom-class","dojo/sniff","./TextBox"],function(t,k,q,s){return t("dijit.form.SimpleTextarea",s,{baseClass:"dijitTextBox dijitTextArea",
rows:"3",cols:"20",templateString:"\x3ctextarea ${!nameAttrSetting} data-dojo-attach-point\x3d'focusNode,containerNode,textbox' autocomplete\x3d'off'\x3e\x3c/textarea\x3e",postMixInProperties:function(){!this.value&&this.srcNodeRef&&(this.value=this.srcNodeRef.value);this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);q("ie")&&this.cols&&k.add(this.textbox,"dijitTextAreaCols")},filter:function(f){f&&(f=f.replace(/\r/g,""));return this.inherited(arguments)},_onInput:function(f){if(this.maxLength){var d=
parseInt(this.maxLength),a=this.textbox.value.replace(/\r/g,""),d=a.length-d;if(0<d){var c=this.textbox;if(c.selectionStart){var e=c.selectionStart,l=0;q("opera")&&(l=(this.textbox.value.substring(0,e).match(/\r/g)||[]).length);this.textbox.value=a.substring(0,e-d-l)+a.substring(e-l);c.setSelectionRange(e-d,e-d)}else this.ownerDocument.selection&&(c.focus(),a=this.ownerDocument.selection.createRange(),a.moveStart("character",-d),a.text="",a.select())}}this.inherited(arguments)}})})},"dijit/form/TimeTextBox":function(){define(["dojo/_base/declare",
"dojo/keys","dojo/_base/lang","../_TimePicker","./_DateTimeTextBox"],function(t,k,q,s,f){return t("dijit.form.TimeTextBox",f,{baseClass:"dijitTextBox dijitComboBox dijitTimeTextBox",popupClass:s,_selector:"time",value:new Date(""),maxHeight:-1,_onKey:function(d){if(!this.disabled&&!this.readOnly)switch(this.inherited(arguments),d.keyCode){case k.ENTER:case k.TAB:case k.ESCAPE:case k.DOWN_ARROW:case k.UP_ARROW:break;default:this.defer(function(){var a=this.get("displayedValue");this.filterString=a&&
!this.parse(a,this.constraints)?a.toLowerCase():"";this._opened&&this.closeDropDown();this.openDropDown()})}}})})},"dijit/_TimePicker":function(){define("dojo/_base/array dojo/date dojo/date/locale dojo/date/stamp dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/_base/kernel dojo/keys dojo/_base/lang dojo/sniff dojo/query dojo/mouse dojo/on ./_WidgetBase ./form/_ListMouseMixin".split(" "),function(t,k,q,s,f,d,a,c,e,l,g,x,r,z,m,n){return f("dijit._TimePicker",[m,n],{baseClass:"dijitTimePicker",
pickerMin:"T00:00:00",pickerMax:"T23:59:59",clickableIncrement:"T00:15:00",visibleIncrement:"T01:00:00",value:new Date,_visibleIncrement:2,_clickableIncrement:1,_totalIncrements:10,constraints:{},serialize:s.toISOString,buildRendering:function(){this.inherited(arguments);this.timeMenu=this.containerNode=this.domNode},setValue:function(a){c.deprecated("dijit._TimePicker:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",a)},_setValueAttr:function(a){this._set("value",
a);this._showText()},_setFilterStringAttr:function(a){this._set("filterString",a);this._showText()},isDisabledDate:function(){return!1},_getFilteredNodes:function(a,c,d,e){a=[];for(c=0;c<this._maxIncrement;c++)(d=this._createOption(c))&&a.push(d);return a},_showText:function(){var a=s.fromISOString;this.domNode.innerHTML="";this._clickableIncrementDate=a(this.clickableIncrement);this._visibleIncrementDate=a(this.visibleIncrement);var c=3600*this._clickableIncrementDate.getHours()+60*this._clickableIncrementDate.getMinutes()+
this._clickableIncrementDate.getSeconds(),d=3600*this._visibleIncrementDate.getHours()+60*this._visibleIncrementDate.getMinutes()+this._visibleIncrementDate.getSeconds();(this.value||this.currentFocus).getTime();this._refDate=a(this.pickerMin);this._refDate.setFullYear(1970,0,1);this._clickableIncrement=1;this._visibleIncrement=d/c;a=a(this.pickerMax);a.setFullYear(1970,0,1);a=0.0010*(a.getTime()-this._refDate.getTime());this._maxIncrement=Math.ceil((a+1)/c);c=this._getFilteredNodes();t.forEach(c,
function(a){this.domNode.appendChild(a)},this);!c.length&&this.filterString&&(this.filterString="",this._showText())},constructor:function(){this.constraints={}},postMixInProperties:function(){this.inherited(arguments);this._setConstraintsAttr(this.constraints)},_setConstraintsAttr:function(a){for(var c in{clickableIncrement:1,visibleIncrement:1,pickerMin:1,pickerMax:1})c in a&&(this[c]=a[c]);a.locale||(a.locale=this.lang)},_createOption:function(b){var c=new Date(this._refDate),e=this._clickableIncrementDate;
c.setHours(c.getHours()+e.getHours()*b,c.getMinutes()+e.getMinutes()*b,c.getSeconds()+e.getSeconds()*b);"time"==this.constraints.selector&&c.setFullYear(1970,0,1);e=q.format(c,this.constraints);if(this.filterString&&0!==e.toLowerCase().indexOf(this.filterString))return null;var g=this.ownerDocument.createElement("div");g.className=this.baseClass+"Item";g.date=c;g.idx=b;a.create("div",{"class":this.baseClass+"ItemInner",innerHTML:e},g);1>b%this._visibleIncrement&&-1<b%this._visibleIncrement?d.add(g,
this.baseClass+"Marker"):b%this._clickableIncrement||d.add(g,this.baseClass+"Tick");this.isDisabledDate(c)&&d.add(g,this.baseClass+"ItemDisabled");this.value&&!k.compare(this.value,c,this.constraints.selector)&&(g.selected=!0,d.add(g,this.baseClass+"ItemSelected"),this._selectedDiv=g,d.contains(g,this.baseClass+"Marker")?d.add(g,this.baseClass+"MarkerSelected"):d.add(g,this.baseClass+"TickSelected"),this._highlightOption(g,!0));return g},onOpen:function(){this.inherited(arguments);this.set("selected",
this._selectedDiv)},_onOptionSelected:function(a){if((a=a.target.date||a.target.parentNode.date)&&!this.isDisabledDate(a))this._highlighted_option=null,this.set("value",a),this.onChange(a)},onChange:function(){},_highlightOption:function(a,c){if(a){if(c)this._highlighted_option&&this._highlightOption(this._highlighted_option,!1),this._highlighted_option=a;else{if(this._highlighted_option!==a)return;this._highlighted_option=null}d.toggle(a,this.baseClass+"ItemHover",c);d.contains(a,this.baseClass+
"Marker")?d.toggle(a,this.baseClass+"MarkerHover",c):d.toggle(a,this.baseClass+"TickHover",c)}},handleKey:function(a){if(a.keyCode==e.DOWN_ARROW)return this.selectNextNode(),a.stopPropagation(),a.preventDefault(),!1;if(a.keyCode==e.UP_ARROW)return this.selectPreviousNode(),a.stopPropagation(),a.preventDefault(),!1;if(a.keyCode==e.ENTER||a.keyCode===e.TAB){if(!this._keyboardSelected&&a.keyCode===e.TAB)return!0;this._highlighted_option&&this._onOptionSelected({target:this._highlighted_option});return a.keyCode===
e.TAB}},onHover:function(a){this._highlightOption(a,!0)},onUnhover:function(a){this._highlightOption(a,!1)},onSelect:function(a){this._highlightOption(a,!0)},onDeselect:function(a){this._highlightOption(a,!1)},onClick:function(a){this._onOptionSelected({target:a})}})})},"dojox/date/islamic":function(){define(["..","dojo/_base/lang","dojo/date","./islamic/Date"],function(t,k,q,s){var f=k.getObject("date.islamic",!0,t);f.getDaysInMonth=function(d){return d.getDaysInIslamicMonth(d.getMonth(),d.getFullYear())};
f.compare=function(d,a,c){d instanceof s&&(d=d.toGregorian());a instanceof s&&(a=a.toGregorian());return q.compare.apply(null,arguments)};f.add=function(d,a,c){var e=new s(d);switch(a){case "day":e.setDate(d.getDate()+c);break;case "weekday":var f=d.getDay();if(5>f+c&&0<f+c)e.setDate(d.getDate()+c);else{var g=a=0;5==f?(f=4,g=0<c?-1:1):6==f&&(f=4,g=0<c?-2:2);var f=0<c?5-f-1:-f,k=c-f,r=parseInt(k/5);0!=k%5&&(a=0<c?2:-2);e.setDate(d.getDate()+(a+7*r+k%5+f)+g)}break;case "year":e.setFullYear(d.getFullYear()+
c);break;case "week":e.setDate(d.getDate()+7*c);break;case "month":d=d.getMonth();e.setMonth(d+c);break;case "hour":e.setHours(d.getHours()+c);break;case "minute":e._addMinutes(c);break;case "second":e._addSeconds(c);break;case "millisecond":e._addMilliseconds(c)}return e};f.difference=function(d,a,c){a=a||new s;c=c||"day";var e=a.getFullYear()-d.getFullYear(),l=1;switch(c){case "weekday":e=Math.round(f.difference(d,a,"day"));l=parseInt(f.difference(d,a,"week"));c=e%7;if(0==c)e=5*l;else{var g=0,k=
d.getDay();a=a.getDay();l=parseInt(e/7);c=e%7;d=new s(d);d.setDate(d.getDate()+7*l);d=d.getDay();if(0<e)switch(!0){case 5==k:g=-1;break;case 6==k:g=0;break;case 5==a:g=-1;break;case 6==a:g=-2;break;case 5<d+c:g=-2}else if(0>e)switch(!0){case 5==k:g=0;break;case 6==k:g=1;break;case 5==a:g=2;break;case 6==a:g=1;break;case 0>d+c:g=2}e=e+g-2*l}l=e;break;case "year":l=e;break;case "month":c=a.toGregorian()>d.toGregorian()?a:d;g=a.toGregorian()>d.toGregorian()?d:a;l=c.getMonth();k=g.getMonth();if(0==e)l=
c.getMonth()-g.getMonth();else{l=12-k+l;e=g.getFullYear()+1;c=c.getFullYear();for(e;e<c;e++)l+=12}a.toGregorian()<d.toGregorian()&&(l=-l);break;case "week":l=parseInt(f.difference(d,a,"day")/7);break;case "day":l/=24;case "hour":l/=60;case "minute":l/=60;case "second":l/=1E3;case "millisecond":l*=a.toGregorian().getTime()-d.toGregorian().getTime()}return Math.round(l)};return f})},"dojox/date/islamic/Date":function(){define(["dojo/_base/lang","dojo/_base/declare","dojo/date"],function(t,k,q){var s=
k("dojox.date.islamic.Date",null,{_date:0,_month:0,_year:0,_hours:0,_minutes:0,_seconds:0,_milliseconds:0,_day:0,_GREGORIAN_EPOCH:1721425.5,_ISLAMIC_EPOCH:1948439.5,constructor:function(){var f=arguments.length;f?1==f?(f=arguments[0],"number"==typeof f&&(f=new Date(f)),f instanceof Date?this.fromGregorian(f):""==f?this._date=new Date(""):(this._year=f._year,this._month=f._month,this._date=f._date,this._hours=f._hours,this._minutes=f._minutes,this._seconds=f._seconds,this._milliseconds=f._milliseconds)):
3<=f&&(this._year+=arguments[0],this._month+=arguments[1],this._date+=arguments[2],this._hours+=arguments[3]||0,this._minutes+=arguments[4]||0,this._seconds+=arguments[5]||0,this._milliseconds+=arguments[6]||0):this.fromGregorian(new Date)},getDate:function(){return this._date},getMonth:function(){return this._month},getFullYear:function(){return this._year},getDay:function(){return this.toGregorian().getDay()},getHours:function(){return this._hours},getMinutes:function(){return this._minutes},getSeconds:function(){return this._seconds},
getMilliseconds:function(){return this._milliseconds},setDate:function(f){f=parseInt(f);if(!(0<f&&f<=this.getDaysInIslamicMonth(this._month,this._year))){var d;if(0<f)for(d=this.getDaysInIslamicMonth(this._month,this._year);f>d;f-=d,d=this.getDaysInIslamicMonth(this._month,this._year))this._month++,12<=this._month&&(this._year++,this._month-=12);else for(d=this.getDaysInIslamicMonth(0<=this._month-1?this._month-1:11,0<=this._month-1?this._year:this._year-1);0>=f;d=this.getDaysInIslamicMonth(0<=this._month-
1?this._month-1:11,0<=this._month-1?this._year:this._year-1))this._month--,0>this._month&&(this._year--,this._month+=12),f+=d}this._date=f;return this},setFullYear:function(f){this._year=+f},setMonth:function(f){this._year+=Math.floor(f/12);this._month=0<f?Math.floor(f%12):Math.floor((f%12+12)%12)},setHours:function(){var f=arguments.length,d=0;1<=f&&(d=parseInt(arguments[0]));2<=f&&(this._minutes=parseInt(arguments[1]));3<=f&&(this._seconds=parseInt(arguments[2]));4==f&&(this._milliseconds=parseInt(arguments[3]));
for(;24<=d;)this._date++,f=this.getDaysInIslamicMonth(this._month,this._year),this._date>f&&(this._month++,12<=this._month&&(this._year++,this._month-=12),this._date-=f),d-=24;this._hours=d},_addMinutes:function(f){f+=this._minutes;this.setMinutes(f);this.setHours(this._hours+parseInt(f/60));return this},_addSeconds:function(f){f+=this._seconds;this.setSeconds(f);this._addMinutes(parseInt(f/60));return this},_addMilliseconds:function(f){f+=this._milliseconds;this.setMilliseconds(f);this._addSeconds(parseInt(f/
1E3));return this},setMinutes:function(f){this._minutes=f%60;return this},setSeconds:function(f){this._seconds=f%60;return this},setMilliseconds:function(f){this._milliseconds=f%1E3;return this},toString:function(){if(isNaN(this._date))return"Invalidate Date";var f=new Date;f.setHours(this._hours);f.setMinutes(this._minutes);f.setSeconds(this._seconds);f.setMilliseconds(this._milliseconds);return this._month+" "+this._date+" "+this._year+" "+f.toTimeString()},toGregorian:function(){var f=this._year,
f=this._date+Math.ceil(29.5*this._month)+354*(f-1)+Math.floor((3+11*f)/30)+this._ISLAMIC_EPOCH-1,f=Math.floor(f-0.5)+0.5,d=f-this._GREGORIAN_EPOCH,a=Math.floor(d/146097),c=this._mod(d,146097),d=Math.floor(c/36524),e=this._mod(c,36524),c=Math.floor(e/1461),e=this._mod(e,1461),e=Math.floor(e/365),a=400*a+100*d+4*c+e;4==d||4==e||a++;d=f-(this._GREGORIAN_EPOCH+365*(a-1)+Math.floor((a-1)/4)-Math.floor((a-1)/100)+Math.floor((a-1)/400));c=this._GREGORIAN_EPOCH-1+365*(a-1)+Math.floor((a-1)/4)-Math.floor((a-
1)/100)+Math.floor((a-1)/400)+Math.floor(739/12+(q.isLeapYear(new Date(a,3,1))?-1:-2)+1);c=f<c?0:q.isLeapYear(new Date(a,3,1))?1:2;d=Math.floor((12*(d+c)+373)/367);c=this._GREGORIAN_EPOCH-1+365*(a-1)+Math.floor((a-1)/4)-Math.floor((a-1)/100)+Math.floor((a-1)/400)+Math.floor((367*d-362)/12+(2>=d?0:q.isLeapYear(new Date(a,d-1,1))?-1:-2)+1);return new Date(a,d-1,f-c+1,this._hours,this._minutes,this._seconds,this._milliseconds)},fromGregorian:function(f){f=new Date(f);var d=f.getFullYear(),a=f.getMonth(),
c=f.getDate(),d=this._GREGORIAN_EPOCH-1+365*(d-1)+Math.floor((d-1)/4)+-Math.floor((d-1)/100)+Math.floor((d-1)/400)+Math.floor((367*(a+1)-362)/12+(2>=a+1?0:q.isLeapYear(f)?-1:-2)+c),d=Math.floor(d)+0.5,d=d-this._ISLAMIC_EPOCH,a=Math.floor((30*d+10646)/10631),c=Math.ceil((d-29-this._yearStart(a))/29.5),c=Math.min(c,11);this._date=Math.ceil(d-this._monthStart(a,c))+1;this._month=c;this._year=a;this._hours=f.getHours();this._minutes=f.getMinutes();this._seconds=f.getSeconds();this._milliseconds=f.getMilliseconds();
this._day=f.getDay();return this},valueOf:function(){return this.toGregorian().valueOf()},_yearStart:function(f){return 354*(f-1)+Math.floor((3+11*f)/30)},_monthStart:function(f,d){return Math.ceil(29.5*d)+354*(f-1)+Math.floor((3+11*f)/30)},_civilLeapYear:function(f){return 11>(14+11*f)%30},getDaysInIslamicMonth:function(f,d){var a=0,a=29+(f+1)%2;11==f&&this._civilLeapYear(d)&&a++;return a},_mod:function(f,d){return f-d*Math.floor(f/d)}});s.getDaysInIslamicMonth=function(f){return(new s).getDaysInIslamicMonth(f.getMonth(),
f.getFullYear())};return s})},"dojox/date/islamic/locale":function(){define("../.. dojo/_base/lang dojo/_base/array dojo/date dojo/i18n dojo/regexp dojo/string ./Date dojo/i18n!dojo/cldr/nls/islamic".split(" "),function(t,k,q,s,f,d,a,c,e){function l(c,d,b,e,g){return g.replace(/([a-z])\1*/ig,function(b){var e,f,l=b.charAt(0);b=b.length;var k=["abbr","wide","narrow"];switch(l){case "G":e=d.eraAbbr[0];break;case "y":e=String(c.getFullYear());break;case "M":e=c.getMonth();3>b?(e+=1,f=!0):(l=["months-format",
k[b-3]].join("-"),e=d[l][e]);break;case "d":e=c.getDate(!0);f=!0;break;case "E":e=c.getDay();3>b?(e+=1,f=!0):(l=["days-format",k[b-3]].join("-"),e=d[l][e]);break;case "a":e=12>c.getHours()?"am":"pm";e=d["dayPeriods-format-wide-"+e];break;case "h":case "H":case "K":case "k":f=c.getHours();switch(l){case "h":e=f%12||12;break;case "H":e=f;break;case "K":e=f%12;break;case "k":e=f||24}f=!0;break;case "m":e=c.getMinutes();f=!0;break;case "s":e=c.getSeconds();f=!0;break;case "S":e=Math.round(c.getMilliseconds()*
Math.pow(10,b-3));f=!0;break;case "z":if(e=s.getTimezoneName(c.toGregorian()))break;b=4;case "Z":e=c.toGregorian().getTimezoneOffset();e=[0>=e?"+":"-",a.pad(Math.floor(Math.abs(e)/60),2),a.pad(Math.abs(e)%60,2)];4==b&&(e.splice(0,0,"GMT"),e.splice(3,0,":"));e=e.join("");break;default:throw Error("dojox.date.islamic.locale.formatPattern: invalid pattern char: "+g);}f&&(e=a.pad(e,b));return e})}function g(a,c,b,d){var e=function(a){return a};c=c||e;b=b||e;d=d||e;var g=a.match(/(''|[^'])+/g),f="'"==
a.charAt(0);q.forEach(g,function(a,d){a?(g[d]=(f?b:c)(a),f=!f):g[d]=""});return d(g.join(""))}function x(a,c,b,e){e=d.escapeString(e);f.normalizeLocale(b.locale);return e.replace(/([a-z])\1*/ig,function(d){var e;e=d.charAt(0);var g=d.length,f="";b.strict?1<g&&(f="0{"+(g-1)+"}"):f="0?";switch(e){case "y":e="\\d+";break;case "M":e=2<g?"\\S+ ?\\S+":f+"[1-9]|1[0-2]";break;case "d":e="[12]\\d|"+f+"[1-9]|3[01]";break;case "E":e="\\S+";break;case "h":e=f+"[1-9]|1[0-2]";break;case "k":e=f+"\\d|1[01]";break;
case "H":e=f+"\\d|1\\d|2[0-3]";break;case "K":e=f+"[1-9]|1\\d|2[0-4]";break;case "m":case "s":e=f+"\\d|[0-5]\\d";break;case "S":e="\\d{"+g+"}";break;case "a":g=b.am||c["dayPeriods-format-wide-am"];f=b.pm||c["dayPeriods-format-wide-pm"];b.strict?e=g+"|"+f:(e=g+"|"+f,g!=g.toLowerCase()&&(e+="|"+g.toLowerCase()),f!=f.toLowerCase()&&(e+="|"+f.toLowerCase()));break;default:e=".*"}a&&a.push(d);return"("+e+")"}).replace(/[\xa0 ]/g,"[\\s\\xa0]")}var r=k.getObject("date.islamic.locale",!0,t);r.format=function(a,
c){c=c||{};var b=f.normalizeLocale(c.locale),d=c.formatLength||"short",e=r._getIslamicBundle(b),p=[],b=k.hitch(this,l,a,e,b,c.fullYear);if("year"==c.selector)return a.getFullYear();if("time"!=c.selector){var q=c.datePattern||e["dateFormat-"+d];q&&p.push(g(q,b))}"date"!=c.selector&&(d=c.timePattern||e["timeFormat-"+d])&&p.push(g(d,b));return p.join(" ")};r.regexp=function(a){return r._parseInfo(a).regexp};r._parseInfo=function(a){a=a||{};var c=f.normalizeLocale(a.locale),c=r._getIslamicBundle(c),b=
a.formatLength||"short",d=a.datePattern||c["dateFormat-"+b],b=a.timePattern||c["timeFormat-"+b],e=[];return{regexp:g("date"==a.selector?d:"time"==a.selector?b:"undefined"==typeof b?d:d+" "+b,k.hitch(this,x,e,c,a)),tokens:e,bundle:c}};r.parse=function(a,d){a=a.replace(/[\u200E\u200F\u202A\u202E]/g,"");d||(d={});var b=r._parseInfo(d),e=b.tokens,g=b.bundle,b=b.regexp.replace(/[\u200E\u200F\u202A\u202E]/g,""),b=RegExp("^"+b+"$").exec(a);f.normalizeLocale(d.locale);if(!b)return null;var p=[1389,0,1,0,
0,0,0],l="",k=["abbr","wide","narrow"];q.every(b,function(a,b){if(!b)return!0;var c=e[b-1],f=c.length;switch(c.charAt(0)){case "y":p[0]=Number(a);break;case "M":if(2<f){if(c=g["months-format-"+k[f-3]].concat(),d.strict||(a=a.replace(".","").toLowerCase(),c=q.map(c,function(a){return a?a.replace(".","").toLowerCase():a})),a=q.indexOf(c,a),-1==a)return!1}else a--;p[1]=Number(a);break;case "D":p[1]=0;case "d":p[2]=Number(a);break;case "a":c=d.am||g["dayPeriods-format-wide-am"];f=d.pm||g["dayPeriods-format-wide-pm"];
if(!d.strict){var r=/\./g;a=a.replace(r,"").toLowerCase();c=c.replace(r,"").toLowerCase();f=f.replace(r,"").toLowerCase()}if(d.strict&&a!=c&&a!=f)return!1;l=a==f?"p":a==c?"a":"";break;case "K":24==a&&(a=0);case "h":case "H":case "k":p[3]=Number(a);break;case "m":p[4]=Number(a);break;case "s":p[5]=Number(a);break;case "S":p[6]=Number(a)}return!0});b=+p[3];"p"===l&&12>b?p[3]=b+12:"a"===l&&12==b&&(p[3]=0);return new c(p[0],p[1],p[2],p[3],p[4],p[5],p[6])};var z=[];r.addCustomFormats=function(a,c){z.push({pkg:a,
name:c})};r._getIslamicBundle=function(a){var c={};q.forEach(z,function(b){b=f.getLocalization(b.pkg,b.name,a);c=k.mixin(c,b)},this);return c};r.addCustomFormats("dojo.cldr","islamic");r.getNames=function(a,c,b,d,e){var g;d=r._getIslamicBundle(d);a=[a,b,c];"standAlone"==b&&(b=a.join("-"),g=d[b],1==g[0]&&(g=void 0));a[1]="format";return(g||d[a.join("-")]).concat()};r.weekDays=r.getNames("days","wide","format");r.months=r.getNames("months","wide","format");return r})},"widgets/SituationAwareness/js/SummaryInfo":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/_base/Color dojo/dom dojo/dom-class dojo/dom-construct dojo/dom-style dojo/number dojo/on dojo/has dijit/form/Button jimu/dijit/Popup jimu/CSVUtils jimu/utils esri/config esri/geometry/geometryEngine esri/geometry/mathUtils esri/geometry/Point esri/geometry/webMercatorUtils esri/graphic esri/layers/FeatureLayer esri/symbols/SimpleMarkerSymbol esri/symbols/SimpleLineSymbol esri/symbols/Font esri/symbols/TextSymbol esri/tasks/query".split(" "),
function(t,k,q,s,f,d,a,c,e,l,g,x,r,z,m,n,b,v,u,p,y,B,F,I,D,A,E){return t("SummaryInfo",null,{summaryLayer:null,summaryFields:[],summaryIds:[],summaryFeatures:[],summaryGeom:null,symbolField:null,graphicsLayer:null,lyrRenderer:null,lyrSymbol:null,constructor:function(a,b,c){this.tab=a;this.container=b;this.parent=c;this.config=c.config;this.graphicsLayer=null},updateForIncident:function(a,b,c){this.container.innerHTML="";d.add(this.container,"loading");this.summaryIds=[];this.summaryFeatures=[];this.summaryGeom=
b.geometry;if(0<this.tab.tabLayers.length){var e;"undefined"!==typeof this.tab.tabLayers[0].infoTemplate?(this.summaryLayer=this.tab.tabLayers[0],e=new B(this.summaryLayer.url),e.infoTemplate=this.tab.tabLayers[0].infoTemplate,this.tab.tabLayers.push(e),this._initGraphicsLayer(c),this.summaryFields=this._getFields(this.summaryLayer),q.hitch(this,this._queryFeatures(b.geometry))):(e=new B(this.tab.tabLayers[0].url),l(e,"load",q.hitch(this,function(){this.summaryLayer=e;if(-1<this.tab.tabLayers[0].url.indexOf("MapServer"))for(var a=
this.tab.tabLayers[0].url.split("MapServer/")[1],d=this.parent.map.itemInfo.itemData.operationalLayers,g=0;g<d.length;g++){var f=d[g];if("undefined"!==typeof f.layerObject&&f.layerObject.infoTemplates&&(f=f.layerObject.infoTemplates[a])){e.infoTemplate=f.infoTemplate;break}}this.tab.tabLayers.push(e);this._initGraphicsLayer(c);this.summaryFields=this._getFields(this.summaryLayer);q.hitch(this,this._queryFeatures(b.geometry))})))}},_initGraphicsLayer:function(a){null!==a&&(this.graphicsLayer=a,this.graphicsLayer.clear(),
this.summaryLayer&&this.summaryLayer.renderer&&(this.lyrRenderer=this.summaryLayer.renderer,this.graphicsLayer.renderer=this.lyrRenderer,"undefined"!==typeof this.summaryLayer.renderer.attributeField?this.symbolField=this.summaryLayer.renderer.attributeField:this.lyrSymbol=this.lyrRenderer.symbol))},_queryFeatures:function(a){var b=new E;b.geometry=a;this.summaryLayer.queryIds(b,q.hitch(this,function(a){a?(this.summaryIds=a,0<this.summaryIds.length?this._queryFeaturesByIds():this._processResults()):
this._processResults()}))},_queryFeaturesByIds:function(){var a=this.summaryLayer.maxRecordCount||1E3,b=this.summaryIds.slice(0,a);this.summaryIds.splice(0,a);var a=new E,c=!1;k.some(this.summaryFields,q.hitch(this,function(a){if("area"===a.type||"length"===a.type||this.graphicsLayer)return c=!0}));a.returnGeometry=c;var e=[];k.forEach(this.summaryFields,function(a){e.push(a.field)});this.symbolField&&e.push(this.symbolField);a.outFields=!0===this.config.csvAllFields||"true"===this.config.csvAllFields?
["*"]:e;a.objectIds=b;this.summaryLayer.queryFeatures(a,q.hitch(this,function(a){this.summaryFeatures=this.summaryFeatures.concat(a.features);this._processResults();0<this.summaryIds.length?(f.byId("SA_SAT_download")&&d.replace(f.byId("SA_SAT_download"),"processing","download"),this._queryFeaturesByIds()):f.byId("SA_SAT_download")&&d.replace(f.byId("SA_SAT_download"),"download","processing")}))},_prepResults:function(){for(var a=0;a<this.summaryFields.length;a++){var b=this.summaryFields[a],c=b.field,
d=b.total;switch(b.type){case "count":d=this.summaryFeatures.length;break;case "area":d=this._getArea();break;case "length":d=this._getLength();break;case "sum":d=this._getSum(c);break;case "avg":d=this._getSum(c)/this.summaryFeatures.length;break;case "min":d=this._getMin(c);break;case "max":d=this._getMax(c)}b.total=d}},_sortResults:function(a){return function(b,c){return b.attributes[a]<c.attributes[a]?-1:b.attributes[a]>c.attributes[a]?1:0}},_getSum:function(a){var b=0;k.forEach(this.summaryFeatures,
function(c){b+=c.attributes[a]});return b},_getMin:function(a){this.summaryFeatures.sort(this._sortResults(a));return this.summaryFeatures[0].attributes[a]},_getMax:function(a){this.summaryFeatures.sort(this._sortResults(a));this.summaryFeatures.reverse();return this.summaryFeatures[0].attributes[a]},_getArea:function(){var a=0,c=q.clone(this.config.distanceSettings);c.miles=109413;c.kilometers=109414;c.feet=109405;c.meters=109404;c.yards=109442;c.nauticalMiles=109409;var d=c[this.config.distanceUnits];
k.forEach(this.summaryFeatures,q.hitch(this,function(c){c=b.intersect(c.geometry,this.summaryGeom);null!==c&&(a+=b.geodesicArea(c,d))}));return a},_getLength:function(){var a=0,c=this.config.distanceSettings[this.config.distanceUnits];k.forEach(this.summaryFeatures,q.hitch(this,function(d){d=b.intersect(d.geometry,this.summaryGeom);null!==d&&(a+=b.geodesicLength(d,c))}));return a},_processResults:function(){this._prepResults();this.container.innerHTML="";d.remove(this.container,"loading");var b=this.summaryFields,
c=0,g=a.create("div",{id:"SA_tpc",style:"width:"+220*(b.length+1)+"px;"},this.container);d.add(g,"SAT_tabPanelContent");var f=a.create("div",{},g);d.add(f,"SATcol");f=a.create("div",{id:"SA_SAT_download",innerHTML:this.parent.nls.downloadCSV},f);d.add(f,["btnExport","download"]);l(f,"click",q.hitch(this,this._exportToCSV));for(f=0;f<b.length;f++){var c=b[f],p=m.sanitizeHTML(c.alias?c.alias:"")+"\x3cbr/\x3e",c=c.alias===this.parent.nls.area||c.alias===this.parent.nls.length?c.total:Math.round(c.total);
isNaN(c)&&(c=0);p+="\x3cdiv class\x3d'colSummary'\x3e"+e.format(c)+"\x3c/div\x3e\x3cbr/\x3e";p=a.create("div",{id:"SA_Demographics_"+f,innerHTML:p},g);d.add(p,"SATcol")}if(null!==this.graphicsLayer){this.graphicsLayer.clear();this.tab.tabLayers[1].clear();if(this.summaryFeatures)for(b=0;b<this.summaryFeatures.length;b++)g=this.summaryFeatures[b],this.lyrSymbol?g.symbol=this.lyrSymbol:(f=this.graphicsLayer.renderer.getSymbol(g),g.symbol=f),this.graphicsLayer.add(g),this.tab.tabLayers[1].add(g);this.graphicsLayer.setVisibility(!0)}},
_exportToCSV:function(){if(0===this.summaryFeatures.length)return!1;var a=this.tab.tabLayers[0].id,b=[],c=[];k.forEach(this.summaryFeatures,function(a){b.push(a.attributes)});if(!0===this.config.csvAllFields||"true"===this.config.csvAllFields)for(var d in b[0])c.push(d);else for(d=0;d<this.summaryFields.length;d++)c.push(this.summaryFields[d].field);z.exportCSV(a,b,c)},_getFields:function(a){var b=[];if(this.tab.advStat){a=this.tab.advStat.stats;for(var c in a)0<a[c].length&&k.forEach(a[c],function(a){b.push({field:a.expression,
alias:a.label+"",type:c,total:0})});return b}var d;if(a.infoTemplate)d=a.infoTemplate.info.fieldInfos;else if(-1<this.tab.tabLayers[0].url.indexOf("MapServer")){var e=this.tab.tabLayers[0].url.split("MapServer/")[1],g=this.parent.map.itemInfo.itemData.operationalLayers;d=null;for(var f=0;f<g.length;f++){var l=g[f];if(l.layerObject.infoTemplates&&(l=l.layerObject.infoTemplates[e])){d=l.infoTemplate.info.fieldInfos;break}}}else d=a.fields;d||(d=a.fields);for(e=0;e<d.length;e++)if(g=d[e],"undefined"!==
typeof a.fields){var f=a.fields[e].type,p;if(g.name!==a.objectIdField&&("esriFieldTypeDouble"===f||"esriFieldTypeInteger"===f||"esriFieldTypeSmallInteger"===f))"undefined"!==typeof g.visible?g.visible&&(p={field:g.fieldName,alias:g.label,type:"sum",total:0}):p={field:g.name,alias:g.alias,type:"sum",total:0},p&&b.push(p),p=null}return b}})})},"jimu/CSVUtils":function(){define("exports dojo/_base/lang dojo/_base/array dojo/_base/html dojo/has dojo/Deferred jimu/utils esri/tasks/QueryTask esri/tasks/query".split(" "),
function(t,k,q,s,f,d,a,c,e){t.exportCSV=function(a,c,d){return t._createCSVStr(c,d).then(function(c){return t._download(a+".csv",c)})};t.exportCSVFromFeatureLayer=function(a,c,d){d=d||{};return t._getExportData(c,{datas:d.datas,fromClient:d.fromClient,outFields:d.outFields,filterExpression:d.filterExpression}).then(function(e){return t._formattedData(c,e,{formatNumber:d.formatNumber,formatDate:d.formatDate,formatCodedValue:d.formatCodedValue}).then(function(c){return t.exportCSV(a,c.datas,c.columns)})})};
t.exportCSVByAttributes=function(a,c,d,e){e=k.mixin({},e);e.datas=d;return t.exportCSVFromFeatureLayer(a,c,e)};t.exportCSVByGraphics=function(a,c,d,e){d=q.map(d,function(a){return a.attributes});return t.exportCSVByAttributes(a,c,d,e)};t._createCSVStr=function(a,c){var e=new d,f="",k=0,m=0,n="",b="";try{q.forEach(c,function(a){f=f+n+a;n=","});for(var f=f+"\r\n",k=a.length,m=c.length,s=0;s<k;s++){for(var n="",t=0;t<m;t++)b=a[s][c[t]],!b&&"number"!==typeof b&&(b=""),b&&/[",\r\n]/g.test(b)&&(b='"'+b.replace(/(")/g,
'""')+'"'),f=f+n+b,n=",";f+="\r\n"}e.resolve(f)}catch(p){console.error(p),e.resolve("")}return e};t._isIE11=function(){var a=0,c=/MSIE (\d+\.\d+);/.test(navigator.userAgent),d=!!navigator.userAgent.match(/Trident\/7.0/),e=navigator.userAgent.indexOf("rv:11.0");c&&(a=Number(RegExp.$1));-1!==navigator.appVersion.indexOf("MSIE 10")&&(a=10);d&&-1!==e&&(a=11);return 11===a};t._isEdge=function(){return/Edge\/12/.test(navigator.userAgent)};t._getDownloadUrl=function(a){return window.Blob&&window.URL&&window.URL.createObjectURL?
(a=new Blob(["\ufeff"+a],{type:"text/csv"}),URL.createObjectURL(a)):"data:attachment/csv;charset\x3dutf-8,\ufeff"+encodeURIComponent(a)};t._download=function(a,c){var e=new d;try{if(f("ie")&&10>f("ie")){var k=window.top.open("about:blank","_blank");k.document.write("sep\x3d,\r\n"+c);k.document.close();k.document.execCommand("SaveAs",!0,a);k.close()}else if(10===f("ie")||t._isIE11()||t._isEdge()){var q=new Blob(["\ufeff"+c],{type:"text/csv"});navigator.msSaveBlob(q,a)}else{var m=s.create("a",{href:t._getDownloadUrl(c),
target:"_blank",download:a},document.body);if(f("safari")){var n=document.createEvent("MouseEvents");n.initEvent("click",!0,!0);m.dispatchEvent(n)}else m.click();s.destroy(m)}e.resolve()}catch(b){e.reject(b)}return e};t._getExportData=function(a,c){var e=new d,f=null,k=c.datas,f=c.outFields;if(!f||!f.length)f=a.fields;k&&0<k.length?e.resolve({data:k||[],outFields:f}):c.fromClient?(k=q.map(a.graphics,function(a){return a.attributes}),e.resolve({data:k||[],outFields:f})):t._getExportDataFromServer(a,
f,c).then(function(a){e.resolve({data:a||[],outFields:f})});return e};t._getExportDataFromServer=function(a,g,f){var k=new d;if("esri.layers.FeatureLayer"!==a.declaredClass)return k.resolve([]),k;var s=new c(a.url),m=new e;m.where=f.filterExpression||a.getDefinitionExpression&&a.getDefinitionExpression()||"1\x3d1";0<g.length?(a=q.map(g,function(a){return a.name}),m.outFields=a):m.outFields=["*"];m.returnGeometry=!1;s.execute(m,function(a){a=q.map(a.features,function(a){return a.attributes});k.resolve(a)},
function(a){console.error(a);k.resolve([])});return k};t._formattedData=function(a,c,e){var f=new d,k=[],m=c.data;c=c.outFields;for(var n=0,b=m.length;n<b;n++){for(var s={},u=0;u<c.length;u++){var p=c[u];s[p.alias||p.name]=t._getExportValue(m[n][p.name],p,a.objectIdField,a.typeIdField,m[n][a.typeIdField],a.types,e)}k.push(s)}a=q.map(c,function(a){return a.alias||a.name});f.resolve({datas:k,columns:a});return f};t._getExportValue=function(c,d,e,f,k,m,n){var b=!!d.domain&&n.formatCodedValue;n="esriFieldTypeDate"===
d.type&&n.formatDate;var s=e&&d.name===e;f=f&&d.name===f;return n?a.fieldFormatter.getFormattedDate(c):f?a.fieldFormatter.getTypeName(c,m):b?a.fieldFormatter.getCodedValue(d.domain,c):!b&&!n&&!s&&!f?(b=null,e&&m&&0<m.length&&(e=(e=q.filter(m,function(a){return a.id===k}))&&e[0])&&(e.domains&&e.domains[d.name]&&e.domains[d.name].codedValues)&&(b=a.fieldFormatter.getFormattedCodedValue(e.domains[d.name],c)),null!==b?b:c):c}})},"widgets/SituationAwareness/js/WeatherInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct esri/geometry/webMercatorUtils esri/request".split(" "),
function(t,k,q,s,f,d){return t("WeatherInfo",null,{constructor:function(a,c,d){this.tab=a;this.container=c;this.parent=d;this.weatherURL=a.url;this.weatherDict={119:["Cloudy","cloudy5.png","cloudy5.png"],377:["Moderate or heavy showers of ice pellets","hail.png","hail.png"],374:["Light showers of ice pellets","hail.png","hail.png"],350:["Ice pellets","hail.png","hail.png"],353:["Light rain shower","light_rain.png","light_rain.png"],302:["Moderate rain","light_rain.png","light_rain.png"],296:["Light rain",
"light_rain.png","light_rain.png"],293:["Patchy light rain","light_rain.png","light_rain.png"],266:["Light drizzle","light_rain.png","light_rain.png"],263:["Patchy light drizzle","light_rain.png","light_rain.png"],122:["Overcast","overcast.png","overcast.png"],359:["Torrential rain shower","shower3.png","shower3.png"],308:["Heavy rain","shower3.png","shower3.png"],365:["Moderate or heavy sleet showers","sleet.png","sleet.png"],362:["Light sleet showers","sleet.png","sleet.png"],320:["Moderate or heavy sleet",
"sleet.png","sleet.png"],317:["Light sleet","sleet.png","sleet.png"],314:["Moderate or Heavy freezing rain","sleet.png","sleet.png"],311:["Light freezing rain","sleet.png","sleet.png"],284:["Heavy freezing drizzle","sleet.png","sleet.png"],281:["Freezing drizzle","sleet.png","sleet.png"],185:["Patchy freezing drizzle nearby","sleet.png","sleet.png"],182:["Patchy sleet nearby","sleet.png","sleet.png"],395:["Moderate or heavy snow in area with thunder","snow4.png","snow4.png"],335:["Patchy heavy snow",
"snow4.png","snow4.png"],230:["Blizzard","snow4.png","snow4.png"],227:["Blowing snow","snow4.png","snow4.png"],371:["Moderate or heavy snow showers","snow5.png","snow5.png"],338:["Heavy snow","snow5.png","snow5.png"],389:["Moderate or heavy rain in area with thunder","tstorm3.png","tstorm3.png"],392:["Patchy light snow in area with thunder","snow2.png","snow2_night.png"],386:["Patchy light rain in area with thunder","tstorm1.png","tstorm1_night.png"],368:["Light snow showers","snow2.png","snow2_night.png"],
356:["Moderate or heavy rain shower","shower2.png","shower2_night.png"],332:["Moderate snow","snow3.png","snow3_night.png"],329:["Patchy moderate snow","snow2.png","snow2_night.png"],326:["Light snow","snow1.png","snow1_night.png"],323:["Patchy light snow","snow1.png","snow1_night.png"],305:["Heavy rain at times","shower2.png","shower2_night.png"],299:["Moderate rain at times","shower2.png","shower2_night.png"],260:["Freezing fog","fog.png","fog_night.png"],248:["Fog","fog.png","fog_night.png"],200:["Thundery outbreaks in nearby",
"tstorm1.png","tstorm1_night.png"],179:["Patchy snow nearby","snow1.png","snow1_night.png"],176:["Patchy rain nearby","shower1.png","shower1_night.png"],143:["Mist","mist.png","mist_night.png"],116:["Partly Cloudy","cloudy3.png","cloudy3_night.png"],113:["Clear/Sunny","sunny.png","sunny_night.png"]}},updateForIncident:function(a){this.container.innerHTML="";q.add(this.container,"loading");var c=a=a.geometry;"point"!==a.type&&(c=a.getExtent().getCenter());a=f.webMercatorToGeographic(c);a=a.y+","+a.x;
c="";"Weather"!==this.tab.label?(c=this.weatherURL,this.container.innerHTML="\x3cimg style\x3d'height:100%;' src\x3d'"+this.weatherURL+"' /\x3e"):(c=this.weatherURL+"\x26q\x3d"+a,d({url:c,callbackParamName:"callback"},{useProxy:!1}).then(k.hitch(this,function(a){return this._resultsHandler(a)}),k.hitch(this,function(a){a=this._errorHandler(a);console.log(a)})))},_resultsHandler:function(a){a=a.data;console.log(a);var c=a.current_condition;a=a.weather;var d=1;this.container.innerHTML="";q.remove(this.container,
"loading");var f=s.create("div",{id:"tpc",style:"width:"+165*(a.length+3)+"px;"},this.container);q.add(f,"SAT_tabPanelContent");var g,k;if(0<c.length){c=c[0];g=c.localObsDateTime.split(" ");k=g[2];g=g[1].split(":");g=parseInt(g[0],10);if("AM"===k){if(6>g||12===g)d=2}else 6<g&&12>g&&(d=2);k=c.temp_F;g=c.weatherCode;g=this.weatherDict[parseInt(g,10)];g=this.parent.nls.now+"\x3cbr/\x3e\x3cimg style\x3d'height:45px' src\x3d'"+this.parent.folderUrl+"images/w/"+g[d]+"' /\x3e\x3cbr/\x3e"+k+"\x26deg;";k=
s.create("div",{innerHTML:g},f);q.add(k,"SATcolSmall");g=this.parent.nls.wind+"\x3cbr/\x3e\x3cspan style\x3d'font-size: 30px; line-height:47px'\x3e"+c.winddir16Point+"\x3c/span\x3e\x3cbr/\x3e"+c.windspeedMiles+" MPH";c=s.create("div",{innerHTML:g},f);q.add(c,"SATcolSmall")}for(k=0;k<a.length;k++){var c=a[k],r=this._getDay(c.date),t=c.tempMaxF,m=c.tempMinF;g=c.weatherCode;g=this.weatherDict[parseInt(g,10)];g=r+"\x3cbr/\x3e\x3cimg style\x3d'height:45px' src\x3d'"+this.parent.folderUrl+"images/w/"+g[d]+
"' /\x3e\x3cbr/\x3e"+t+"\x26deg; | "+m+"\x26deg;";c=s.create("div",{innerHTML:g},f);q.add(c,"SATcolSmall")}a=s.create("div",{innerHTML:'\x3cbr/\x3e\x3cbr/\x3e\x3cbr/\x3e\x3cspan style\x3d"font-size:11px;color:#6e6e6e"\x3ePowered by\x3cbr/\x3e\x3ca style\x3d"color:#6e6e6e;text-decoration:none" href\x3d"http://www.worldweatheronline.com/" title\x3d"Free Weather API" target\x3d"_blank"\x3eWorld Weather Online\x3c/a\x3e\x3c/span\x3e'},f);q.add(a,"SATcolSmall");q.add(a,"SATcolLast")},_getDay:function(a){a=
a.split("-");a="SUN MON TUE WED THU FRI SAT".split(" ")[(new Date(a[0],a[1]-1,a[2])).getDay()];return this.parent.nls[a]},_errorHandler:function(a){console.log(a.message);a=s.create("div",{innerHTML:a.message},this.container);q.add(a,"SATcolSmall")}})})},"widgets/SituationAwareness/js/ClosestInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/_base/array dojo/DeferredList dojo/dom-class dojo/dom-construct dojo/dom-style dojo/on jimu/utils esri/geometry/geometryEngine esri/geometry/Polyline esri/graphic esri/layers/FeatureLayer esri/symbols/SimpleMarkerSymbol esri/symbols/SimpleLineSymbol esri/symbols/Font esri/symbols/TextSymbol esri/tasks/query".split(" "),
function(t,k,q,s,f,d,a,c,e,l,g,x,r,z,m,n,b,v,u){return t("ClosestInfo",null,{constructor:function(a,b,c){this.tab=a;this.container=b;this.parent=c;this.graphicsLayer=this.incident=null;this.map=c.map;this.specialFields={};this.dateFields={}},updateForIncident:function(a,b,c){s.forEach(this.tab.tabLayers,k.hitch(this,function(d){if("undefined"!==typeof d.empty){var f=new z(d.url);e(f,"load",k.hitch(this,function(){this.tab.tabLayers=[f];this.processIncident(a,b,c)}))}else this.processIncident(a,b,
c)}))},processIncident:function(a,b,c){this.container.innerHTML="";d.add(this.container,"loading");var e=[];this.incident=a;b=g.buffer(a.geometry,b,this.parent.config.distanceSettings[this.parent.config.distanceUnits]);this.graphicsLayer=c;this.graphicsLayer.clear();var l=this.tab.tabLayers;c=[];for(var m=0;m<l.length;m++){var n=l[m],q=new u;q.returnGeometry=!0;q.geometry=b;q.outFields=this._getFields(n);c.push(n.queryFeatures(q))}(new f(c)).then(k.hitch(this,function(b){for(var c=0;c<b.length;c++){var d=
b[c][1],f=this._getFields(l[c]),d=d.features;if(0<d.length){for(var g=0;g<d.length;g++){for(var k=d[g],m={DISTANCE:this._getDistance(a.geometry,k.geometry)},n=0;n<f.length;n++)m[f[n]]=k.attributes[f[n]];k.attributes=m}d.sort(this._compareDistance);e.push(d[0])}}this._processResults(e)}))},_processResults:function(f){this.container.innerHTML="";d.remove(this.container,"loading");0===f.length&&(this.container.innerHTML=this.parent.nls.noFeaturesFound);var g=a.create("div",{id:"SA_tpc",style:"width:"+
220*f.length+"px;"},this.container);d.add(g,"SAT_tabPanelContent");for(var s=this.parent.nls[this.parent.config.distanceUnits],t=0;t<f.length;t++){var u=t+1,D=f[t],A=D.geometry,z=A;"point"!==A.type&&(z=A.getExtent().getCenter());var D=D.attributes,G;"point"===this.incident.geometry.type&&(G=s+": "+Math.round(100*D.DISTANCE)/100);var A="",C=0,h;for(h in D)"DISTANCE"!==h&&3>C&&(A+=l.sanitizeHTML(this._getFieldValue(h,D[h])+"\x3cbr/\x3e"),C+=1);C=a.create("div",{id:"SA_Feature_"+u},g);d.add(C,"SATcolRec");
var w=a.create("div",{},C);d.add(w,"SATcolRecBar");var H=a.create("div",{innerHTML:u},w);d.add(H,"SATcolRecNum");c.set(H,"backgroundColor",this.parent.config.color);e(H,"click",k.hitch(this,this._zoomToLocation,z));G&&(H=a.create("div",{innerHTML:G},w),d.add(H,"SATcolDistance"));this.parent.config.enableRouting&&(w=a.create("div",{},w),d.add(w,"SATcolDir"),e(w,"click",k.hitch(this,this._routeToIncident,z)));A=a.create("div",{innerHTML:A},C);d.add(A,"SATcolInfo");A=new n(n.STYLE_SOLID,new q.fromString(this.parent.config.color),
1);A=new m(m.STYLE_CIRCLE,24,A,new q.fromString(this.parent.config.color));C=new b;C.family="Arial";C.size="12px";u=new v(u,C,"#ffffff");u.setOffset(0,-4);null===D.OUTSIDE_POLYGON&&(C=new n(n.STYLE_SOLID,new q([0,0,0,1]),1),w=new x(z.spatialReference),H=this.incident.geometry,"point"!==this.incident.geometry.type&&(H=this.incident.geometry.getExtent().getCenter()),w.addPath([z,H]),this.graphicsLayer.add(new r(w,C,{})));this.graphicsLayer.add(new r(z,A,D));this.graphicsLayer.add(new r(z,u,D))}},_getFields:function(a){var b=
[];if(this.tab.advStat&&this.tab.advStat.stats&&0<this.tab.advStat.stats.outFields.length)s.forEach(this.tab.advStat.stats.outFields,function(a){b.push(a.expression)});else{var c;if(a.infoTemplate)c=a.infoTemplate.info.fieldInfos;else if(0<this.parent.map.itemInfo.itemData.operationalLayers.length){var d=this.parent.map.itemInfo.itemData.operationalLayers;c=null;var e=0;a:for(;e<d.length;e++){var f=d[e];if("ArcGISMapServiceLayer"===f.layerType&&"undefined"!==typeof f.layers)for(var g=0;g<f.layers.length;g++){var l=
f.layers[g];if(l.id===a.layerId&&l.popupInfo){c=l.popupInfo.fieldInfos;break a}}}c||(c=a.fields)}else c=a.fields;for(d=0;d<c.length;d++)e=c[d],"undefined"!==typeof e.visible?e.visible&&b.push(e.fieldName):b.push(e.name)}var m={};s.forEach(a.fields,k.hitch(this,function(b){if("esriFieldTypeDate"===b.type||b.domain){if("esriFieldTypeDate"===b.type&&a.infoTemplate)for(var c in a.infoTemplate._fieldsMap)"undefined"!==typeof a.infoTemplate._fieldsMap[c].fieldName&&(a.infoTemplate._fieldsMap[c].fieldName===
b.name&&"undefined"!==typeof a.infoTemplate._fieldsMap[c].format.dateFormat)&&(this.dateFields[b.name]=a.infoTemplate._fieldsMap[c].format.dateFormat);m[b.name]=b}}));this.specialFields=m;return b},_getFieldValue:function(a,b){var c=b;if(this.specialFields[a]){var d=this.specialFields[a];"esriFieldTypeDate"===d.type?"undefined"!==this.dateFields[a]?(d=this._getDateFormat(this.dateFields[a]),c=void 0!==typeof d?(new Date(b)).toLocaleDateString(navigator.language,d):(new Date(b)).toLocaleString()):
c=(new Date(b)).toLocaleString():s.some(d.domain.codedValues,function(a){if(a.code===b)return c=a.name,!0})}return c},_getDateFormat:function(a){var b;switch(a){case "shortDate":b={month:"2-digit",day:"2-digit",year:"numeric"};break;case "shortDateLE":b={day:"2-digit",month:"2-digit",year:"numeric"};break;case "longMonthDayYear":b={month:"long",day:"2-digit",year:"numeric"};break;case "dayShortMonthYear":b={day:"2-digit",month:"short",year:"numeric"};break;case "longDate":b={weekday:"long",month:"long",
day:"2-digit",year:"numeric"};break;case "shortDateLongTime":b={month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0};break;case "shortDateLELongTime":b={day:"2-digit",month:"2-digit",year:"numeric",hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0};break;case "shortDateShortTime":b={month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0};break;case "shortDateLEShortTime":b={day:"2-digit",month:"2-digit",year:"numeric",
hour:"numeric",minute:"2-digit",hour12:!0};break;case "shortDateShortTime24":b={month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!1};break;case "shortDateLEShortTime24":b={day:"2-digit",month:"2-digit",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!1};break;case "longMonthYear":b={month:"long",year:"numeric"};break;case "shortMonthYear":b={month:"short",year:"numeric"};break;case "year":b={year:"numeric"}}return b},_getDistance:function(a,b){var c=0,d=this.parent.config.distanceUnits,
c=g.distance(a,b,9001);switch(d){case "miles":c*=6.21371E-4;break;case "kilometers":c*=0.0010;break;case "feet":c*=3.28084;break;case "yards":c*=1.09361;break;case "nauticalMiles":c*=5.39957E-4}return c},_compareDistance:function(a,b){return a.attributes.DISTANCE<b.attributes.DISTANCE?-1:a.attributes.DISTANCE>b.attributes.DISTANCE?1:0},_zoomToLocation:function(a){this.parent.zoomToLocation(a)},_routeToIncident:function(a){this.parent.routeToIncident(a)}})})},"widgets/SituationAwareness/js/ProximityInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/_base/array dojo/DeferredList dojo/dom-class dojo/dom-construct dojo/dom-style dojo/on esri/geometry/geometryEngine esri/graphic esri/layers/FeatureLayer esri/symbols/SimpleMarkerSymbol esri/symbols/SimpleLineSymbol esri/symbols/Font esri/symbols/TextSymbol esri/tasks/query jimu/CSVUtils jimu/utils".split(" "),
function(t,k,q,s,f,d,a,c,e,l,g,x,r,z,m,n,b,v,u){return t("ProximityInfo",null,{constructor:function(a,b,c){this.tab=a;this.container=b;this.parent=c;this.graphicsLayer=this.incident=null;this.specialFields={};this.dateFields={}},updateForIncident:function(a,b,c){s.forEach(this.tab.tabLayers,k.hitch(this,function(d){if("undefined"!==typeof d.empty){var f=new x(d.url);e(f,"load",k.hitch(this,function(){this.tab.tabLayers=[f];this.processIncident(a,b,c)}))}else this.processIncident(a,b,c)}))},processIncident:function(a,
c,e){this.container.innerHTML="";d.add(this.container,"loading");var g=[];this.incident=a;this.graphicsLayer=e;var l=this.tab.tabLayers;e=[];for(var m=0;m<l.length;m++){var n=l[m],q=new b;q.returnGeometry=!0;q.geometry=c.geometry;q.outFields="true"===this.parent.config.csvAllFields||!0===this.parent.config.csvAllFields?["*"]:this._getFields(n);e.push(n.queryFeatures(q))}(new f(e)).then(k.hitch(this,function(b){for(var c=0;c<b.length;c++)for(var d=b[c][1],e=this._getFields(l[c]),d=d.features,f=0;f<
d.length;f++){for(var k=d[f],m={DISTANCE:this._getDistance(a.geometry,k.geometry)},n=0;n<e.length;n++)m[e[n]]=k.attributes[e[n]];k.attributes=m;g.push(k)}this._processResults(g)}))},_processResults:function(b){this.container.innerHTML="";d.remove(this.container,"loading");this.graphicsLayer.clear();if(0===b.length)this.container.innerHTML=this.parent.nls.noFeaturesFound;else{b.sort(this._compareDistance);var f=a.create("div",{id:"SA_tpc",style:"width:"+220*(b.length+1)+"px;"},this.container);d.add(f,
"SAT_tabPanelContent");var l=a.create("div",{},f);d.add(l,"SATcol");l=a.create("div",{innerHTML:this.parent.nls.downloadCSV},l);d.add(l,"btnExport");e(l,"click",k.hitch(this,this._exportToCSV,b));for(var l=this.parent.nls[this.parent.config.distanceUnits],s=0;s<b.length;s++){var t=s+1,v=b[s],A=v.geometry,x=A;"point"!==A.type&&(x=A.getExtent().getCenter());var v=v.attributes,G;"point"===this.incident.geometry.type&&(G=l+": "+Math.round(100*v.DISTANCE)/100);var A="",C=0,h;for(h in v)"DISTANCE"!==h&&
3>C&&(A+=u.sanitizeHTML(this._getFieldValue(h,v[h])+"\x3cbr/\x3e"),C+=1);C=a.create("div",{id:"SA_Feature_"+t},f);d.add(C,"SATcolRec");var w=a.create("div",{},C);d.add(w,"SATcolRecBar");var H=a.create("div",{innerHTML:t},w);d.add(H,"SATcolRecNum");c.set(H,"backgroundColor",this.parent.config.color);e(H,"click",k.hitch(this,this._zoomToLocation,x));G&&(H=a.create("div",{innerHTML:G},w),d.add(H,"SATcolDistance"));this.parent.config.enableRouting&&(w=a.create("div",{},w),d.add(w,"SATcolDir"),e(w,"click",
k.hitch(this,this._routeToIncident,x)));A=a.create("div",{innerHTML:A},C);d.add(A,"SATcolInfo");A=new z(z.STYLE_SOLID,new q.fromString(this.parent.config.color),1);A=new r(r.STYLE_CIRCLE,24,A,new q.fromString(this.parent.config.color));C=new m;C.family="Arial";C.size="12px";t=new n(t,C,"#ffffff");t.setOffset(0,-4);this.graphicsLayer.add(new g(x,A,v));this.graphicsLayer.add(new g(x,t,v))}}},_exportToCSV:function(a){if(0===a.length)return!1;var b=this.tab.tabLayers[0].id,c=[],d=[];s.forEach(a,function(a){c.push(a.attributes)});
for(var e in c[0])d.push(e);v.exportCSV(b,c,d)},_getFields:function(a){var b=[];if(this.tab.advStat&&this.tab.advStat.stats&&0<this.tab.advStat.stats.outFields.length)s.forEach(this.tab.advStat.stats.outFields,function(a){b.push(a.expression)});else{var c;if(a.infoTemplate)c=a.infoTemplate.info.fieldInfos;else if(0<this.parent.map.itemInfo.itemData.operationalLayers.length){var d=this.parent.map.itemInfo.itemData.operationalLayers;c=null;var e=0;a:for(;e<d.length;e++){var f=d[e];if("ArcGISMapServiceLayer"===
f.layerType&&"undefined"!==typeof f.layers)for(var g=0;g<f.layers.length;g++){var l=f.layers[g];if(l.popupInfo&&l.id===a.layerId){c=l.popupInfo.fieldInfos;break a}}}c||(c=a.fields)}else c=a.fields;for(d=0;d<c.length;d++)e=c[d],"undefined"!==typeof e.visible?e.visible&&b.push(e.fieldName):b.push(e.name)}var m={};s.forEach(a.fields,k.hitch(this,function(b){if("esriFieldTypeDate"===b.type||b.domain){if("esriFieldTypeDate"===b.type&&a.infoTemplate)for(var c in a.infoTemplate._fieldsMap)"undefined"!==
typeof a.infoTemplate._fieldsMap[c].fieldName&&(a.infoTemplate._fieldsMap[c].fieldName===b.name&&"undefined"!==typeof a.infoTemplate._fieldsMap[c].format.dateFormat)&&(this.dateFields[b.name]=a.infoTemplate._fieldsMap[c].format.dateFormat);m[b.name]=b}}));this.specialFields=m;return b},_getFieldValue:function(a,b){var c=b;if(this.specialFields[a]){var d=this.specialFields[a];"esriFieldTypeDate"===d.type?"undefined"!==this.dateFields[a]?(d=this._getDateFormat(this.dateFields[a]),c=void 0!==typeof d?
(new Date(b)).toLocaleDateString(navigator.language,d):(new Date(b)).toLocaleString()):c=(new Date(b)).toLocaleString():s.some(d.domain.codedValues,function(a){if(a.code===b)return c=a.name,!0})}return c},_getDateFormat:function(a){var b;switch(a){case "shortDate":b={month:"2-digit",day:"2-digit",year:"numeric"};break;case "shortDateLE":b={day:"2-digit",month:"2-digit",year:"numeric"};break;case "longMonthDayYear":b={month:"long",day:"2-digit",year:"numeric"};break;case "dayShortMonthYear":b={day:"2-digit",
month:"short",year:"numeric"};break;case "longDate":b={weekday:"long",month:"long",day:"2-digit",year:"numeric"};break;case "shortDateLongTime":b={month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0};break;case "shortDateLELongTime":b={day:"2-digit",month:"2-digit",year:"numeric",hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0};break;case "shortDateShortTime":b={month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"2-digit",
hour12:!0};break;case "shortDateLEShortTime":b={day:"2-digit",month:"2-digit",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0};break;case "shortDateShortTime24":b={month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!1};break;case "shortDateLEShortTime24":b={day:"2-digit",month:"2-digit",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!1};break;case "longMonthYear":b={month:"long",year:"numeric"};break;case "shortMonthYear":b={month:"short",year:"numeric"};
break;case "year":b={year:"numeric"}}return b},_getDistance:function(a,b){var c=0,d=this.parent.config.distanceUnits,c=l.distance(a,b,9001);switch(d){case "miles":c*=6.21371E-4;break;case "kilometers":c*=0.0010;break;case "feet":c*=3.28084;break;case "yards":c*=1.09361;break;case "nauticalMiles":c*=5.39957E-4}return c},_compareDistance:function(a,b){return a.attributes.DISTANCE<b.attributes.DISTANCE?-1:a.attributes.DISTANCE>b.attributes.DISTANCE?1:0},_zoomToLocation:function(a){this.parent.zoomToLocation(a)},
_routeToIncident:function(a){this.parent.routeToIncident(a)}})})},"widgets/SituationAwareness/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings","dojo/text!./config.json"],function(){})},"url:dijit/templates/ProgressBar.html":'\x3cdiv class\x3d"dijitProgressBar dijitProgressBarEmpty" role\x3d"progressbar"\r\n\t\x3e\x3cdiv  data-dojo-attach-point\x3d"internalProgress" class\x3d"dijitProgressBarFull"\r\n\t\t\x3e\x3cdiv class\x3d"dijitProgressBarTile" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\x3e\x3cspan style\x3d"visibility:hidden"\x3e\x26#160;\x3c/span\r\n\t\x3e\x3c/div\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"labelNode" class\x3d"dijitProgressBarLabel" id\x3d"${id}_label"\x3e\x3c/div\r\n\t\x3e\x3cspan data-dojo-attach-point\x3d"indeterminateHighContrastImage"\r\n\t\t   class\x3d"dijitInline dijitProgressBarIndeterminateHighContrastImage"\x3e\x3c/span\r\n\x3e\x3c/div\x3e\r\n',
"url:esri/dijit/editing/templates/AttachmentEditor.html":"\x3cdiv class\x3d\"attachmentEditor\"\x3e\r\n    \x3cbr /\x3e\r\n    \x3cdiv\x3e\r\n        \x3cb\x3e${NLS_attachments}\x3c/b\x3e\r\n        \x3chr /\x3e\r\n        \x3cdiv dojoAttachPoint\x3d\"_attachmentError\" style\x3d'color:red;display:none'\x3e\x3c/div\x3e\r\n        \x3cbr /\x3e\r\n        \x3cspan dojoAttachPoint\x3d'_attachmentList' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e\r\n        \x3cbr\x3e\x3cbr\x3e\r\n        \x3cdiv data-dojo-type\x3d\"dijit/ProgressBar\" dojoAttachPoint\x3d\"_attachmentProgress\" indeterminate\x3d\"true\" style\x3d'display:none'\x3e\x3c/div\x3e\r\n        \x3cbr /\x3e        \r\n        \x3cform dojoAttachPoint\x3d'_uploadForm'\x3e ${NLS_add}:\x26nbsp;\x26nbsp;\x3cinput type\x3d'file' name\x3d'attachment' dojoAttachPoint\x3d'_uploadField' /\x3e \x3c/form\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e",
"url:dijit/templates/Calendar.html":'\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" class\x3d"dijitCalendarContainer" role\x3d"grid" aria-labelledby\x3d"${id}_mddb ${id}_year" data-dojo-attach-point\x3d"gridNode"\x3e\r\n\t\x3cthead\x3e\r\n\t\t\x3ctr class\x3d"dijitReset dijitCalendarMonthContainer" valign\x3d"top"\x3e\r\n\t\t\t\x3cth class\x3d\'dijitReset dijitCalendarArrow\' data-dojo-attach-point\x3d"decrementMonth" scope\x3d"col"\x3e\r\n\t\t\t\t\x3cspan class\x3d"dijitInline dijitCalendarIncrementControl dijitCalendarDecrease" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan data-dojo-attach-point\x3d"decreaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e-\x3c/span\x3e\r\n\t\t\t\x3c/th\x3e\r\n\t\t\t\x3cth class\x3d\'dijitReset\' colspan\x3d"5" scope\x3d"col"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"monthNode"\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/th\x3e\r\n\t\t\t\x3cth class\x3d\'dijitReset dijitCalendarArrow\' scope\x3d"col" data-dojo-attach-point\x3d"incrementMonth"\x3e\r\n\t\t\t\t\x3cspan class\x3d"dijitInline dijitCalendarIncrementControl dijitCalendarIncrease" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan data-dojo-attach-point\x3d"increaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e+\x3c/span\x3e\r\n\t\t\t\x3c/th\x3e\r\n\t\t\x3c/tr\x3e\r\n\t\t\x3ctr role\x3d"row"\x3e\r\n\t\t\t${!dayCellsHtml}\r\n\t\t\x3c/tr\x3e\r\n\t\x3c/thead\x3e\r\n\t\x3ctbody data-dojo-attach-point\x3d"dateRowsNode" data-dojo-attach-event\x3d"ondijitclick: _onDayClick" class\x3d"dijitReset dijitCalendarBodyContainer"\x3e\r\n\t\t\t${!dateRowsHtml}\r\n\t\x3c/tbody\x3e\r\n\t\x3ctfoot class\x3d"dijitReset dijitCalendarYearContainer"\x3e\r\n\t\t\x3ctr\x3e\r\n\t\t\t\x3ctd class\x3d\'dijitReset\' valign\x3d"top" colspan\x3d"7" role\x3d"presentation"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"dijitCalendarYearLabel"\x3e\r\n\t\t\t\t\t\x3cspan data-dojo-attach-point\x3d"previousYearLabelNode" class\x3d"dijitInline dijitCalendarPreviousYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\t\t\t\x3cspan data-dojo-attach-point\x3d"currentYearLabelNode" class\x3d"dijitInline dijitCalendarSelectedYear" role\x3d"button" id\x3d"${id}_year"\x3e\x3c/span\x3e\r\n\t\t\t\t\t\x3cspan data-dojo-attach-point\x3d"nextYearLabelNode" class\x3d"dijitInline dijitCalendarNextYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/td\x3e\r\n\t\t\x3c/tr\x3e\r\n\t\x3c/tfoot\x3e\r\n\x3c/table\x3e\r\n',
"url:esri/dijit/templates/AttributeInspector.html":'\x3cdiv class\x3d"esriAttributeInspector"\x3e\r\n    \x3cdiv class\x3d"atiLayerName" dojoAttachPoint\x3d"layerName"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"atiAttributes" dojoAttachPoint\x3d"attributeTable"\x3e\x3c/div\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"attachmentEditor"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"atiEditorTrackingInfo" dojoAttachPoint\x3d"editorTrackingInfoDiv"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"atiButtons" dojoAttachPoint\x3d"editButtons"\x3e\r\n        \x3cbutton  dojoType\x3d"dijit.form.Button" class\x3d"atiButton atiDeleteButton"  dojoAttachPoint\x3d"deleteBtn" dojoAttachEvent\x3d"onClick: onDeleteBtn" showLabel\x3d"true" type\x3d"button"\x3e${NLS_deleteFeature}\x3c/button\x3e\r\n        \x3cdiv class\x3d"atiNavButtons" dojoAttachPoint\x3d"navButtons"\x3e\r\n            \x3cdiv class\x3d"atiNavMessage" dojoAttachPoint\x3d"navMessage"\x3e\x3c/div\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiFirstIcon" dojoAttachPoint\x3d"firstFeatureButton" dojoAttachEvent\x3d"onClick: onFirstFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_first}\x3c/button\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiPrevIcon" dojoAttachPoint\x3d"prevFeatureButton" dojoAttachEvent\x3d"onClick: onPreviousFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_previous}\x3c/button\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiNextIcon" dojoAttachPoint\x3d"nextFeatureButton" dojoAttachEvent\x3d"onClick: onNextFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_next}\x3c/button\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiLastIcon" dojoAttachPoint\x3d"lastFeatureButton" dojoAttachEvent\x3d"onClick: onLastFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_last}\x3c/button\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/SituationAwareness/Widget.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"panelBottom" class\x3d"panelBottom"\x3e\r\n    \x3c!--Panel Container --\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"panelContainer" class\x3d"panelContainer"\x3e\r\n      \x3c!-- Panel Incident --\x3e\r\n      \x3cdiv id\x3d"SA_tabPanel0" class\x3d"SAT_tabPanel"\x3e\r\n        \x3cdiv class\x3d"SAT_tabPanelContent" style\x3d"width: 660px"\x3e\r\n            \x3cdiv id\x3d"SA_incidentsLocate" data-dojo-attach-point\x3d"incidentsLocate" class\x3d"SATcol"\x3e\r\n                \x3cdiv class\x3d"label"\x3e\r\n                    ${nls.locate_incident}\r\n                \x3c/div\x3e\r\n                \x3cbr/\x3e\r\n                \x3cdiv class\x3d"colBar"\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"imgContainer"\x3e\r\n                        \x3cspan class\x3d"btn32"\x3e \x3cimg id\x3d"SA_btn0"\x3e \x3c/img\x3e \x3c/span\x3e\r\n                        \x3cspan class\x3d"btn32"\x3e \x3cimg id\x3d"SA_btn1"\x3e \x3c/img\x3e \x3c/span\x3e\r\n                        \x3cspan class\x3d"btn32"\x3e \x3cimg id\x3d"SA_btn2"\x3e \x3c/img\x3e \x3c/span\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cspan class\x3d"btn32 btnClear" data-dojo-attach-event\x3d"onclick:_clear"\x3e \x3cimg id\x3d"SA_btn3"\x3e \x3c/img\x3e \x3c/span\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3cdiv id\x3d"SA_incidentsDistance" class\x3d"SATcol"\x3e\r\n            \x3cdiv class\x3d"label" data-dojo-attach-point\x3d"buffer_lbl"\x3e\x3c/div\x3e\r\n            \x3cbr/\x3e\r\n            \x3cdiv class\x3d"colBar"\x3e\r\n              \x3cdiv id\x3d"SA_horizontalSliderDiv" data-dojo-attach-point\x3d"horizontalSliderDiv"\x3e\x3c/div\x3e\r\n              \x3cdiv style\x3d"text-align:center; margin-top: -4px;"\x3e\r\n                \x3cinput data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width:60px;align:left;" data-dojo-attach-point\x3d"sliderValue" name\x3d"sliderValue" value\x3d"15" /\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"div_reverse_geocoding" class\x3d"SATcol" style\x3d"visibility:hidden"\x3e\r\n            \x3cdiv class\x3d"label"\x3e\r\n              ${nls.reverse_geocoded_address}\r\n            \x3c/div\x3e\r\n            \x3c/br\x3e\r\n            \x3cdiv class\x3d"label" style\x3d"width:100%;" data-dojo-attach-point\x3d"div_reversed_address"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Panel Message --\x3e\r\n    \x3cdiv id\x3d"SA_panelMessage" data-dojo-attach-point\x3d"messageNode"\x3e\r\n      \x3cspan id\x3d"SA_msgText" data-dojo-attach-point\x3d"messageTextNode"\x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Panel Footer --\x3e\r\n    \x3cdiv id\x3d"SA_panelFooter" data-dojo-attach-point\x3d"footerNode"\x3e\r\n      \x3cdiv id\x3d"SA_panelFooterContent" data-dojo-attach-point\x3d"footerContentNode"\x3e\r\n        \x3c!-- Tabs --\x3e\r\n        \x3cdiv id\x3d"SA_SAT_tabs" data-dojo-attach-point\x3d"tabsNode"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"SA_panelClose" data-dojo-attach-event\x3d"onclick:_close"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/SituationAwareness/css/style.css":".jimu-widget-SAT {color: #ffffff !important; background-color: #4c4c4c; left: 0px !important; right: 0px !important; bottom: 0px; height: 140px !important; display: block; z-index: 100 !important;}.jimu-widget-SAT .rounded {-moz-border-radius: 5px 5px 5px 5px; -webkit-border-radius: 5px 5px 5px 5px; border-radius: 5px 5px 5px 5px;}.jimu-widget-SAT .roundedL {-moz-border-radius: 5px 0px 0px 5px; -webkit-border-radius: 5px 0px 0px 5px; border-radius: 5px 0px 0px 5px;}.jimu-widget-SAT .roundedR {-moz-border-radius: 0px 5px 5px 0px; -webkit-border-radius: 0px 5px 5px 0px; border-radius: 0px 5px 5px 0px;}.jimu-widget-SAT .panelBottom {position: absolute; width: 100%; height: 140px; left: 0px; top: 0px; text-align: center; color: #ffffff; padding: 0px;}.jimu-widget-SAT #SA_panelMessage {position: absolute; top: 0px; text-align: center; width: 100%; height: 40px; line-height: 40px; display: none;}.jimu-widget-SAT #SA_panelFooter {position: absolute; bottom: 0px; left: 0px; right: 0px; height: 40px; line-height: 40px; overflow: hidden; background-color: #393939; background-color: rgba(0, 0, 0, 0.25); border-bottom: 1px solid #353535; border-bottom: 1px solid rgba(0, 0, 0, 0.3);}.jimu-widget-SAT #SA_panelFooterContent {position: absolute; left: 0px; right: 24px; height: 90px; overflow-x: auto; overflow-y: hidden; display: block;}.jimu-rtl .jimu-widget-SAT #SA_panelFooterContent {position: absolute; left: 24px; right: 0px;}.jimu-widget-SAT #SA_panelClose {position: absolute; left: auto; right: 0px; width: 24px; height: 40px; line-height: 40px; text-align: center; display: block; cursor: pointer; background-image: url('images/x.png'); background-repeat: no-repeat; background-position: center center; background-size: 18px;}.jimu-rtl .jimu-widget-SAT #SA_panelClose {position: absolute; left: 0px; right: auto;}.jimu-widget-SAT .panelContainer {position: absolute; width: 100%; height: 100px; overflow: hidden; display: block;}.jimu-widget-SAT .SAT_tabPanel {position: absolute; top: 10px; left: 0px; right: 0px; height: 90px; display: none; overflow-x: auto !important; overflow-y: hidden !important;}.jimu-widget-SAT .SAT_tabPanelContent {position: absolute; top: 0px; width: auto; height: 80px; white-space: nowrap; display: block; overflow-x: visible; overflow-y: hidden;}.jimu-widget-SAT #SA_SAT_tabs {position: absolute; white-space: nowrap; height: 40px; padding: 0px; overflow-x: visible; overflow-y: hidden;}.jimu-widget-SAT .SATTab {width: auto; max-width: 220px; overflow: hidden; text-overflow: ellipsis; height: 40px; float: left; line-height: 40px; font-size: 13px; padding: 0 35px 0 10px; background-image: url('images/tab.png'); background-repeat: no-repeat; background-position: right center; cursor: pointer;}.jimu-rtl .jimu-widget-SAT .SATTab {float: right;}.jimu-widget-SAT .active {color: #ffffff; background-color: #353535; background-color: rgba(0, 0, 0, 0.3); background-image: url('images/tabon.png'); background-position: right center; background-repeat: no-repeat;}.jimu-widget-SAT .SATcol {float: left; height: 80px; width: 220px; border-left: none; border-right: 1px solid #ffffff; border-right: 1px solid rgba(255, 255, 255, 0.5); margin-left: 0; padding: 0 20px; overflow: hidden;}.jimu-widget-SAT .SATcolSave {float: left; height: 80px; width: 220px; border-left: none; border-right: 1px solid #ffffff; border-right: 1px solid rgba(255, 255, 255, 0.5); margin-left: 0; padding: 0 5px; overflow: hidden;}.jimu-rtl .jimu-widget-SAT .SATcol {float: right; border-left: 1px solid #ffffff; border-left: 1px solid rgba(255, 255, 255, 0.5); border-right: none;}.jimu-widget-SAT .SATcolSmall {float: left; height: 80px; width: 165px; border-left: none; border-right: 1px solid #ffffff; border-right: 1px solid rgba(255, 255, 255, 0.5); margin-left: 0; padding: 0 20px; overflow: hidden; text-overflow: ellipsis;}.jimu-rtl .jimu-widget-SAT .SATcolSmall {float: right; border-left: 1px solid #ffffff; border-left: 1px solid rgba(255, 255, 255, 0.5); border-right: none;}.jimu-widget-SAT .SATcolLast {border-left: none; border-right: none;}.jimu-widget-SAT .SATcol .label,.jimu-widget-SAT .SATcolSmall .label {font-size: 13px; padding: 2px 0;}.jimu-widget-SAT .SATcol .colBar {position: relative; height: 32px; display: block;}.jimu-widget-SAT .SATcolSave .colBar {position: relative; height: 69px; display: block;}.jimu-widget-SAT .btn32 {float: left; width: 32px; height: 32px; padding: 0; color: #ffffff; background-color: #393939; background-color: rgba(0, 0, 0, 0.25); border-radius: 2px; display: block; margin-right: 8px; cursor: pointer;}.jimu-widget-SAT .btn32Save {float: left; width: 32px; height: 32px; padding: 0; color: #ffffff; background-color: #393939; background-color: rgba(0, 0, 0, 0.25); border-radius: 2px; display: block; margin-right: 6px; cursor: pointer;}.jimu-widget-SAT .btn32SaveDisabled {float: left; width: 32px; height: 32px; padding: 0; color: #999999; background-color: #999999; border-radius: 2px; display: block; margin-right: 6px; cursor:default;}.jimu-rtl .jimu-widget-SAT .btn32 {float: right;}.jimu-rtl .jimu-widget-SAT .btn32Save {float: right;}.jimu-widget-SAT .btn32:hover {background-color: #262626; background-color: rgba(0, 0, 0, 0.5);}.jimu-widget-SAT .btn32Save:hover {background-color: #262626; background-color: rgba(0, 0, 0, 0.5);}.jimu-widget-SAT .btnOn {border: 1px solid #ffffff; border: 1px solid rgba(255, 255, 255, 0.75); background-color: #262626; background-color: rgba(0, 0, 0, 0.5);}.jimu-widget-SAT .btn32 img {padding: 8px;}.jimu-widget-SAT .btn32Save img {padding: 8px;}.jimu-widget-SAT .btn32SaveDisabled img {padding: 8px;}.jimu-widget-SAT .btnClear {background-color: #bb0000; margin-left: 16px;}.jimu-rtl .jimu-widget-SAT .btnClear {margin-right: 16px; margin-left: 0;}.jimu-widget-SAT .btnClear:hover {background-color: #ff0000;}.jimu-widget-SAT .dijitTextBox,.jimu-widget-SAT .dijitTextBoxHover,.jimu-widget-SAT .dijitTextBoxFocused,.jimu-widget-SAT .dijitTextBoxHoverFocused {background-color: #393939; background-color: rgba(0, 0, 0, 0.25) !important; color: #ffffff !important; border: 1px solid #a6a6a6; border: 1px solid rgba(255, 255, 255, 0.5) !important; height: 26px !important; line-height: 26px !important;}.jimu-widget-SAT .dijitTextBoxFocused,.jimu-widget-SAT .dijitInputInner,.jimu-widget-SAT .dijitInputContainer {background: transparent !important; color: #ffffff !important; height: 26px !important; line-height: 26px !important;}.jimu-widget-SAT .dijitInputField {padding: 0px 10px !important;}.jimu-widget-SAT .btnExport {background-color: #393939; background-color: rgba(0, 0, 0, 0.25); border-radius: 2px; padding: 10px 44px 10px 10px; background-image: url('images/download.png'); background-repeat: no-repeat; background-position: right center; cursor: pointer;}.jimu-widget-SAT .btnExport:hover {background-color: #262626; background-color: rgba(0, 0, 0, 0.5);}.jimu-widget-SAT .download {background-image: url('images/download.png'); background-repeat: no-repeat; background-position: right 0px center;}.jimu-widget-SAT .processing {background-image: url('images/processing.gif'); background-repeat: no-repeat; background-position: right 10px center;}.jimu-widget-SAT .loading {background-image: url('images/loading.gif'); background-repeat: no-repeat; background-position: center 10px;}.jimu-widget-SAT .colSummary {height: 36px; line-height: 36px; font-size: 28px; padding-top: 25px;}.jimu-widget-SAT .SATcolRec {float: left; height: 80px; width: 220px; border-left: none; border-right: 1px solid #ffffff; border-right: 1px solid rgba(255, 255, 255, 0.5); margin-left: 0; padding: 0 20px; overflow: hidden; text-align: left; text-overflow: ellipsis;}.jimu-rtl .jimu-widget-SAT .SATcolRec {float: right; border-left: 1px solid #ffffff; border-left: 1px solid rgba(255, 255, 255, 0.5); border-right: none; text-align: right;}.jimu-widget-SAT .SATcolRecBar {position: relative; height: 26px; width: 100%; display: block;}.jimu-widget-SAT .SATcolRecNum {position: absolute; width: 26px; height: 26px; background-color: #4c4c4c; color: #ffffff; line-height: 26px; text-align: center; border-radius: 13px; font-size: 11px; cursor: pointer;}.jimu-widget-SAT .SATcolDir {position: absolute; right: 0px; width: 26px; height: 26px; background-image: url('images/car.png'); background-repeat: no-repeat; background-position: center center; cursor: pointer;}.jimu-rtl .jimu-widget-SAT .SATcolDir {position: absolute; left: 0px; right: auto;}.jimu-widget-SAT .SATcolDistance {position: absolute; left: 30px; right: 30px; height: 26px; font-size: 11px; line-height: 26px;}.jimu-widget-SAT .SATcolInfo {position: relative; margin-top: 10px; height: 64px; width: 100%; display: block; overflow: hidden;}.claro .dijitSlider {background: transparent; border: 0 none; -webkit-border-radius: 3px; border-radius: 3px; padding: 0;}.claro .dijitSliderBar {border-style: solid; outline: 1px;}.claro .dijitRuleLabelsContainer {color: #2b2e34;}.claro .dijitSliderDisabled {opacity: 0.65; -ms-filter: \"progid:DXImageTransform.Microsoft.Alpha(Opacity\x3d65)\"; filter: alpha(opacity\x3d65);}.claro .dijitRuleLabelsContainerH {padding: 8px 0 !important; color: #6e6e6e !important;}.claro .dijitSliderBarH,.claro .dijitSliderBumperH {height: 4px;}.claro .dijitSlider .dijitSliderLeftBumper {-webkit-border-radius: 2px 0 0 2px; border-radius: 2px 0 0 2px; border-width: 1px 0 1px 1px; margin-left: 4px;}.claro .dijitSlider .dijitSliderRightBumper {-webkit-border-radius: 0 2px 2px 0; border-radius: 0 2px 2px 0; border-width: 1px 1px 1px 0; margin-left: -2px; margin-right: 4px;}.claro .dijitSlider .dijitSliderProgressBarH {border-color: #ebebeb; background-color: #ebebeb; background-image: none; -webkit-box-shadow: none; box-shadow: none;}.claro .dijitSlider .dijitSliderLeftBumper {border-color: #ebebeb; background-color: #ebebeb; background-image: none; -webkit-box-shadow: none; box-shadow: none; -webkit-border-radius: 2px 0 0 2px; border-radius: 2px 0 0 2px;}.claro .dijitSlider .dijitSliderRemainingBarH,.claro .dijitSlider .dijitSliderRightBumper {border-color: #878787; background-color: #878787; -webkit-border-radius: 2px; border-radius: 2px;}.claro .dijitSliderHover .dijitSliderProgressBarH,.claro .dijitSliderHover .dijitSliderLeftBumper {border-color: #ebebeb; background-color: #ebebeb; background-image: none; -webkit-box-shadow: none; box-shadow: none;}.claro .dijitSliderFocused .dijitSliderProgressBarH,.claro .dijitSliderFocused .dijitSliderLeftBumper {border-color: #ebebeb;}.claro .dijitSliderFocused .dijitSliderRemainingBarH,.claro .dijitSliderFocused .dijitSliderRightBumper {border-color: #878787; background-color: #878787; -webkit-box-shadow: none; box-shadow: none;}.claro .dijitSliderImageHandle {background: #ffffff; -webkit-border-radius: 50%; border-radius: 50%; border: 0 none; width: 16px; height: 16px; margin-top: -2px; position: absolute;}.claro .dijitSliderImageHandle:after {content: \"\"; display: block; background: #6e6e6e; -webkit-border-radius: 50%; border-radius: 50%; height: 8px; width: 8px; left: 4px; top: 4px; position: absolute;}.claro .dijitSliderDisabled.dijitSliderFocused .dijitSliderImageHandle:after {display: none; outline: none;}.claro .dijitSliderDecrementIconH,.claro .dijitSliderIncrementIconH {padding: 0; height: 20px; width: 20px; background-color: transparent; border: 0 none;}.SAT_tabPanel::-webkit-scrollbar {width: 6px; height: 6px; background-color: rgba(0, 0, 0, 0.1);}.SAT_tabPanel::-webkit-scrollbar-thumb {background-color: rgba(0, 0, 0, 0.4);}.SAT_tabPanel {scrollbar-base-color: #4c4c4c; scrollbar-3dlight-color: #4c4c4c; scrollbar-highlight-color: #4c4c4c; scrollbar-track-color: #444444; scrollbar-arrow-color: #2e2e2e; scrollbar-shadow-color: #4c4c4c; scrollbar-dark-shadow-color: #4c4c4c; scrollbar-face-color: #2e2e2e;}.esriAttributeInspector .atiRichTextField{}.esriAttributeInspector div.dijitEditorIFrameContainer {height: 78px; width: 100%;}.esriAttributeInspector .dijitTextBox.dijitTextArea {height: 32px;}.esriAttributeInspector .atiButton {background-repeat: no-repeat; height:30px; width:60px; background-image:none; padding:2px;}.esriAttributeInspector .atiButtons {height:30px; width:100%; display:inline-block; width:100%;}.esriAttributeInspector {display:inline-block;} .esriAttributeInspector .dijitArrowButtonContainer {margin-top:0px; margin-right:0px; margin-bottom:0px; width:18px;}.esriAttributeInspector .atiNavButtons {display:none; visibility:hidden; height: 0px;}.esriPopup .spinner {display: none;}",
"url:widgets/SituationAwareness/config.json":'{\r\n  "comment": "Do not change lyr_types unless you have the widget JS code to support them",\r\n  "geometryService": {\r\n    "url": "http://tasks.arcgisonline.com/ArcGIS/rest/services/Geometry/GeometryServer"\r\n  },\r\n  "geocodeService": {\r\n    "url": "https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer"\r\n  },\r\n  "routeService": {\r\n    "url": "http://sampleserver3.arcgisonline.com/ArcGIS/rest/services/Network/USA/NAServer/Route",\r\n    "comment": "https://route.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World"\r\n  },\r\n  "enableRouting": true,\r\n  "special_layer": {\r\n    "label": "Weather",\r\n    "value": "weather",\r\n    "url": "http://api.worldweatheronline.com/free/v1/weather.ashx?format\x3djson\x26num_of_days\x3d3\x26extra\x3dlocalObsTime\x26key\x3d63hkyhwzpks3a3kj9k9jdfeg",\r\n    "external_lyr": {\r\n      "label": "Weather observation web service",\r\n      "url": "http://api.worldweatheronline.com/free/v1/weather.ashx?format\x3djson\x26num_of_days\x3d3\x26extra\x3dlocalObsTime\x26key\x3d63hkyhwzpks3a3kj9k9jdfeg"\r\n    }\r\n  },\r\n  "bufferLabel": "Buffer Distance",\r\n  "bufferRange": {\r\n    "minimum": 0,\r\n    "maximum": 100\r\n  },\r\n  "distanceUnits": "miles",\r\n  "distanceSettings": {\r\n    "miles": 9035,\r\n    "kilometers": 9036,\r\n    "feet": 9002,\r\n    "meters": 9001,\r\n    "yards": 9037,\r\n    "nauticalMiles": 9030\r\n  },\r\n  "maxDistance": "80",\r\n  "defaultZoomLevel": 13,\r\n  "tabs": [{\r\n      "label": "Weather",\r\n      "type": "weather",\r\n      "layers": "",\r\n      "url": "http://api.worldweatheronline.com/free/v1/weather.ashx?format\x3djson\x26num_of_days\x3d3\x26extra\x3dlocalObsTime\x26key\x3d63hkyhwzpks3a3kj9k9jdfeg"\r\n    }],\r\n  "csvAllFields": "true",\r\n  "summaryDisplayEnabled": "true"\r\n}\r\n',
"*now":function(t){t(['dojo/i18n!*preload*widgets/SituationAwareness/nls/Widget*["ar","cs","da","de","en","el","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dijit/_WidgetsInTemplateMixin dijit/form/Button jimu/BaseWidget jimu/dijit/Message jimu/utils jimu/LayerInfos/LayerInfos dojo/_base/Color dojo/_base/html dojo/dom dojo/on dojo/dom-style dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/_base/lang dojo/_base/array dojo/_base/xhr dojo/query dojo/json dijit/form/HorizontalSlider dijit/form/HorizontalRuleLabels esri/geometry/Extent esri/geometry/geometryEngine esri/geometry/Polygon esri/geometry/Point esri/geometry/Multipoint esri/geometry/Polyline esri/geometry/webMercatorUtils esri/graphic esri/layers/GraphicsLayer esri/layers/FeatureLayer esri/symbols/Font esri/symbols/SimpleLineSymbol esri/symbols/SimpleFillSymbol esri/symbols/SimpleMarkerSymbol esri/symbols/TextSymbol esri/tasks/locator esri/tasks/BufferParameters esri/tasks/GeometryService esri/toolbars/draw esri/domUtils esri/dijit/AttributeInspector esri/dijit/Popup esri/tasks/query ./js/SummaryInfo ./js/WeatherInfo ./js/ClosestInfo ./js/ProximityInfo dojo/keys dojo/domReady!".split(" "),function(t,
k,q,s,f,d,a,c,e,l,g,x,r,z,m,n,b,v,u,p,y,B,F,I,D,A,E,G,C,h,w,H,O,K,L,N,P,Q,S,R,M,J,T,$,U,V,W,X,Z,Y){return t([s,k],{baseClass:"jimu-widget-SAT",name:"IncidentAnalysis",opLayers:null,curTab:0,lyrBuffer:null,lyrIncidents:null,lyrClosest:null,lyrProximity:null,lyrSummary:null,lyrEdit:null,toolbar:null,tool:-1,symPoint:null,symLine:null,symPoly:null,symBuffer:null,symRoute:null,incident:null,buffer:null,gsvc:null,locator:null,stops:[],initalLayerVisibility:{},updateFeature:null,Incident_Local_Storage_Key:"SAT_Incident",
SLIDER_MAX_VALUE:1E4,postCreate:function(){this.inherited(arguments)},startup:function(){this.inherited(arguments);this.editTemplate=this.config.editTemplate;this.saveEnabled=this.config.saveEnabled;this.summaryDisplayEnabled=this.config.summaryDisplayEnabled;this._getStyleColor();this._createUI();this._loadUI();this._initLayers();this._verifyRouting();this.config.enableRouting&&(this.config.enableRouting=!1,b.forEach(this.appConfig.widgetPool.widgets,n.hitch(this,function(a){"Directions"===a.name&&
(this.config.enableRouting=!0)})));this.SLIDER_MAX_VALUE=this.config.bufferRange.maximum;this.opLayers=this.map.itemInfo.itemData.operationalLayers;this._mapLoaded();this._restoreIncidents()},onOpen:function(){this.inherited(arguments);this.map.infoWindow.isShowing&&this.map.infoWindow.hide();this._storeInitalVisibility();this._initEditInfo();this._addActionLink();this._clickTab(0)},onClose:function(){this._clear();this._toggleTabLayersOld();this._resetInitalVisibility();this._resetInfoWindow();this.inherited(arguments)},
onDeActive:function(){this._clickIncidentsButton(-1)},destroy:function(){this._clear();this._toggleTabLayersOld();this.lyrBuffer&&this.map.removeLayer(this.lyrBuffer);this.lyrIncidents&&this.map.removeLayer(this.lyrIncidents);this.lyrClosest&&this.map.removeLayer(this.lyrClosest);this.lyrProximity&&this.map.removeLayer(this.lyrProximity);this.lyrSummary&&this.map.removeLayer(this.lyrSummary);this.inherited(arguments)},onAppConfigChanged:function(a,b,c){switch(b){case "styleChange":this._updateUI(c);
break;case "widgetPoolChange":this._verifyRouting()}},_addActionLink:function(){var a=this.nls.actionLabel,b=u(".actionList",this.map.infoWindow.domNode);0<b.length&&(a=0>b[0].innerHTML.indexOf(a)?z.create("a",{"class":"action",id:"SA_actionLink",innerHTML:a,href:"javascript: void(0);"},b[0]):l.byId("SA_actionLink"),this.own(g(a,"click",n.hitch(this,this._setEventLocation))))},_updateUI:function(a){this._getStyleColor(a)},_getStyleColor:function(a){var b=this.appConfig.theme.name,c=this.appConfig.theme.styles[0];
a&&(c=a);v.get({url:"./themes/"+b+"/manifest.json",handleAs:"json",load:n.hitch(this,function(a){a=a.styles;for(var b=0;b<a.length;b++){var d=a[b];d.name===c&&(x.set(this.footerNode,"background-color",d.styleColor),this.config.color=d.styleColor,this._setupSymbols(),this._bufferIncident())}})})},setPosition:function(a,b){if("BoxTheme"===this.appConfig.theme.name||"DartTheme"===this.appConfig.theme.name||"LaunchpadTheme"===this.appConfig.theme.name)this.inherited(arguments);else{this.position={left:"0px",
right:"0px",bottom:"0px",height:"140px"};var c=d.getPositionStyle(this.position);c.position="absolute";b=this.map.id;e.place(this.domNode,b);e.setStyle(this.domNode,c);this.started&&this.resize();"TabTheme"===this.appConfig.theme.name&&(c=this.widgetManager.getControllerWidgets()[0],this.widgetManager.minimizeWidget(c.id))}},disableWebMapPopup:function(){this.map&&this.map.setInfoWindowOnClick(!1)},enableWebMapPopup:function(){this.map&&this.map.setInfoWindowOnClick(!0)},_setEventLocation:function(){this.lyrIncidents.clear();
this.lyrBuffer.clear();var a={eventType:"IncidentLocation",dataValue:this.map.infoWindow.getSelectedFeature()};this.onReceiveData("","",a);this.map.infoWindow.isShowing&&this.map.infoWindow.hide()},_initLayers:function(){this.gsvc=new R(this.config.geometryService.url);this.locator=new Q(this.config.geocodeService.url);this.own(g(this.locator,"location-to-address-complete",n.hitch(this,this._showIncidentAddress)));this.own(g(this.locator,"error",n.hitch(this,this._onAddressError)));this.lyrBuffer=
new w;this.map.addLayer(this.lyrBuffer);this.lyrIncidents=new w;this.map.addLayer(this.lyrIncidents);this.lyrClosest=new w;this.lyrClosest.setVisibility(!1);this.map.addLayer(this.lyrClosest);this.lyrProximity=new w;this.lyrProximity.setVisibility(!1);this.map.addLayer(this.lyrProximity);this.summaryDisplayEnabled&&(this.lyrSummary=new w,this.lyrSummary.setVisibility(!1),this.map.addLayer(this.lyrSummary))},_mapLoaded:function(){u("[data-reference]").style("z-index",0);this.map.itemId&&a.getInstance(this.map,
this.map.itemInfo).then(n.hitch(this,function(a){this.opLayers=a;this._processOperationalLayers();this.saveEnabled&&(this.lyrEdit=this.opLayers.getLayerInfoById(this.config.editLayer).layerObject,this.own(g(this.map.infoWindow,"selection-change",n.hitch(this,this._selectionChanged))),this.own(g(this.map.infoWindow,"set-features",n.hitch(this,this._setPopupFeature))),a=u(".esriPopupWrapper",this.map.infoWindow.domNode),0<a.length&&("undefined"!==typeof a[0].clientHeight&&"undefined"!==typeof a[0].clientWidth)&&
(this.defaultPopupSize={width:a[0].clientWidth,height:a[0].clientHeight}),this.map.infoWindow.highlight=!0,this.own(g(this.lyrEdit,"click",n.hitch(this,function(a){a.graphic&&(this.updateFeature=a.graphic,this._updatePopup(this.updateFeature))}))),this.defaultEditWindowContentJson=p.stringify(this.lyrEdit.infoTemplate),this.editLayerPrototype=this.editTemplate.prototype)}));this._clickTab(0)},_initEditInfo:function(){this.saveEnabled&&this.lyrEdit&&(this.map.infoWindow.resize(350,340),this.lyrEdit.infoTemplate.setContent(n.hitch(this,
this._setEditLayerPopup)))},_setPopupFeature:function(){this.updateFeature=this.map.infoWindow.getSelectedFeature()},_selectionChanged:function(){(this.updateFeature=this.map.infoWindow.getSelectedFeature())&&this._updatePopup(this.updateFeature)},_setEditLayerPopup:function(a){for(var b=[],c=this._getPopupFields(this.lyrEdit),d=0;d<c.length;d++){var e=c[d];e.isEditable&&e.isEditableOnLayer&&b.push({fieldName:e.fieldName,isEditable:e.isEditable})}this.attInspector=new T({layerInfos:[{featureLayer:this.lyrEdit,
showAttachments:!1,isEditable:!0,fieldInfos:b}]},z.create("div"));b=new q({label:"Update"},z.create("div"));z.place(b.domNode,this.attInspector.deleteBtn.domNode,"before");this.own(g(b,"click",n.hitch(this,function(){this.lyrEdit.applyEdits(null,[this.updateFeature],null,n.hitch(this,function(){new f({message:this.nls.updateComplete})}),function(a){var b="Error";"undefined"!==typeof a.details&&(b=a.details);"undefined"!==typeof a.message&&(b=a.message);new f({message:b})})})));this.own(g(this.attInspector,
"attribute-change",n.hitch(this,function(a){this.updateFeature=a.feature;this.updateFeature.attributes[a.fieldName]=a.fieldValue})));this.own(g(this.attInspector,"next",n.hitch(this,function(a){this.updateFeature=a.feature})));this.own(g(this.attInspector,"delete",n.hitch(this,function(a){var b=!1;this.incident&&(I.equals(a.feature.geometry,this.incident.geometry)&&(b=!0),!b&&0<this.lyrBuffer.graphics.length&&I.equals(a.feature.geometry,this.lyrBuffer.graphics[0].geometry)&&(b=!0));this.lyrEdit.applyEdits(null,
null,[a.feature],n.hitch(this,function(){new f({message:this.nls.deleteComplete})}),function(a){var b="Error";"undefined"!==typeof a.details&&(b=a.details);"undefined"!==typeof a.message&&(b=a.message);new f({message:b})});this.updateFeature=this.editLayerPrototype;b&&this._clear();this.map.infoWindow.hide()})));this.updateFeature&&(!this.updateFeature.hasOwnProperty("_graphicsLayer")&&a&&a.hasOwnProperty("_graphicsLayer")&&(this.updateFeature=a),this.attInspector.showFeature(this.updateFeature));
return this.attInspector.domNode},_getPopupFields:function(a){var b;if(a.infoTemplate)b=a.infoTemplate.info.fieldInfos;else if(-1<this.tab.tabLayers[0].url.indexOf("MapServer")){var c=this.tab.tabLayers[0].url.split("MapServer/")[1],d=this.parent.map.itemInfo.itemData.operationalLayers;b=null;for(var e=0;e<d.length;e++){var f=d[e];if(f.layerObject.infoTemplates&&(f=f.layerObject.infoTemplates[c])){b=f.infoTemplate.info.fieldInfos;break}}}else b=a.fields;b||(b=a.fields);return b},_updatePopup:function(a){if("undefined"!==
typeof a){var b=new U;a.hasOwnProperty("attributes")?b.objectIds=[a.attributes[a.getLayer().objectIdField]]:b.objectIds=[a];this.lyrEdit.selectFeatures(b,H.SELECTION_NEW,n.hitch(this,function(a){0<a.length&&(this.updateFeature=a[0],this.attInspector||this._setEditLayerPopup(this.updateFeature),this.attInspector&&this.attInspector.showFeature(this.updateFeature))}))}},_processOperationalLayers:function(){for(var a=0;a<this.config.tabs.length;a++){var b=this.config.tabs[a];b.layers&&""!==b.layers&&
(b.tabLayers=this._getTabLayers(b.layers))}},_createUI:function(){var a=this.config.distanceUnits,b=d.sanitizeHTML(this.config.bufferLabel?this.config.bufferLabel:""),b=b+(" ("+this.nls[a]+")");this.buffer_lbl.innerHTML=b;a=l.byId("SA_horizontalSliderDiv");b=document.createElement("div");a.appendChild(b);b=document.createElement("div");a.appendChild(b);var b=new B({container:"bottomDecoration",minimum:this.config.bufferRange.minimum,maximum:this.config.bufferRange.maximum,labels:[this.config.bufferRange.minimum,
this.config.bufferRange.maximum],style:"height:2em;font-size:75%;color:#fff"},b),c=Math.abs(Math.round(this.config.bufferRange.maximum-this.config.bufferRange.minimum))+1,e=this.config.bufferRange.minimum;e>this.config.bufferRange.maximum&&(e=this.config.bufferRange.minimum);this.horizontalSlider=new y({value:e,minimum:this.config.bufferRange.minimum,maximum:this.config.bufferRange.maximum,discreteValues:c,intermediateChanges:!1,showButtons:!1,style:"width:180px;"},a);this.own(g(this.horizontalSlider,
"change",n.hitch(this,this._sliderChange)));this.horizontalSlider.startup();b.startup();this.sliderValue.set("value",e);this.config.tabs.splice(0,0,{type:"incidents",label:"Incident",color:this.config.color});a=this.panelContainer;b=l.byId("SA_SAT_tabs");for(e=c=0;e<this.config.tabs.length;e++){var f=this.config.tabs[e],h=f.label;if(!h||""===h)h=f.layers;h=z.create("div",{id:"SA_tab"+e,innerHTML:d.sanitizeHTML(h?h:"")},b);r.add(h,"SATTab");c+=m.position(h).w;g(h,"click",n.hitch(this,this._clickTab,
e));0<e&&(h=z.create("div",{id:"SA_tabPanel"+e,innerHTML:this.nls.defaultTabMsg},a),r.add(h,"SAT_tabPanel"),"summary"===f.type&&(f.summaryInfo=new V(f,h,this)),"weather"===f.type&&(f.weatherInfo=new W(f,h,this)),"closest"===f.type&&(f.closestInfo=new X(f,h,this)),"proximity"===f.type&&(f.proximityInfo=new Z(f,h,this)))}x.set(b,"width",c+10+"px")},_loadUI:function(){var a={"0":this.nls.drawPoint,1:this.nls.drawLine,2:this.nls.drawPolygon,3:this.nls.clearIncident,4:this.nls.saveIncident},b=4;this.saveEnabled&&
(r.remove(this.incidentsLocate,"SATcol"),r.add(this.incidentsLocate,"SATcolSave"),b=5,this.saveSpan=z.create("span",{"class":"btn32SaveDisabled"},this.imgContainer),z.create("img",{id:"SA_btn4"},this.saveSpan));for(var c=0;c<b;c++){var d=l.byId("SA_btn"+c);this.saveEnabled&&(r.remove(d.parentNode,"btn32"),"btn4"!==d.id&&r.add(d.parentNode,"btn32Save"));e.setAttr(d,"src",this.folderUrl+"images/btn"+c+".png");e.setAttr(d,"title",a[c]);this.own(g(d,"click",n.hitch(this,this._clickIncidentsButton,c)))}this.toolbar=
new M(this.map,{tooltipOffset:20,drawTime:90});this.toolbar.on("draw-end",n.hitch(this,this._drawIncident));this.own(g(this.horizontalSlider,"change",n.hitch(this,this._sliderChange)));this.own(g(this.sliderValue,"keyup",n.hitch(this,function(a){a.keyCode===Y.ENTER?this._updateSliderValue():(a=this.sliderValue.get("value"),isNaN(a)?this.sliderValue.set("value",this.horizontalSlider.value):(a<this.config.bufferRange.minimum&&this.sliderValue.set("value",this.config.bufferRange.minimum),a>this.SLIDER_MAX_VALUE&&
this.sliderValue.set("value",this.SLIDER_MAX_VALUE)))})))},_locateBuffer:function(a){if(null!==a&&(a="extent"===a.type?a:a.geometry.getExtent(),null!==a)){a=a.expand(1.5);var b=80/this.map.height,c=a.getHeight();a.update(a.xmin,a.ymin-c*b,a.xmax,a.ymax-c*b,this.map.spatialReference);this.map.setExtent(a,!0)}},_clickIncidentsButton:function(a){var b,c=this.saveEnabled?5:4;if(a<c){for(var d=0;d<c;d++)b=l.byId("SA_btn"+d),r.remove(b,"btnOn");-1<a&&a!==this.tool?(b=l.byId("SA_btn"+a),a<c-1&&r.add(b,"btnOn"),
this.tool=a):this.tool=-1;switch(this.tool){case -1:this.toolbar.deactivate();this.enableWebMapPopup();break;case 0:this._clear();this.toolbar.activate(M.POINT);this.disableWebMapPopup();break;case 1:this._clear();this.toolbar.activate(M.POLYLINE);this.disableWebMapPopup();break;case 2:this._clear();this.toolbar.activate(M.POLYGON);this.disableWebMapPopup();break;case 4:this.incident&&this._saveIncident()}}else this._clear()},_saveIncident:function(){var a=[];1>this.lyrBuffer.graphics.length&&"polygon"!==
this.incident.geometry.type&&new f({message:this.nls.notPolySave});for(var b=0;b<this.lyrBuffer.graphics.length;b++){var c=this.lyrBuffer.graphics[b],d=new h;d.geometry=c.geometry;c=p.parse(p.stringify(this.editTemplate.prototype));d.setAttributes(c.attributes);a.push(d)}0<a.length&&this.lyrEdit.applyEdits(a,null,null,n.hitch(this,function(a){if(0<a.length&&a[0].success&&(a[0].hasOwnProperty("objectId")&&this._updatePopup(a[0].objectId),new f({message:this.nls.editComplete}),!this.map.infoWindow.isShowing&&
0<this.lyrBuffer.graphics.length)){a=this.lyrBuffer.graphics[0].geometry.getCentroid();var b=this.map.toScreen(a);this.map.emit("click",{bubbles:!0,cancelable:!0,screenPoint:b,mapPoint:a})}}),function(a){var b="Error";"undefined"!==typeof a.details&&(b=a.details);"undefined"!==typeof a.message&&(b=a.message);new f({message:b})});this._clickIncidentsButton(-1)},_clear:function(){this.map.graphics.clear();this.lyrIncidents.clear();this.lyrBuffer.clear();this.lyrProximity.clear();this.lyrClosest.clear();
this.summaryDisplayEnabled&&this.lyrSummary&&this.lyrSummary.clear();this.saveEnabled&&(r.remove(this.saveSpan,"btn32Save"),r.add(this.saveSpan,"btn32SaveDisabled"));this.buffer=this.incident=null;this.div_reversed_address.innerHTML="";e.setStyle(this.div_reverse_geocoding,"visibility","hidden");for(var a=1;a<this.config.tabs.length;a++)l.byId("SA_tabPanel"+a)&&(l.byId("SA_tabPanel"+a).innerHTML=this.nls.defaultTabMsg);this._clearGraphics();this.lyrEdit&&(this.updateFeature=this.editLayerPrototype)},
_sliderChange:function(){this.sliderValue.set("value",this.horizontalSlider.value);this._bufferIncident()},_sliderTextChange:function(){0>this.sliderValue.value||this.sliderValue.value>this.SLIDER_MAX_VALUE?this.sliderValue.set("value",this.horizontalSlider.value):this.horizontalSlider.set("value",this.sliderValue.value)},_updateSliderValue:function(){0>this.sliderValue.displayedValue||this.sliderValue.displayedValue>this.SLIDER_MAX_VALUE?this.sliderValue.set("value",this.horizontalSlider.value):
this.horizontalSlider.set("value",this.sliderValue.displayedValue)},_clickTab:function(a){this._toggleTabs(a);this._toggleTabLayers(a);this.curTab=a;this._clickIncidentsButton(-1)},_toggleTabs:function(a){for(var b=0;b<this.config.tabs.length;b++)b===a?(r.add("SA_tab"+b,"active"),x.set("SA_tabPanel"+b,"display","block")):(r.remove("SA_tab"+b,"active"),x.set("SA_tabPanel"+b,"display","none"));this._scrollToTab(a)},_toggleTabLayers:function(a){this._toggleTabLayersOld();this._toggleTabLayersNew(a)},
_toggleTabLayersOld:function(){var a=this.config.tabs[this.curTab];a&&(this.lyrClosest.setVisibility(!1),this.lyrProximity.setVisibility(!1),this.lyrSummary&&this.lyrSummary.setVisibility(!1),a.tabLayers&&b.forEach(a.tabLayers,function(a){"undefined"!==typeof a.visible&&a.setVisibility(!1)}))},_toggleTabLayersNew:function(a){a=this.config.tabs[a];switch(a.type){case "summary":this.lyrSummary&&this.lyrSummary.clear();a.tabLayers&&1<a.tabLayers.length&&(this.lyrSummary.infoTemplate=a.tabLayers[1].infoTemplate,
b.forEach(a.tabLayers[1].graphics,n.hitch(this,function(a){this.lyrSummary.add(a)})),this.lyrSummary.setVisibility(!0));this.incident&&!0===a.updateFlag&&(a.summaryInfo.updateForIncident(this.incident,this.buffer,this.summaryDisplayEnabled?this.lyrSummary:null),a.updateFlag=!1);break;case "weather":a.tabLayers&&b.forEach(a.tabLayers,function(a){a.setVisibility(!0)});this.incident&&!0===a.updateFlag&&(a.weatherInfo.updateForIncident(this.incident),a.updateFlag=!1);break;case "closest":a.tabLayers&&
b.forEach(a.tabLayers,function(a){"undefined"!==typeof a.visible&&a.setVisibility(!0)});this.lyrClosest.setVisibility(!0);this.incident&&!0===a.updateFlag&&(a.closestInfo.updateForIncident(this.incident,this.config.maxDistance,this.lyrClosest),a.updateFlag=!1);break;case "proximity":a.tabLayers&&b.forEach(a.tabLayers,function(a){"undefined"!==typeof a.visible&&a.setVisibility(!0)}),this.lyrProximity.setVisibility(!0),this.incident&&!0===a.updateFlag&&(a.proximityInfo.updateForIncident(this.incident,
this.buffer,this.lyrProximity),a.updateFlag=!1)}a.updateFlag=!1},_drawIncident:function(a){var b=a.geometry.type,c=this.symPoint;"polyline"===b&&(c=this.symLine);"polygon"===b&&(c=this.symPoly);this.incident=new h(a.geometry,c);this.lyrIncidents.add(this.incident);this.toolbar.deactivate();this._clickIncidentsButton(-1);this.saveEnabled&&(r.remove(this.saveSpan,"btn32SaveDisabled"),r.add(this.saveSpan,"btn32Save"));this._bufferIncident();"point"===b&&this._getIncidentAddress(a.geometry);this.div_reversed_address.innerHTML=
"";e.setStyle(this.div_reverse_geocoding,"visibility","hidden")},_getIncidentAddress:function(a){this.map.graphics.clear();this.locator.locationToAddress(C.webMercatorToGeographic(a),100)},_showIncidentAddress:function(a){if(a.address.address){var b=a.address.address.Address,c=C.geographicToWebMercator(a.address.location),d=new O;d.family="Arial";d.size="18px";d=new P(b,d,"#000000");d.setOffset(20,-4);d.horizontalAlignment="left";this.map.graphics.add(new h(c,d,{}));this.div_reversed_address.innerHTML=
b+"\x3c/br\x3e"+a.address.address.City+", "+a.address.address.Region+" "+a.address.address.Postal;e.setStyle(this.div_reverse_geocoding,"visibility","visible")}},_onAddressError:function(){this.div_reversed_address.innerHTML=this.nls.reverse_geocoded_error;e.setStyle(this.div_reverse_geocoding,"visibility","visible")},_bufferIncident:function(){if(null!==this.incident){for(var a=0;a<this.config.tabs.length;a++)this.config.tabs[a].updateFlag=!0;a=this.incident;this.buffer=null;this.lyrBuffer.clear();
var b=this.horizontalSlider.value,c=this.config.distanceSettings[this.config.distanceUnits];if(0<b){var d=a.geometry.spatialReference.wkid,a=4326===d||3587===d||102100===d?I.geodesicBuffer(a.geometry,b,c):I.buffer(a.geometry,b,c);this._locateBuffer(a.getExtent());this.buffer=new h(a,this.symBuffer);this.lyrBuffer.add(this.buffer);this._performAnalysis()}else"polygon"===a.geometry.type&&(this._locateBuffer(a.geometry.getExtent()),this.buffer=new h(a.geometry,this.symPoly),this.lyrBuffer.add(this.buffer),
this._performAnalysis())}},_performAnalysis:function(){this._toggleTabLayersNew(this.curTab)},_verifyRouting:function(){this.config.enableRouting&&(this.config.enableRouting=!1,b.forEach(this.appConfig.widgetPool.widgets,n.hitch(this,function(a){"Directions"===a.name&&(this.dirConfig=a,this.config.enableRouting=!0)})))},zoomToLocation:function(a){this.map.centerAndZoom(a,this.config.defaultZoomLevel)},routeToIncident:function(a){var b=this.incident.geometry,c=b;"point"!==b.type&&(c=b.getExtent().getCenter());
this.stops=[a,c];b=this.dirConfig.id;c=this.appConfig.theme.name;a=this.widgetManager.getControllerWidgets()[0];switch(c){case "BoxTheme":case "DartTheme":a.setOpenedIds([b]);break;case "FoldableTheme":case "JewelryBoxTheme":(b=a._getIconNodeById(b))&&a._onIconClick(b);break;case "TabTheme":a._hideOffPanelWidgets();for(var c=a.tabs,d=0,e=0;e<c.length;e++)if("more"!==c[e].flag){if(c[e].config.id===b){d=e;break}}else for(var d=e,f=c[e].config.groups,g=0;g<f.length;g++)f[g].id===b&&a._addGroupToMoreTab(f[g]);
a.selectTab(d);setTimeout(n.hitch(a,a._resizeToMax),500);break;case "LaunchpadTheme":a.setOpenedIds([b]);break;default:this.openWidgetById(b)}setTimeout(n.hitch(this,this._addStops),2E3)},_addStops:function(){var a=this.widgetManager.getWidgetById(this.dirConfig.id);if(a&&"closed"!==a.state&&(a=a._dijitDirections))a.reset(),a.addStops(this.stops)},_getTabLayers:function(a){var c=[];b.forEach(this.opLayers._layerInfos,n.hitch(this,function(b){0<b.newSubLayers.length?this._recurseOpLayers(b.newSubLayers,
c,a):-1<a.indexOf(b.title)&&(c.push(b.layerObject),"undefined"!==typeof b.layerObject.visible&&!b.layerObject.visible&&(b.layerObject.setVisibility(!0),b.layerObject.setVisibility(!1)))}));return c},_recurseOpLayers:function(a,c,d){b.forEach(a,n.hitch(this,function(a){0<a.newSubLayers.length?this._recurseOpLayers(a.newSubLayers,c,d):-1<d.indexOf(a.title)&&c.push(a.layerObject)}))},_setupSymbols:function(){var a=c.fromString(this.config.color),b=a.toRgb();b.push(0.2);var d=c.fromString("#000000"),
a=c.blendColors(a,d,0.2).toRgb(),d=new K(K.STYLE_SOLID,new c([255,255,255,0.25]),1);this.symPoint=new N(N.STYLE_CIRCLE,20,d,new c([a[0],a[1],a[2],0.7]));this.symLine=new K(K.STYLE_SOLID,new c([a[0],a[1],a[2],0.7]),3);this.symPoly=new L(L.STYLE_SOLID,this.symLine,new c([a[0],a[1],a[2],0.3]));this.symBuffer=new L(L.STYLE_SOLID,d,new c(b))},onReceiveData:function(a,b,c){null!==c&&c.eventType&&("IncidentLocation"===c.eventType?c.dataValue&&null!==c.dataValue&&(this._clickTab(0),a=c.dataValue,a.attributes[this.shapeFlagFieldName]?
(this.incident=a,this._bufferIncident()):this._drawIncident(a)):"WebMapChanged"===c.eventType&&this._storeIncidents())},_storeIncidents:function(){if(null!==this.incident){var a={location:p.stringify(this.incident.geometry),hasBuffer:0<this.lyrBuffer.graphics.length,buffer_dist:this.horizontalSlider.value,unit:this.config.distanceUnits},a=p.stringify(a);window.localStorage.setItem(this.Incident_Local_Storage_Key,a);console.log("Inclident saved to storage")}this.publishData({eventType:"WebMapChangedACK"});
console.log("eventType WebMapChangedACK fired")},_restoreIncidents:function(){var a=window.localStorage.getItem(this.Incident_Local_Storage_Key);if(null!==a&&"null"!==a){window.localStorage.setItem(this.Incident_Local_Storage_Key,null);var a=p.parse(a,!0),b=a.buffer_dist;this.sliderValue.set("value",b);this.horizontalSlider.set("value",b);var b=p.parse(a.location),c=a.hasBuffer;if(b){var a={},d=null;"extent"===b.type?d=new F(b):"multipoint"===b.type?d=new E(b):"point"===b.type?d=new A(b):"polygon"===
b.type?d=new D(b):"polyline"===b.type&&(d=new G(b));a.geometry=d;this._drawIncident(a,c)}}},_scrollToTab:function(a){var b=m.position(this.footerContentNode).w;m.position(this.tabsNode).w>b&&(a=m.getMarginBox("SA_tab"+a),this.footerContentNode.scrollLeft=a.l-(b-a.w)/2)},_storeInitalVisibility:function(){b.forEach(this.config.tabs,n.hitch(this,function(a){b.forEach(a.tabLayers,n.hitch(this,function(a){"undefined"!==typeof a.visible&&(this.initalLayerVisibility[a.id]=a.visible,a.setVisibility(!1))}))}))},
_resetInitalVisibility:function(){b.forEach(this.config.tabs,n.hitch(this,function(a){b.forEach(a.tabLayers,n.hitch(this,function(a){"undefined"!==typeof a.visible&&a.id in this.initalLayerVisibility&&a.setVisibility(this.initalLayerVisibility[a.id])}))}))},_clearGraphics:function(){b.forEach(this.config.tabs,n.hitch(this,function(a){if("summary"===a.type&&a.tabLayers&&1<a.tabLayers.length)for(var b=1;b<a.tabLayers.length;b++)a.tabLayers.pop()}))},_resetInfoWindow:function(){this.defaultEditWindowContentJson&&
this.lyrEdit.infoTemplate.setContent(p.parse(this.defaultEditWindowContentJson));var a=u(".actionList",this.map.infoWindow.domNode);0<a.length&&0<a[0].innerHTML.indexOf(this.nls.actionLabel)&&z.destroy("SA_actionLink");this.map.infoWindow.isShowing&&this.map.infoWindow.hide()},_close:function(){this.widgetManager.closeWidget(this.id)}})});